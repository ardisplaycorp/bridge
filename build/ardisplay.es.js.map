{"version":3,"file":"ardisplay.es.js","sources":["../node_modules/qr-code-styling/lib/qr-code-styling.js","../src/templates/hotspots.js","../src/utils/styleObjectToString.js","../src/config/config.js","../src/templates/normal.js","../src/templates/modal.js","../src/templates/button.js","../node_modules/lucide/dist/esm/defaultAttributes.js","../node_modules/lucide/dist/esm/icons/blocks.js","../node_modules/lucide/dist/esm/icons/box.js","../node_modules/lucide/dist/esm/icons/eye.js","../node_modules/lucide/dist/esm/icons/file-axis-3d.js","../node_modules/lucide/dist/esm/icons/rotate-3d.js","../node_modules/lucide/dist/esm/icons/scan.js","../src/utils/modelViewerLoader.js","../node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../node_modules/three/examples/jsm/loaders/DRACOLoader.js","../node_modules/three/examples/jsm/libs/fflate.module.js","../node_modules/three/examples/jsm/utils/TextureUtils.js","../node_modules/three/examples/jsm/exporters/USDZExporter.js","../src/utils/meshopt_decoder.module.js","../src/utils/glbToUsdz.js","../src/main.js"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.QRCodeStyling=e():t.QRCodeStyling=e()}(this,(()=>(()=>{var t={873:(t,e)=>{var i,r,n=function(){var t=function(t,e){var i=t,r=s[e],n=null,o=0,h=null,p=[],v={},m=function(t,e){n=function(t){for(var e=new Array(t),i=0;i<t;i+=1){e[i]=new Array(t);for(var r=0;r<t;r+=1)e[i][r]=null}return e}(o=4*i+17),b(0,0),b(o-7,0),b(0,o-7),x(),y(),C(t,e),i>=7&&S(t),null==h&&(h=M(i,r,p)),A(h,e)},b=function(t,e){for(var i=-1;i<=7;i+=1)if(!(t+i<=-1||o<=t+i))for(var r=-1;r<=7;r+=1)e+r<=-1||o<=e+r||(n[t+i][e+r]=0<=i&&i<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==i||6==i)||2<=i&&i<=4&&2<=r&&r<=4)},y=function(){for(var t=8;t<o-8;t+=1)null==n[t][6]&&(n[t][6]=t%2==0);for(var e=8;e<o-8;e+=1)null==n[6][e]&&(n[6][e]=e%2==0)},x=function(){for(var t=a.getPatternPosition(i),e=0;e<t.length;e+=1)for(var r=0;r<t.length;r+=1){var o=t[e],s=t[r];if(null==n[o][s])for(var h=-2;h<=2;h+=1)for(var d=-2;d<=2;d+=1)n[o+h][s+d]=-2==h||2==h||-2==d||2==d||0==h&&0==d}},S=function(t){for(var e=a.getBCHTypeNumber(i),r=0;r<18;r+=1){var s=!t&&1==(e>>r&1);n[Math.floor(r/3)][r%3+o-8-3]=s}for(r=0;r<18;r+=1)s=!t&&1==(e>>r&1),n[r%3+o-8-3][Math.floor(r/3)]=s},C=function(t,e){for(var i=r<<3|e,s=a.getBCHTypeInfo(i),h=0;h<15;h+=1){var d=!t&&1==(s>>h&1);h<6?n[h][8]=d:h<8?n[h+1][8]=d:n[o-15+h][8]=d}for(h=0;h<15;h+=1)d=!t&&1==(s>>h&1),h<8?n[8][o-h-1]=d:h<9?n[8][15-h-1+1]=d:n[8][15-h-1]=d;n[o-8][8]=!t},A=function(t,e){for(var i=-1,r=o-1,s=7,h=0,d=a.getMaskFunction(e),u=o-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var c=0;c<2;c+=1)if(null==n[r][u-c]){var l=!1;h<t.length&&(l=1==(t[h]>>>s&1)),d(r,u-c)&&(l=!l),n[r][u-c]=l,-1==(s-=1)&&(h+=1,s=7)}if((r+=i)<0||o<=r){r-=i,i=-i;break}}},M=function(t,e,i){for(var r=u.getRSBlocks(t,e),n=c(),o=0;o<i.length;o+=1){var s=i[o];n.put(s.getMode(),4),n.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(n)}var h=0;for(o=0;o<r.length;o+=1)h+=r[o].dataCount;if(n.getLengthInBits()>8*h)throw\"code length overflow. (\"+n.getLengthInBits()+\">\"+8*h+\")\";for(n.getLengthInBits()+4<=8*h&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*h||(n.put(236,8),n.getLengthInBits()>=8*h));)n.put(17,8);return function(t,e){for(var i=0,r=0,n=0,o=new Array(e.length),s=new Array(e.length),h=0;h<e.length;h+=1){var u=e[h].dataCount,c=e[h].totalCount-u;r=Math.max(r,u),n=Math.max(n,c),o[h]=new Array(u);for(var l=0;l<o[h].length;l+=1)o[h][l]=255&t.getBuffer()[l+i];i+=u;var g=a.getErrorCorrectPolynomial(c),f=d(o[h],g.getLength()-1).mod(g);for(s[h]=new Array(g.getLength()-1),l=0;l<s[h].length;l+=1){var w=l+f.getLength()-s[h].length;s[h][l]=w>=0?f.getAt(w):0}}var p=0;for(l=0;l<e.length;l+=1)p+=e[l].totalCount;var v=new Array(p),_=0;for(l=0;l<r;l+=1)for(h=0;h<e.length;h+=1)l<o[h].length&&(v[_]=o[h][l],_+=1);for(l=0;l<n;l+=1)for(h=0;h<e.length;h+=1)l<s[h].length&&(v[_]=s[h][l],_+=1);return v}(n,r)};v.addData=function(t,e){var i=null;switch(e=e||\"Byte\"){case\"Numeric\":i=l(t);break;case\"Alphanumeric\":i=g(t);break;case\"Byte\":i=f(t);break;case\"Kanji\":i=w(t);break;default:throw\"mode:\"+e}p.push(i),h=null},v.isDark=function(t,e){if(t<0||o<=t||e<0||o<=e)throw t+\",\"+e;return n[t][e]},v.getModuleCount=function(){return o},v.make=function(){if(i<1){for(var t=1;t<40;t++){for(var e=u.getRSBlocks(t,r),n=c(),o=0;o<p.length;o++){var s=p[o];n.put(s.getMode(),4),n.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(n)}var h=0;for(o=0;o<e.length;o++)h+=e[o].dataCount;if(n.getLengthInBits()<=8*h)break}i=t}m(!1,function(){for(var t=0,e=0,i=0;i<8;i+=1){m(!0,i);var r=a.getLostPoint(v);(0==i||t>r)&&(t=r,e=i)}return e}())},v.createTableTag=function(t,e){t=t||2;var i=\"\";i+='<table style=\"',i+=\" border-width: 0px; border-style: none;\",i+=\" border-collapse: collapse;\",i+=\" padding: 0px; margin: \"+(e=void 0===e?4*t:e)+\"px;\",i+='\">',i+=\"<tbody>\";for(var r=0;r<v.getModuleCount();r+=1){i+=\"<tr>\";for(var n=0;n<v.getModuleCount();n+=1)i+='<td style=\"',i+=\" border-width: 0px; border-style: none;\",i+=\" border-collapse: collapse;\",i+=\" padding: 0px; margin: 0px;\",i+=\" width: \"+t+\"px;\",i+=\" height: \"+t+\"px;\",i+=\" background-color: \",i+=v.isDark(r,n)?\"#000000\":\"#ffffff\",i+=\";\",i+='\"/>';i+=\"</tr>\"}return(i+=\"</tbody>\")+\"</table>\"},v.createSvgTag=function(t,e,i,r){var n={};\"object\"==typeof arguments[0]&&(t=(n=arguments[0]).cellSize,e=n.margin,i=n.alt,r=n.title),t=t||2,e=void 0===e?4*t:e,(i=\"string\"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||\"qrcode-description\":null,(r=\"string\"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||\"qrcode-title\":null;var o,s,a,h,d=v.getModuleCount()*t+2*e,u=\"\";for(h=\"l\"+t+\",0 0,\"+t+\" -\"+t+\",0 0,-\"+t+\"z \",u+='<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"',u+=n.scalable?\"\":' width=\"'+d+'px\" height=\"'+d+'px\"',u+=' viewBox=\"0 0 '+d+\" \"+d+'\" ',u+=' preserveAspectRatio=\"xMinYMin meet\"',u+=r.text||i.text?' role=\"img\" aria-labelledby=\"'+$([r.id,i.id].join(\" \").trim())+'\"':\"\",u+=\">\",u+=r.text?'<title id=\"'+$(r.id)+'\">'+$(r.text)+\"</title>\":\"\",u+=i.text?'<description id=\"'+$(i.id)+'\">'+$(i.text)+\"</description>\":\"\",u+='<rect width=\"100%\" height=\"100%\" fill=\"white\" cx=\"0\" cy=\"0\"/>',u+='<path d=\"',s=0;s<v.getModuleCount();s+=1)for(a=s*t+e,o=0;o<v.getModuleCount();o+=1)v.isDark(s,o)&&(u+=\"M\"+(o*t+e)+\",\"+a+h);return(u+='\" stroke=\"transparent\" fill=\"black\"/>')+\"</svg>\"},v.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var i=v.getModuleCount()*t+2*e,r=e,n=i-e;return _(i,i,(function(e,i){if(r<=e&&e<n&&r<=i&&i<n){var o=Math.floor((e-r)/t),s=Math.floor((i-r)/t);return v.isDark(s,o)?0:1}return 1}))},v.createImgTag=function(t,e,i){t=t||2,e=void 0===e?4*t:e;var r=v.getModuleCount()*t+2*e,n=\"\";return n+=\"<img\",n+=' src=\"',n+=v.createDataURL(t,e),n+='\"',n+=' width=\"',n+=r,n+='\"',n+=' height=\"',n+=r,n+='\"',i&&(n+=' alt=\"',n+=$(i),n+='\"'),n+\"/>\"};var $=function(t){for(var e=\"\",i=0;i<t.length;i+=1){var r=t.charAt(i);switch(r){case\"<\":e+=\"&lt;\";break;case\">\":e+=\"&gt;\";break;case\"&\":e+=\"&amp;\";break;case'\"':e+=\"&quot;\";break;default:e+=r}}return e};return v.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,i,r,n,o,s=1*v.getModuleCount()+2*t,a=t,h=s-t,d={\"██\":\"█\",\"█ \":\"▀\",\" █\":\"▄\",\"  \":\" \"},u={\"██\":\"▀\",\"█ \":\"▀\",\" █\":\" \",\"  \":\" \"},c=\"\";for(e=0;e<s;e+=2){for(r=Math.floor((e-a)/1),n=Math.floor((e+1-a)/1),i=0;i<s;i+=1)o=\"█\",a<=i&&i<h&&a<=e&&e<h&&v.isDark(r,Math.floor((i-a)/1))&&(o=\" \"),a<=i&&i<h&&a<=e+1&&e+1<h&&v.isDark(n,Math.floor((i-a)/1))?o+=\" \":o+=\"█\",c+=t<1&&e+1>=h?u[o]:d[o];c+=\"\\n\"}return s%2&&t>0?c.substring(0,c.length-s-1)+Array(s+1).join(\"▀\"):c.substring(0,c.length-1)}(e);t-=1,e=void 0===e?2*t:e;var i,r,n,o,s=v.getModuleCount()*t+2*e,a=e,h=s-e,d=Array(t+1).join(\"██\"),u=Array(t+1).join(\"  \"),c=\"\",l=\"\";for(i=0;i<s;i+=1){for(n=Math.floor((i-a)/t),l=\"\",r=0;r<s;r+=1)o=1,a<=r&&r<h&&a<=i&&i<h&&v.isDark(n,Math.floor((r-a)/t))&&(o=0),l+=o?d:u;for(n=0;n<t;n+=1)c+=l+\"\\n\"}return c.substring(0,c.length-1)},v.renderTo2dContext=function(t,e){e=e||2;for(var i=v.getModuleCount(),r=0;r<i;r++)for(var n=0;n<i;n++)t.fillStyle=v.isDark(r,n)?\"black\":\"white\",t.fillRect(r*e,n*e,e,e)},v};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],i=0;i<t.length;i+=1){var r=t.charCodeAt(i);e.push(255&r)}return e}}).default,t.createStringToBytes=function(t,e){var i=function(){for(var i=v(t),r=function(){var t=i.read();if(-1==t)throw\"eof\";return t},n=0,o={};;){var s=i.read();if(-1==s)break;var a=r(),h=r()<<8|r();o[String.fromCharCode(s<<8|a)]=h,n+=1}if(n!=e)throw n+\" != \"+e;return o}(),r=\"?\".charCodeAt(0);return function(t){for(var e=[],n=0;n<t.length;n+=1){var o=t.charCodeAt(n);if(o<128)e.push(o);else{var s=i[t.charAt(n)];\"number\"==typeof s?(255&s)==s?e.push(s):(e.push(s>>>8),e.push(255&s)):e.push(r)}}return e}};var e,i,r,n,o,s={L:1,M:0,Q:3,H:2},a=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],i=1335,r=7973,o=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(n={}).getBCHTypeInfo=function(t){for(var e=t<<10;o(e)-o(i)>=0;)e^=i<<o(e)-o(i);return 21522^(t<<10|e)},n.getBCHTypeNumber=function(t){for(var e=t<<12;o(e)-o(r)>=0;)e^=r<<o(e)-o(r);return t<<12|e},n.getPatternPosition=function(t){return e[t-1]},n.getMaskFunction=function(t){switch(t){case 0:return function(t,e){return(t+e)%2==0};case 1:return function(t,e){return t%2==0};case 2:return function(t,e){return e%3==0};case 3:return function(t,e){return(t+e)%3==0};case 4:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case 5:return function(t,e){return t*e%2+t*e%3==0};case 6:return function(t,e){return(t*e%2+t*e%3)%2==0};case 7:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw\"bad maskPattern:\"+t}},n.getErrorCorrectPolynomial=function(t){for(var e=d([1],0),i=0;i<t;i+=1)e=e.multiply(d([1,h.gexp(i)],0));return e},n.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw\"mode:\"+t}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw\"mode:\"+t}else{if(!(e<41))throw\"type:\"+e;switch(t){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw\"mode:\"+t}}},n.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,r=0;r<e;r+=1)for(var n=0;n<e;n+=1){for(var o=0,s=t.isDark(r,n),a=-1;a<=1;a+=1)if(!(r+a<0||e<=r+a))for(var h=-1;h<=1;h+=1)n+h<0||e<=n+h||0==a&&0==h||s==t.isDark(r+a,n+h)&&(o+=1);o>5&&(i+=3+o-5)}for(r=0;r<e-1;r+=1)for(n=0;n<e-1;n+=1){var d=0;t.isDark(r,n)&&(d+=1),t.isDark(r+1,n)&&(d+=1),t.isDark(r,n+1)&&(d+=1),t.isDark(r+1,n+1)&&(d+=1),0!=d&&4!=d||(i+=3)}for(r=0;r<e;r+=1)for(n=0;n<e-6;n+=1)t.isDark(r,n)&&!t.isDark(r,n+1)&&t.isDark(r,n+2)&&t.isDark(r,n+3)&&t.isDark(r,n+4)&&!t.isDark(r,n+5)&&t.isDark(r,n+6)&&(i+=40);for(n=0;n<e;n+=1)for(r=0;r<e-6;r+=1)t.isDark(r,n)&&!t.isDark(r+1,n)&&t.isDark(r+2,n)&&t.isDark(r+3,n)&&t.isDark(r+4,n)&&!t.isDark(r+5,n)&&t.isDark(r+6,n)&&(i+=40);var u=0;for(n=0;n<e;n+=1)for(r=0;r<e;r+=1)t.isDark(r,n)&&(u+=1);return i+Math.abs(100*u/e/e-50)/5*10},n),h=function(){for(var t=new Array(256),e=new Array(256),i=0;i<8;i+=1)t[i]=1<<i;for(i=8;i<256;i+=1)t[i]=t[i-4]^t[i-5]^t[i-6]^t[i-8];for(i=0;i<255;i+=1)e[t[i]]=i;return{glog:function(t){if(t<1)throw\"glog(\"+t+\")\";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}}}();function d(t,e){if(void 0===t.length)throw t.length+\"/\"+e;var i=function(){for(var i=0;i<t.length&&0==t[i];)i+=1;for(var r=new Array(t.length-i+e),n=0;n<t.length-i;n+=1)r[n]=t[n+i];return r}(),r={getAt:function(t){return i[t]},getLength:function(){return i.length},multiply:function(t){for(var e=new Array(r.getLength()+t.getLength()-1),i=0;i<r.getLength();i+=1)for(var n=0;n<t.getLength();n+=1)e[i+n]^=h.gexp(h.glog(r.getAt(i))+h.glog(t.getAt(n)));return d(e,0)},mod:function(t){if(r.getLength()-t.getLength()<0)return r;for(var e=h.glog(r.getAt(0))-h.glog(t.getAt(0)),i=new Array(r.getLength()),n=0;n<r.getLength();n+=1)i[n]=r.getAt(n);for(n=0;n<t.getLength();n+=1)i[n]^=h.gexp(h.glog(t.getAt(n))+e);return d(i,0).mod(t)}};return r}var u=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var i={};return i.totalCount=t,i.dataCount=e,i},i={getRSBlocks:function(i,r){var n=function(e,i){switch(i){case s.L:return t[4*(e-1)+0];case s.M:return t[4*(e-1)+1];case s.Q:return t[4*(e-1)+2];case s.H:return t[4*(e-1)+3];default:return}}(i,r);if(void 0===n)throw\"bad rs block @ typeNumber:\"+i+\"/errorCorrectionLevel:\"+r;for(var o=n.length/3,a=[],h=0;h<o;h+=1)for(var d=n[3*h+0],u=n[3*h+1],c=n[3*h+2],l=0;l<d;l+=1)a.push(e(u,c));return a}};return i}(),c=function(){var t=[],e=0,i={getBuffer:function(){return t},getAt:function(e){var i=Math.floor(e/8);return 1==(t[i]>>>7-e%8&1)},put:function(t,e){for(var r=0;r<e;r+=1)i.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return e},putBit:function(i){var r=Math.floor(e/8);t.length<=r&&t.push(0),i&&(t[r]|=128>>>e%8),e+=1}};return i},l=function(t){var e=t,i={getMode:function(){return 1},getLength:function(t){return e.length},write:function(t){for(var i=e,n=0;n+2<i.length;)t.put(r(i.substring(n,n+3)),10),n+=3;n<i.length&&(i.length-n==1?t.put(r(i.substring(n,n+1)),4):i.length-n==2&&t.put(r(i.substring(n,n+2)),7))}},r=function(t){for(var e=0,i=0;i<t.length;i+=1)e=10*e+n(t.charAt(i));return e},n=function(t){if(\"0\"<=t&&t<=\"9\")return t.charCodeAt(0)-\"0\".charCodeAt(0);throw\"illegal char :\"+t};return i},g=function(t){var e=t,i={getMode:function(){return 2},getLength:function(t){return e.length},write:function(t){for(var i=e,n=0;n+1<i.length;)t.put(45*r(i.charAt(n))+r(i.charAt(n+1)),11),n+=2;n<i.length&&t.put(r(i.charAt(n)),6)}},r=function(t){if(\"0\"<=t&&t<=\"9\")return t.charCodeAt(0)-\"0\".charCodeAt(0);if(\"A\"<=t&&t<=\"Z\")return t.charCodeAt(0)-\"A\".charCodeAt(0)+10;switch(t){case\" \":return 36;case\"$\":return 37;case\"%\":return 38;case\"*\":return 39;case\"+\":return 40;case\"-\":return 41;case\".\":return 42;case\"/\":return 43;case\":\":return 44;default:throw\"illegal char :\"+t}};return i},f=function(e){var i=t.stringToBytes(e);return{getMode:function(){return 4},getLength:function(t){return i.length},write:function(t){for(var e=0;e<i.length;e+=1)t.put(i[e],8)}}},w=function(e){var i=t.stringToBytesFuncs.SJIS;if(!i)throw\"sjis not supported.\";!function(){var t=i(\"友\");if(2!=t.length||38726!=(t[0]<<8|t[1]))throw\"sjis not supported.\"}();var r=i(e),n={getMode:function(){return 8},getLength:function(t){return~~(r.length/2)},write:function(t){for(var e=r,i=0;i+1<e.length;){var n=(255&e[i])<<8|255&e[i+1];if(33088<=n&&n<=40956)n-=33088;else{if(!(57408<=n&&n<=60351))throw\"illegal char at \"+(i+1)+\"/\"+n;n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13),i+=2}if(i<e.length)throw\"illegal char at \"+(i+1)}};return n},p=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,i,r){i=i||0,r=r||t.length;for(var n=0;n<r;n+=1)e.writeByte(t[n+i])},writeString:function(t){for(var i=0;i<t.length;i+=1)e.writeByte(t.charCodeAt(i))},toByteArray:function(){return t},toString:function(){var e=\"\";e+=\"[\";for(var i=0;i<t.length;i+=1)i>0&&(e+=\",\"),e+=t[i];return e+\"]\"}};return e},v=function(t){var e=t,i=0,r=0,n=0,o={read:function(){for(;n<8;){if(i>=e.length){if(0==n)return-1;throw\"unexpected end of file./\"+n}var t=e.charAt(i);if(i+=1,\"=\"==t)return n=0,-1;t.match(/^\\s$/)||(r=r<<6|s(t.charCodeAt(0)),n+=6)}var o=r>>>n-8&255;return n-=8,o}},s=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw\"c:\"+t};return o},_=function(t,e,i){for(var r=function(t,e){var i=t,r=e,n=new Array(t*e),o={setPixel:function(t,e,r){n[e*i+t]=r},write:function(t){t.writeString(\"GIF87a\"),t.writeShort(i),t.writeShort(r),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(\",\"),t.writeShort(0),t.writeShort(0),t.writeShort(i),t.writeShort(r),t.writeByte(0);var e=s(2);t.writeByte(2);for(var n=0;e.length-n>255;)t.writeByte(255),t.writeBytes(e,n,255),n+=255;t.writeByte(e.length-n),t.writeBytes(e,n,e.length-n),t.writeByte(0),t.writeString(\";\")}},s=function(t){for(var e=1<<t,i=1+(1<<t),r=t+1,o=a(),s=0;s<e;s+=1)o.add(String.fromCharCode(s));o.add(String.fromCharCode(e)),o.add(String.fromCharCode(i));var h,d,u,c=p(),l=(h=c,d=0,u=0,{write:function(t,e){if(t>>>e!=0)throw\"length over\";for(;d+e>=8;)h.writeByte(255&(t<<d|u)),e-=8-d,t>>>=8-d,u=0,d=0;u|=t<<d,d+=e},flush:function(){d>0&&h.writeByte(u)}});l.write(e,r);var g=0,f=String.fromCharCode(n[g]);for(g+=1;g<n.length;){var w=String.fromCharCode(n[g]);g+=1,o.contains(f+w)?f+=w:(l.write(o.indexOf(f),r),o.size()<4095&&(o.size()==1<<r&&(r+=1),o.add(f+w)),f=w)}return l.write(o.indexOf(f),r),l.write(i,r),l.flush(),c.toByteArray()},a=function(){var t={},e=0,i={add:function(r){if(i.contains(r))throw\"dup key:\"+r;t[r]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return i};return o}(t,e),n=0;n<e;n+=1)for(var o=0;o<t;o+=1)r.setPixel(o,n,i(o,n));var s=p();r.write(s);for(var a=function(){var t=0,e=0,i=0,r=\"\",n={},o=function(t){r+=String.fromCharCode(s(63&t))},s=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw\"n:\"+t};return n.writeByte=function(r){for(t=t<<8|255&r,e+=8,i+=1;e>=6;)o(t>>>e-6),e-=6},n.flush=function(){if(e>0&&(o(t<<6-e),t=0,e=0),i%3!=0)for(var n=3-i%3,s=0;s<n;s+=1)r+=\"=\"},n.toString=function(){return r},n}(),h=s.toByteArray(),d=0;d<h.length;d+=1)a.writeByte(h[d]);return a.flush(),\"data:image/gif;base64,\"+a};return t}();n.stringToBytesFuncs[\"UTF-8\"]=function(t){return function(t){for(var e=[],i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(i++,r=65536+((1023&r)<<10|1023&t.charCodeAt(i)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t)},void 0===(r=\"function\"==typeof(i=function(){return n})?i.apply(e,[]):i)||(t.exports=r)}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};return(()=>{\"use strict\";i.d(r,{default:()=>S});const t=t=>!!t&&\"object\"==typeof t&&!Array.isArray(t);function e(i,...r){if(!r.length)return i;const n=r.shift();return void 0!==n&&t(i)&&t(n)?(i=Object.assign({},i),Object.keys(n).forEach((r=>{const o=i[r],s=n[r];Array.isArray(o)&&Array.isArray(s)?i[r]=s:t(o)&&t(s)?i[r]=e(Object.assign({},o),s):i[r]=s})),e(i,...r)):i}function n(t,e){const i=document.createElement(\"a\");i.download=e,i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)}const o={L:.07,M:.15,Q:.25,H:.3};class s{constructor({svg:t,type:e,window:i}){this._svg=t,this._type=e,this._window=i}draw(t,e,i,r){let n;switch(this._type){case\"dots\":n=this._drawDot;break;case\"classy\":n=this._drawClassy;break;case\"classy-rounded\":n=this._drawClassyRounded;break;case\"rounded\":n=this._drawRounded;break;case\"extra-rounded\":n=this._drawExtraRounded;break;default:n=this._drawSquare}n.call(this,{x:t,y:e,size:i,getNeighbor:r})}_rotateFigure({x:t,y:e,size:i,rotation:r=0,draw:n}){var o;const s=t+i/2,a=e+i/2;n(),null===(o=this._element)||void 0===o||o.setAttribute(\"transform\",`rotate(${180*r/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"circle\"),this._element.setAttribute(\"cx\",String(i+e/2)),this._element.setAttribute(\"cy\",String(r+e/2)),this._element.setAttribute(\"r\",String(e/2))}}))}_basicSquare(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\"),this._element.setAttribute(\"x\",String(i)),this._element.setAttribute(\"y\",String(r)),this._element.setAttribute(\"width\",String(e)),this._element.setAttribute(\"height\",String(e))}}))}_basicSideRounded(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"d\",`M ${i} ${r}v ${e}h `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, 0 ${-e}`)}}))}_basicCornerRounded(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"d\",`M ${i} ${r}v ${e}h ${e}v `+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}}))}_basicCornerExtraRounded(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"d\",`M ${i} ${r}v ${e}h ${e}a ${e} ${e}, 0, 0, 0, ${-e} ${-e}`)}}))}_basicCornersRounded(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"d\",`M ${i} ${r}v `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${e/2} ${e/2}h `+e/2+\"v \"+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}}))}_drawDot({x:t,y:e,size:i}){this._basicDot({x:t,y:e,size:i,rotation:0})}_drawSquare({x:t,y:e,size:i}){this._basicSquare({x:t,y:e,size:i,rotation:0})}_drawRounded({x:t,y:e,size:i,getNeighbor:r}){const n=r?+r(-1,0):0,o=r?+r(1,0):0,s=r?+r(0,-1):0,a=r?+r(0,1):0,h=n+o+s+a;if(0!==h)if(h>2||n&&o||s&&a)this._basicSquare({x:t,y:e,size:i,rotation:0});else{if(2===h){let r=0;return n&&s?r=Math.PI/2:s&&o?r=Math.PI:o&&a&&(r=-Math.PI/2),void this._basicCornerRounded({x:t,y:e,size:i,rotation:r})}if(1===h){let r=0;return s?r=Math.PI/2:o?r=Math.PI:a&&(r=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:i,rotation:r})}}else this._basicDot({x:t,y:e,size:i,rotation:0})}_drawExtraRounded({x:t,y:e,size:i,getNeighbor:r}){const n=r?+r(-1,0):0,o=r?+r(1,0):0,s=r?+r(0,-1):0,a=r?+r(0,1):0,h=n+o+s+a;if(0!==h)if(h>2||n&&o||s&&a)this._basicSquare({x:t,y:e,size:i,rotation:0});else{if(2===h){let r=0;return n&&s?r=Math.PI/2:s&&o?r=Math.PI:o&&a&&(r=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:e,size:i,rotation:r})}if(1===h){let r=0;return s?r=Math.PI/2:o?r=Math.PI:a&&(r=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:i,rotation:r})}}else this._basicDot({x:t,y:e,size:i,rotation:0})}_drawClassy({x:t,y:e,size:i,getNeighbor:r}){const n=r?+r(-1,0):0,o=r?+r(1,0):0,s=r?+r(0,-1):0,a=r?+r(0,1):0;0!==n+o+s+a?n||s?o||a?this._basicSquare({x:t,y:e,size:i,rotation:0}):this._basicCornerRounded({x:t,y:e,size:i,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:e,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:i,rotation:Math.PI/2})}_drawClassyRounded({x:t,y:e,size:i,getNeighbor:r}){const n=r?+r(-1,0):0,o=r?+r(1,0):0,s=r?+r(0,-1):0,a=r?+r(0,1):0;0!==n+o+s+a?n||s?o||a?this._basicSquare({x:t,y:e,size:i,rotation:0}):this._basicCornerExtraRounded({x:t,y:e,size:i,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:e,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:i,rotation:Math.PI/2})}}class a{constructor({svg:t,type:e,window:i}){this._svg=t,this._type=e,this._window=i}draw(t,e,i,r){let n;switch(this._type){case\"square\":n=this._drawSquare;break;case\"extra-rounded\":n=this._drawExtraRounded;break;default:n=this._drawDot}n.call(this,{x:t,y:e,size:i,rotation:r})}_rotateFigure({x:t,y:e,size:i,rotation:r=0,draw:n}){var o;const s=t+i/2,a=e+i/2;n(),null===(o=this._element)||void 0===o||o.setAttribute(\"transform\",`rotate(${180*r/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:i,y:r}=t,n=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"clip-rule\",\"evenodd\"),this._element.setAttribute(\"d\",`M ${i+e/2} ${r}a ${e/2} ${e/2} 0 1 0 0.1 0zm 0 ${n}a ${e/2-n} ${e/2-n} 0 1 1 -0.1 0Z`)}}))}_basicSquare(t){const{size:e,x:i,y:r}=t,n=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"clip-rule\",\"evenodd\"),this._element.setAttribute(\"d\",`M ${i} ${r}v ${e}h ${e}v `+-e+\"z\"+`M ${i+n} ${r+n}h `+(e-2*n)+\"v \"+(e-2*n)+\"h \"+(2*n-e)+\"z\")}}))}_basicExtraRounded(t){const{size:e,x:i,y:r}=t,n=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),this._element.setAttribute(\"clip-rule\",\"evenodd\"),this._element.setAttribute(\"d\",`M ${i} ${r+2.5*n}v `+2*n+`a ${2.5*n} ${2.5*n}, 0, 0, 0, ${2.5*n} ${2.5*n}h `+2*n+`a ${2.5*n} ${2.5*n}, 0, 0, 0, ${2.5*n} ${2.5*-n}v `+-2*n+`a ${2.5*n} ${2.5*n}, 0, 0, 0, ${2.5*-n} ${2.5*-n}h `+-2*n+`a ${2.5*n} ${2.5*n}, 0, 0, 0, ${2.5*-n} ${2.5*n}`+`M ${i+2.5*n} ${r+n}h `+2*n+`a ${1.5*n} ${1.5*n}, 0, 0, 1, ${1.5*n} ${1.5*n}v `+2*n+`a ${1.5*n} ${1.5*n}, 0, 0, 1, ${1.5*-n} ${1.5*n}h `+-2*n+`a ${1.5*n} ${1.5*n}, 0, 0, 1, ${1.5*-n} ${1.5*-n}v `+-2*n+`a ${1.5*n} ${1.5*n}, 0, 0, 1, ${1.5*n} ${1.5*-n}`)}}))}_drawDot({x:t,y:e,size:i,rotation:r}){this._basicDot({x:t,y:e,size:i,rotation:r})}_drawSquare({x:t,y:e,size:i,rotation:r}){this._basicSquare({x:t,y:e,size:i,rotation:r})}_drawExtraRounded({x:t,y:e,size:i,rotation:r}){this._basicExtraRounded({x:t,y:e,size:i,rotation:r})}}class h{constructor({svg:t,type:e,window:i}){this._svg=t,this._type=e,this._window=i}draw(t,e,i,r){let n;n=\"square\"===this._type?this._drawSquare:this._drawDot,n.call(this,{x:t,y:e,size:i,rotation:r})}_rotateFigure({x:t,y:e,size:i,rotation:r=0,draw:n}){var o;const s=t+i/2,a=e+i/2;n(),null===(o=this._element)||void 0===o||o.setAttribute(\"transform\",`rotate(${180*r/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"circle\"),this._element.setAttribute(\"cx\",String(i+e/2)),this._element.setAttribute(\"cy\",String(r+e/2)),this._element.setAttribute(\"r\",String(e/2))}}))}_basicSquare(t){const{size:e,x:i,y:r}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\"),this._element.setAttribute(\"x\",String(i)),this._element.setAttribute(\"y\",String(r)),this._element.setAttribute(\"width\",String(e)),this._element.setAttribute(\"height\",String(e))}}))}_drawDot({x:t,y:e,size:i,rotation:r}){this._basicDot({x:t,y:e,size:i,rotation:r})}_drawSquare({x:t,y:e,size:i,rotation:r}){this._basicSquare({x:t,y:e,size:i,rotation:r})}}const d=\"circle\",u=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],c=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class l{constructor(t,e){this._roundSize=t=>this._options.dotsOptions.roundSize?Math.floor(t):t,this._window=e,this._element=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\"),this._element.setAttribute(\"width\",String(t.width)),this._element.setAttribute(\"height\",String(t.height)),this._element.setAttribute(\"xmlns:xlink\",\"http://www.w3.org/1999/xlink\"),t.dotsOptions.roundSize||this._element.setAttribute(\"shape-rendering\",\"crispEdges\"),this._element.setAttribute(\"viewBox\",`0 0 ${t.width} ${t.height}`),this._defs=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"defs\"),this._element.appendChild(this._defs),this._imageUri=t.image,this._instanceId=l.instanceCount++,this._options=t}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}async drawQR(t){const e=t.getModuleCount(),i=Math.min(this._options.width,this._options.height)-2*this._options.margin,r=this._options.shape===d?i/Math.sqrt(2):i,n=this._roundSize(r/e);let s={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=t,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:t,qrOptions:i}=this._options,r=t.imageSize*o[i.errorCorrectionLevel],a=Math.floor(r*e*e);s=function({originalHeight:t,originalWidth:e,maxHiddenDots:i,maxHiddenAxisDots:r,dotSize:n}){const o={x:0,y:0},s={x:0,y:0};if(t<=0||e<=0||i<=0||n<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const a=t/e;return o.x=Math.floor(Math.sqrt(i/a)),o.x<=0&&(o.x=1),r&&r<o.x&&(o.x=r),o.x%2==0&&o.x--,s.x=o.x*n,o.y=1+2*Math.ceil((o.x*a-1)/2),s.y=Math.round(s.x*a),(o.y*o.x>i||r&&r<o.y)&&(r&&r<o.y?(o.y=r,o.y%2==0&&o.x--):o.y-=2,s.y=o.y*n,o.x=1+2*Math.ceil((o.y/a-1)/2),s.x=Math.round(s.y/a)),{height:s.y,width:s.x,hideYDots:o.y,hideXDots:o.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:a,maxHiddenAxisDots:e-14,dotSize:n})}this.drawBackground(),this.drawDots(((t,i)=>{var r,n,o,a,h,d;return!(this._options.imageOptions.hideBackgroundDots&&t>=(e-s.hideYDots)/2&&t<(e+s.hideYDots)/2&&i>=(e-s.hideXDots)/2&&i<(e+s.hideXDots)/2||(null===(r=u[t])||void 0===r?void 0:r[i])||(null===(n=u[t-e+7])||void 0===n?void 0:n[i])||(null===(o=u[t])||void 0===o?void 0:o[i-e+7])||(null===(a=c[t])||void 0===a?void 0:a[i])||(null===(h=c[t-e+7])||void 0===h?void 0:h[i])||(null===(d=c[t])||void 0===d?void 0:d[i-e+7]))})),this.drawCorners(),this._options.image&&await this.drawImage({width:s.width,height:s.height,count:e,dotSize:n})}drawBackground(){var t,e,i;const r=this._element,n=this._options;if(r){const r=null===(t=n.backgroundOptions)||void 0===t?void 0:t.gradient,o=null===(e=n.backgroundOptions)||void 0===e?void 0:e.color;let s=n.height,a=n.width;if(r||o){const t=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\");this._backgroundClipPath=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"clipPath\"),this._backgroundClipPath.setAttribute(\"id\",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),(null===(i=n.backgroundOptions)||void 0===i?void 0:i.round)&&(s=a=Math.min(n.width,n.height),t.setAttribute(\"rx\",String(s/2*n.backgroundOptions.round))),t.setAttribute(\"x\",String(this._roundSize((n.width-a)/2))),t.setAttribute(\"y\",String(this._roundSize((n.height-s)/2))),t.setAttribute(\"width\",String(a)),t.setAttribute(\"height\",String(s)),this._backgroundClipPath.appendChild(t),this._createColor({options:r,color:o,additionalRotation:0,x:0,y:0,height:n.height,width:n.width,name:`background-color-${this._instanceId}`})}}}drawDots(t){var e,i;if(!this._qr)throw\"QR code is not defined\";const r=this._options,n=this._qr.getModuleCount();if(n>r.width||n>r.height)throw\"The canvas is too small.\";const o=Math.min(r.width,r.height)-2*r.margin,a=r.shape===d?o/Math.sqrt(2):o,h=this._roundSize(a/n),u=this._roundSize((r.width-n*h)/2),c=this._roundSize((r.height-n*h)/2),l=new s({svg:this._element,type:r.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"clipPath\"),this._dotsClipPath.setAttribute(\"id\",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:null===(e=r.dotsOptions)||void 0===e?void 0:e.gradient,color:r.dotsOptions.color,additionalRotation:0,x:0,y:0,height:r.height,width:r.width,name:`dot-color-${this._instanceId}`});for(let e=0;e<n;e++)for(let r=0;r<n;r++)t&&!t(e,r)||(null===(i=this._qr)||void 0===i?void 0:i.isDark(e,r))&&(l.draw(u+r*h,c+e*h,h,((i,o)=>!(r+i<0||e+o<0||r+i>=n||e+o>=n)&&!(t&&!t(e+o,r+i))&&!!this._qr&&this._qr.isDark(e+o,r+i))),l._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(l._element));if(r.shape===d){const t=this._roundSize((o/h-n)/2),e=n+2*t,i=u-t*h,r=c-t*h,s=[],a=this._roundSize(e/2);for(let i=0;i<e;i++){s[i]=[];for(let r=0;r<e;r++)i>=t-1&&i<=e-t&&r>=t-1&&r<=e-t||Math.sqrt((i-a)*(i-a)+(r-a)*(r-a))>a?s[i][r]=0:s[i][r]=this._qr.isDark(r-2*t<0?r:r>=n?r-2*t:r-t,i-2*t<0?i:i>=n?i-2*t:i-t)?1:0}for(let t=0;t<e;t++)for(let n=0;n<e;n++)s[t][n]&&(l.draw(i+n*h,r+t*h,h,((e,i)=>{var r;return!!(null===(r=s[t+i])||void 0===r?void 0:r[n+e])})),l._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(l._element))}}drawCorners(){if(!this._qr)throw\"QR code is not defined\";const t=this._element,e=this._options;if(!t)throw\"Element code is not defined\";const i=this._qr.getModuleCount(),r=Math.min(e.width,e.height)-2*e.margin,n=e.shape===d?r/Math.sqrt(2):r,o=this._roundSize(n/i),l=7*o,g=3*o,f=this._roundSize((e.width-i*o)/2),w=this._roundSize((e.height-i*o)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((([t,r,n])=>{var d,p,v,_,m,b,y,x,S,C,A,M;const $=f+t*o*(i-7),O=w+r*o*(i-7);let D=this._dotsClipPath,z=this._dotsClipPath;if(((null===(d=e.cornersSquareOptions)||void 0===d?void 0:d.gradient)||(null===(p=e.cornersSquareOptions)||void 0===p?void 0:p.color))&&(D=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"clipPath\"),D.setAttribute(\"id\",`clip-path-corners-square-color-${t}-${r}-${this._instanceId}`),this._defs.appendChild(D),this._cornersSquareClipPath=this._cornersDotClipPath=z=D,this._createColor({options:null===(v=e.cornersSquareOptions)||void 0===v?void 0:v.gradient,color:null===(_=e.cornersSquareOptions)||void 0===_?void 0:_.color,additionalRotation:n,x:$,y:O,height:l,width:l,name:`corners-square-color-${t}-${r}-${this._instanceId}`})),null===(m=e.cornersSquareOptions)||void 0===m?void 0:m.type){const t=new a({svg:this._element,type:e.cornersSquareOptions.type,window:this._window});t.draw($,O,l,n),t._element&&D&&D.appendChild(t._element)}else{const t=new s({svg:this._element,type:e.dotsOptions.type,window:this._window});for(let e=0;e<u.length;e++)for(let i=0;i<u[e].length;i++)(null===(b=u[e])||void 0===b?void 0:b[i])&&(t.draw($+i*o,O+e*o,o,((t,r)=>{var n;return!!(null===(n=u[e+r])||void 0===n?void 0:n[i+t])})),t._element&&D&&D.appendChild(t._element))}if(((null===(y=e.cornersDotOptions)||void 0===y?void 0:y.gradient)||(null===(x=e.cornersDotOptions)||void 0===x?void 0:x.color))&&(z=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"clipPath\"),z.setAttribute(\"id\",`clip-path-corners-dot-color-${t}-${r}-${this._instanceId}`),this._defs.appendChild(z),this._cornersDotClipPath=z,this._createColor({options:null===(S=e.cornersDotOptions)||void 0===S?void 0:S.gradient,color:null===(C=e.cornersDotOptions)||void 0===C?void 0:C.color,additionalRotation:n,x:$+2*o,y:O+2*o,height:g,width:g,name:`corners-dot-color-${t}-${r}-${this._instanceId}`})),null===(A=e.cornersDotOptions)||void 0===A?void 0:A.type){const t=new h({svg:this._element,type:e.cornersDotOptions.type,window:this._window});t.draw($+2*o,O+2*o,g,n),t._element&&z&&z.appendChild(t._element)}else{const t=new s({svg:this._element,type:e.dotsOptions.type,window:this._window});for(let e=0;e<c.length;e++)for(let i=0;i<c[e].length;i++)(null===(M=c[e])||void 0===M?void 0:M[i])&&(t.draw($+i*o,O+e*o,o,((t,r)=>{var n;return!!(null===(n=c[e+r])||void 0===n?void 0:n[i+t])})),t._element&&z&&z.appendChild(t._element))}}))}loadImage(){return new Promise(((t,e)=>{var i;const r=this._options;if(!r.image)return e(\"Image is not defined\");if(null===(i=r.nodeCanvas)||void 0===i?void 0:i.loadImage)r.nodeCanvas.loadImage(r.image).then((e=>{var i,n;if(this._image=e,this._options.imageOptions.saveAsBlob){const t=null===(i=r.nodeCanvas)||void 0===i?void 0:i.createCanvas(this._image.width,this._image.height);null===(n=null==t?void 0:t.getContext(\"2d\"))||void 0===n||n.drawImage(e,0,0),this._imageUri=null==t?void 0:t.toDataURL()}t()})).catch(e);else{const e=new this._window.Image;\"string\"==typeof r.imageOptions.crossOrigin&&(e.crossOrigin=r.imageOptions.crossOrigin),this._image=e,e.onload=async()=>{this._options.imageOptions.saveAsBlob&&(this._imageUri=await async function(t,e){return new Promise((i=>{const r=new e.XMLHttpRequest;r.onload=function(){const t=new e.FileReader;t.onloadend=function(){i(t.result)},t.readAsDataURL(r.response)},r.open(\"GET\",t),r.responseType=\"blob\",r.send()}))}(r.image||\"\",this._window)),t()},e.src=r.image}}))}async drawImage({width:t,height:e,count:i,dotSize:r}){const n=this._options,o=this._roundSize((n.width-i*r)/2),s=this._roundSize((n.height-i*r)/2),a=o+this._roundSize(n.imageOptions.margin+(i*r-t)/2),h=s+this._roundSize(n.imageOptions.margin+(i*r-e)/2),d=t-2*n.imageOptions.margin,u=e-2*n.imageOptions.margin,c=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"image\");c.setAttribute(\"href\",this._imageUri||\"\"),c.setAttribute(\"x\",String(a)),c.setAttribute(\"y\",String(h)),c.setAttribute(\"width\",`${d}px`),c.setAttribute(\"height\",`${u}px`),this._element.appendChild(c)}_createColor({options:t,color:e,additionalRotation:i,x:r,y:n,height:o,width:s,name:a}){const h=s>o?s:o,d=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\");if(d.setAttribute(\"x\",String(r)),d.setAttribute(\"y\",String(n)),d.setAttribute(\"height\",String(o)),d.setAttribute(\"width\",String(s)),d.setAttribute(\"clip-path\",`url('#clip-path-${a}')`),t){let e;if(\"radial\"===t.type)e=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"radialGradient\"),e.setAttribute(\"id\",a),e.setAttribute(\"gradientUnits\",\"userSpaceOnUse\"),e.setAttribute(\"fx\",String(r+s/2)),e.setAttribute(\"fy\",String(n+o/2)),e.setAttribute(\"cx\",String(r+s/2)),e.setAttribute(\"cy\",String(n+o/2)),e.setAttribute(\"r\",String(h/2));else{const h=((t.rotation||0)+i)%(2*Math.PI),d=(h+2*Math.PI)%(2*Math.PI);let u=r+s/2,c=n+o/2,l=r+s/2,g=n+o/2;d>=0&&d<=.25*Math.PI||d>1.75*Math.PI&&d<=2*Math.PI?(u-=s/2,c-=o/2*Math.tan(h),l+=s/2,g+=o/2*Math.tan(h)):d>.25*Math.PI&&d<=.75*Math.PI?(c-=o/2,u-=s/2/Math.tan(h),g+=o/2,l+=s/2/Math.tan(h)):d>.75*Math.PI&&d<=1.25*Math.PI?(u+=s/2,c+=o/2*Math.tan(h),l-=s/2,g-=o/2*Math.tan(h)):d>1.25*Math.PI&&d<=1.75*Math.PI&&(c+=o/2,u+=s/2/Math.tan(h),g-=o/2,l-=s/2/Math.tan(h)),e=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"linearGradient\"),e.setAttribute(\"id\",a),e.setAttribute(\"gradientUnits\",\"userSpaceOnUse\"),e.setAttribute(\"x1\",String(Math.round(u))),e.setAttribute(\"y1\",String(Math.round(c))),e.setAttribute(\"x2\",String(Math.round(l))),e.setAttribute(\"y2\",String(Math.round(g)))}t.colorStops.forEach((({offset:t,color:i})=>{const r=this._window.document.createElementNS(\"http://www.w3.org/2000/svg\",\"stop\");r.setAttribute(\"offset\",100*t+\"%\"),r.setAttribute(\"stop-color\",i),e.appendChild(r)})),d.setAttribute(\"fill\",`url('#${a}')`),this._defs.appendChild(e)}else e&&d.setAttribute(\"fill\",e);this._element.appendChild(d)}}l.instanceCount=0;const g=l,f=\"canvas\",w={};for(let t=0;t<=40;t++)w[t]=t;const p={type:f,shape:\"square\",width:300,height:300,data:\"\",margin:0,qrOptions:{typeNumber:w[0],mode:void 0,errorCorrectionLevel:\"Q\"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:\"square\",color:\"#000\",roundSize:!0},backgroundOptions:{round:0,color:\"#fff\"}};function v(t){const e=Object.assign({},t);if(!e.colorStops||!e.colorStops.length)throw\"Field 'colorStops' is required in gradient\";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map((t=>Object.assign(Object.assign({},t),{offset:Number(t.offset)}))),e}function _(t){const e=Object.assign({},t);return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions=Object.assign(Object.assign({},e.imageOptions),{hideBackgroundDots:Boolean(e.imageOptions.hideBackgroundDots),imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)}),e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions=Object.assign({},e.dotsOptions),e.dotsOptions.gradient&&(e.dotsOptions.gradient=v(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions=Object.assign({},e.cornersSquareOptions),e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=v(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions=Object.assign({},e.cornersDotOptions),e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=v(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions=Object.assign({},e.backgroundOptions),e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=v(e.backgroundOptions.gradient))),e}var m=i(873),b=i.n(m);function y(t){if(!t)throw new Error(\"Extension must be defined\");\".\"===t[0]&&(t=t.substring(1));const e={bmp:\"image/bmp\",gif:\"image/gif\",ico:\"image/vnd.microsoft.icon\",jpeg:\"image/jpeg\",jpg:\"image/jpeg\",png:\"image/png\",svg:\"image/svg+xml\",tif:\"image/tiff\",tiff:\"image/tiff\",webp:\"image/webp\",pdf:\"application/pdf\"}[t.toLowerCase()];if(!e)throw new Error(`Extension \"${t}\" is not supported`);return e}class x{constructor(t){(null==t?void 0:t.jsdom)?this._window=new t.jsdom(\"\",{resources:\"usable\"}).window:this._window=window,this._options=t?_(e(p,t)):p,this.update()}static _clearContainer(t){t&&(t.innerHTML=\"\")}_setupSvg(){if(!this._qr)return;const t=new g(this._options,this._window);this._svg=t.getElement(),this._svgDrawingPromise=t.drawQR(this._qr).then((()=>{var e;this._svg&&(null===(e=this._extension)||void 0===e||e.call(this,t.getElement(),this._options))}))}_setupCanvas(){var t,e;this._qr&&((null===(t=this._options.nodeCanvas)||void 0===t?void 0:t.createCanvas)?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement(\"canvas\"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=null===(e=this._svgDrawingPromise)||void 0===e?void 0:e.then((()=>{var t;if(!this._svg)return;const e=this._svg,i=(new this._window.XMLSerializer).serializeToString(e),r=btoa(i),n=`data:${y(\"svg\")};base64,${r}`;if(null===(t=this._options.nodeCanvas)||void 0===t?void 0:t.loadImage)return this._options.nodeCanvas.loadImage(n).then((t=>{var e,i;t.width=this._options.width,t.height=this._options.height,null===(i=null===(e=this._nodeCanvas)||void 0===e?void 0:e.getContext(\"2d\"))||void 0===i||i.drawImage(t,0,0)}));{const t=new this._window.Image;return new Promise((e=>{t.onload=()=>{var i,r;null===(r=null===(i=this._domCanvas)||void 0===i?void 0:i.getContext(\"2d\"))||void 0===r||r.drawImage(t,0,0),e()},t.src=n}))}})))}async _getElement(t=\"png\"){if(!this._qr)throw\"QR code is empty\";return\"svg\"===t.toLowerCase()?(this._svg&&this._svgDrawingPromise||this._setupSvg(),await this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),await this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)}update(t){x._clearContainer(this._container),this._options=t?_(e(this._options,t)):this._options,this._options.data&&(this._qr=b()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(t){switch(!0){case/^[0-9]*$/.test(t):return\"Numeric\";case/^[0-9A-Z $%*+\\-./:]*$/.test(t):return\"Alphanumeric\";default:return\"Byte\"}}(this._options.data)),this._qr.make(),this._options.type===f?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(t){if(t){if(\"function\"!=typeof t.appendChild)throw\"Container should be a single DOM node\";this._options.type===f?this._domCanvas&&t.appendChild(this._domCanvas):this._svg&&t.appendChild(this._svg),this._container=t}}applyExtension(t){if(!t)throw\"Extension function should be defined.\";this._extension=t,this.update()}deleteExtension(){this._extension=void 0,this.update()}async getRawData(t=\"png\"){if(!this._qr)throw\"QR code is empty\";const e=await this._getElement(t),i=y(t);if(!e)return null;if(\"svg\"===t.toLowerCase()){const t=`<?xml version=\"1.0\" standalone=\"no\"?>\\r\\n${(new this._window.XMLSerializer).serializeToString(e)}`;return\"undefined\"==typeof Blob||this._options.jsdom?Buffer.from(t):new Blob([t],{type:i})}return new Promise((t=>{const r=e;if(\"toBuffer\"in r)if(\"image/png\"===i)t(r.toBuffer(i));else if(\"image/jpeg\"===i)t(r.toBuffer(i));else{if(\"application/pdf\"!==i)throw Error(\"Unsupported extension\");t(r.toBuffer(i))}else\"toBlob\"in r&&r.toBlob(t,i,1)}))}async download(t){if(!this._qr)throw\"QR code is empty\";if(\"undefined\"==typeof Blob)throw\"Cannot download in Node.js, call getRawData instead.\";let e=\"png\",i=\"qr\";\"string\"==typeof t?(e=t,console.warn(\"Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument\")):\"object\"==typeof t&&null!==t&&(t.name&&(i=t.name),t.extension&&(e=t.extension));const r=await this._getElement(e);if(r)if(\"svg\"===e.toLowerCase()){let t=(new XMLSerializer).serializeToString(r);t='<?xml version=\"1.0\" standalone=\"no\"?>\\r\\n'+t,n(`data:${y(e)};charset=utf-8,${encodeURIComponent(t)}`,`${i}.svg`)}else n(r.toDataURL(y(e)),`${i}.${e}`)}}const S=x})(),r.default})()));\n//# sourceMappingURL=qr-code-styling.js.map","export default () => {\r\n  return `\r\n        <!-- Template for hotspots -->\r\n        <button data-hotspot slot=\"hotspot-dot+X-Y+Z\" class=\"dot\" data-position=\"1 -1 1\" data-normal=\"1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dim+X-Y\" class=\"dim\" data-position=\"1 -1 0\" data-normal=\"1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dot+X-Y-Z\" class=\"dot\" data-position=\"1 -1 -1\" data-normal=\"1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dim+X-Z\" class=\"dim\" data-position=\"1 0 -1\" data-normal=\"1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dot+X+Y-Z\" class=\"dot\" data-position=\"1 1 -1\" data-normal=\"0 1 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dim+Y-Z\" class=\"dim\" data-position=\"0 -1 -1\" data-normal=\"0 1 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dot-X+Y-Z\" class=\"dot\" data-position=\"-1 1 -1\" data-normal=\"0 1 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dim-X-Z\" class=\"dim\" data-position=\"-1 0 -1\" data-normal=\"-1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dot-X-Y-Z\" class=\"dot\" data-position=\"-1 -1 -1\" data-normal=\"-1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dim-X-Y\" class=\"dim\" data-position=\"-1 -1 0\" data-normal=\"-1 0 0\"></button>\r\n        <button data-hotspot slot=\"hotspot-dot-X-Y+Z\" class=\"dot\" data-position=\"-1 -1 1\" data-normal=\"-1 0 0\"></button>\r\n        <svg id=\"dimLines\" width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" class=\"dimensionLineContainer\">\r\n            <line class=\"dimensionLine\"></line>\r\n            <line class=\"dimensionLine\"></line>\r\n            <line class=\"dimensionLine\"></line>\r\n            <line class=\"dimensionLine\"></line>\r\n            <line class=\"dimensionLine\"></line>\r\n        </svg>\r\n    `;\r\n};\r\n","export function styleObjectToString(styles) {\r\n  let cssString = \"\";\r\n\r\n  function isMediaQuery(selector) {\r\n    return selector.trim().startsWith(\"@media\");\r\n  }\r\n\r\n  function toKebabCase(str) {\r\n    return str.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n  }\r\n\r\n  function processRules(rules, indentLevel) {\r\n    let result = \"\";\r\n    const indent = \"  \".repeat(indentLevel);\r\n\r\n    for (const property in rules) {\r\n      if (Object.prototype.hasOwnProperty.call(rules, property)) {\r\n        const value = rules[property];\r\n        if (typeof value === \"object\" && !Array.isArray(value)) {\r\n          result += `\\n${indent}${property} {`;\r\n          result += processRules(value, indentLevel + 1);\r\n          result += `\\n${indent}}`;\r\n        } else {\r\n          const propertyName = toKebabCase(property);\r\n          result += `\\n${indent}${propertyName}: ${value};`;\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  for (const selector in styles) {\r\n    if (Object.prototype.hasOwnProperty.call(styles, selector)) {\r\n      const rules = styles[selector];\r\n\r\n      if (typeof rules === \"object\") {\r\n        cssString += `${selector} {`;\r\n        if (isMediaQuery(selector)) {\r\n          // Media query: process nested selectors\r\n          cssString += processRules(rules, 1);\r\n          cssString += `\\n}\\n`;\r\n        } else {\r\n          // Regular selector\r\n          cssString += processRules(rules, 1);\r\n          cssString += `\\n}\\n`;\r\n        }\r\n      } else if (typeof rules === \"string\") {\r\n        // If rules is a string, add it directly\r\n        cssString += `${selector} {\\n  ${rules}\\n}\\n`;\r\n      }\r\n    }\r\n  }\r\n\r\n  return cssString;\r\n}\r\n","export const CDN_URL =\r\n  \"https://cdn.statically.io/gh/ardisplaycorp/bridge/v2.0.2/build\"; // NEW VERSION\r\nexport const BRIDGE_URL = \"https://ardisplaybridge.vercel.app\";\r\n","import hotspotsTemplate from \"./hotspots.js\";\r\nimport { styleObjectToString } from \"../utils/styleObjectToString.js\";\r\nimport { CDN_URL } from \"../config/config.js\";\r\n\r\nconst modalStyles = {\r\n  \".normal-view-container\": {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"block\",\r\n    fontFamily: \"sans-serif\",\r\n    position: \"relative\",\r\n  },\r\n  \".ardisplay-qr-code-button\": {\r\n    all: \"unset\",\r\n    position: \"absolute\",\r\n    top: \"10px\",\r\n    right: \"50%\",\r\n    transform: \"translateX(50%)\",\r\n    background: \"white\",\r\n    cursor: \"pointer\",\r\n    padding: \"10px\",\r\n    zIndex: \"1000\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    gap: \"10px\",\r\n    boxSizing: \"border-box\",\r\n  },\r\n};\r\n\r\nexport default (\r\n  ar,\r\n  cameraControls,\r\n  touchAction,\r\n  modelPoster,\r\n  arPlacement,\r\n  modelData,\r\n  fullWidth\r\n) => {\r\n  const styles = styleObjectToString(modalStyles);\r\n  const template = hotspotsTemplate();\r\n  return `\r\n        <!-- Template for modal view -->\r\n        <style>${styles}</style>\r\n        <div class=\"normal-view-container\" style=\"direction: ltr;\">\r\n            <model-viewer\r\n                ar\r\n                shadow-intensity=\"${modelData.shadow}\"\r\n                ar-placement=\"${\r\n                  (modelData.options &&\r\n                    modelData.options.length > 0 &&\r\n                    modelData.options[0].placement) ||\r\n                  modelData.placement\r\n                }\"\r\n                ar-modes=\"webxr scene-viewer quick-look\"\r\n                ar-scale=\"fixed\"\r\n                camera-controls=\"true\"\r\n                disable-pan=\"true\"\r\n                disable-tap=\"true\"\r\n                interaction-prompt=\"none\"\r\n                interpolation-decay=\"40\"\r\n                touch-action=\"none\"\r\n                max-field-of-view=\"auto\"\r\n                field-of-view=\"auto\"\r\n                camera-orbit=\"0deg 75deg 105%\"\r\n                ar-status=\"not-presenting\"\r\n            >\r\n                ${template}\r\n                <button class=\"ardisplay-qr-code-button\" style=\"background-color: ${\r\n                  modelData.arBtn.btnBgColor\r\n                };color: ${modelData.arBtn.btnTextColor};border-radius: ${\r\n    modelData.arBtn.cornerRadius\r\n  }px;font-size: ${\r\n    modelData.arBtn.btnSize - 6\r\n  }px;text-wrap: nowrap;box-sizing: border-box;\">\r\n                    ${\r\n                      modelData.arBtn.btnIcon\r\n                        ? `<i data-lucide=\"${modelData.arBtn.btnIcon}\" style=\"width: 24px; height: 24px;color: inherit;\"></i>`\r\n                        : \"\"\r\n                    }\r\n                    ${modelData.arBtn.btnText}\r\n                </button>\r\n            </model-viewer>\r\n        </div>\r\n    `;\r\n};\r\n","import hotspotsTemplate from \"./hotspots.js\";\nimport { styleObjectToString } from \"../utils/styleObjectToString.js\";\nimport { CDN_URL } from \"../config/config.js\";\n\nconst modalStyles = {\n  \".ardisplay-custom-model-viewer-container\": {\n    position: \"relative\",\n    width: \"100%\",\n    height: \"100%\",\n    display: \"block\",\n    fontFamily: \"sans-serif\",\n  },\n  \".ardisplay-preview-image\": {\n    width: \"100%\",\n    height: \"100%\",\n    objectFit: \"cover\",\n    display: \"block\",\n  },\n  \".ardisplay-view-3d-button\": {\n    bottom: \"10px\",\n    right: \"10px\",\n    padding: \"10px 20px\",\n    backgroundColor: \"rgba(0, 0, 0, 0.75)\",\n    color: \"white\",\n    border: \"none\",\n    borderRadius: \"50px\",\n    cursor: \"pointer\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: \"10px\",\n  },\n  \".ardisplay-view-3d-button svg\": {\n    fill: \"white\",\n  },\n};\n\nexport default (\n  ar,\n  cameraControls,\n  touchAction,\n  modelPoster,\n  arPlacement,\n  modelData,\n  fullWidth\n) => {\n  const styles = styleObjectToString(modalStyles);\n  const template = hotspotsTemplate();\n  return `\n        <!-- Template for modal view -->\n        <style>${styles}</style>\n        <div class=\"ardisplay-custom-model-viewer-container\" style=\"direction: ltr;\">\n            <button class=\"ardisplay-view-3d-button\" style=\"background-color: ${\n              modelData.arBtn.btnBgColor\n            };color: ${modelData.arBtn.btnTextColor};border-radius: ${\n    modelData.arBtn.cornerRadius\n  }px;font-size: ${\n    modelData.arBtn.btnSize - 6\n  }px;box-sizing: border-box;width: ${fullWidth ? \"100%\" : \"fit-content\"};\">\n                <svg viewBox=\"0 0 24 24\" focusable=\"false\" width=\"24\" height=\"24\" aria-hidden=\"true\" class=\"pip-svg-icon pip-btn__icon\"><path d=\"M11 16.9766c.3294.0154.663.0233 1 .0233 2.2351 0 4.3234-.3458 6-.9495 1.7881-.6438 4-1.8975 4-4.0505 0-1.9568-1.8939-3.1985-3.5147-3.864l-1.5605 1.5606C17.8623 9.9943 20 10.7292 20 11.9999c0 .9329-1.2789 1.5728-2 1.8958-1.8614.8335-3.9768 1.1042-6 1.1042-.3392 0-.6729-.0088-1-.0257v-1.9743l-3 3 3 3v2.0233zm2-9.9532A21.3903 21.3903 0 0 0 12.0001 7c-2.235 0-4.3234.3457-6 .9494-1.7881.6438-4 1.8976-4 4.0506 0 1.9568 1.894 3.1984 3.5146 3.8639l1.5606-1.5605C6.1378 14.0057 4 13.2707 4 12.0001c0-.9329 1.2789-1.5729 2-1.8958 1.8614-.8336 3.9767-1.1042 6-1.1042.3392 0 .6729.0087.9999.0257V11l3-3-3-3v2.0234z\"></path></svg>\n                <span>View in 3D</span>\n            </button>\n        </div>\n    `;\n};\n","import hotspotsTemplate from \"./hotspots.js\";\nimport { styleObjectToString } from \"../utils/styleObjectToString.js\";\nimport { CDN_URL } from \"../config/config.js\";\n\nconst modalStyles = {\n  \"model-viewer\": {\n    top: 0,\n    left: 0,\n    opacity: 0,\n    zIndex: -100,\n    position: \"absolute\",\n  },\n  \".ardisplay-qr-code-button\": {\n    all: \"unset\",\n    background: \"white\",\n    cursor: \"pointer\",\n    padding: \"10px\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: \"10px\",\n    boxSizing: \"border-box\",\n  },\n};\n\nexport default (\n  ar,\n  cameraControls,\n  touchAction,\n  modelPoster,\n  arPlacement,\n  modelData,\n  fullWidth\n) => {\n  const styles = styleObjectToString(modalStyles);\n  const template = hotspotsTemplate();\n  return `\n        <!-- Template for modal view -->\n        <style>${styles}</style>\n        <button class=\"ardisplay-qr-code-button\" style=\"background-color: ${\n          modelData.arBtn.btnBgColor\n        };color: ${modelData.arBtn.btnTextColor};border-radius: ${\n    modelData.arBtn.cornerRadius\n  }px;font-size: ${\n    modelData.arBtn.btnSize - 6\n  }px;text-wrap: nowrap;direction: ltr;box-sizing: border-box;\">\n            ${\n              modelData.arBtn.btnIcon\n                ? `<i data-lucide=\"${modelData.arBtn.btnIcon}\" style=\"width: 24px; height: 24px;color: inherit;\"></i>`\n                : \"\"\n            }\n            ${modelData.arBtn.btnText}\n        </button>\n        <model-viewer\n            ar\n            shadow-intensity=\"${modelData.shadow}\"\n            ar-placement=\"${\n              (modelData.options &&\n                modelData.options.length > 0 &&\n                modelData.options[0].placement) ||\n              modelData.placement\n            }\"\n            ar-modes=\"webxr scene-viewer quick-look\"\n            ar-scale=\"fixed\"\n            camera-controls=\"true\"\n            disable-pan=\"true\"\n            disable-tap=\"true\"\n            ar-status=\"not-presenting\"\n        >\n            ${template}\n        </model-viewer>\n    `;\n};\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  \"stroke-width\": 2,\n  \"stroke-linecap\": \"round\",\n  \"stroke-linejoin\": \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst Blocks = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\"rect\", { width: \"7\", height: \"7\", x: \"14\", y: \"3\", rx: \"1\" }],\n    [\n      \"path\",\n      {\n        d: \"M10 21V8a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H3\"\n      }\n    ]\n  ]\n];\n\nexport { Blocks as default };\n//# sourceMappingURL=blocks.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst Box = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\n      \"path\",\n      {\n        d: \"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z\"\n      }\n    ],\n    [\"path\", { d: \"m3.3 7 8.7 5 8.7-5\" }],\n    [\"path\", { d: \"M12 22V12\" }]\n  ]\n];\n\nexport { Box as default };\n//# sourceMappingURL=box.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst Eye = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\n      \"path\",\n      {\n        d: \"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\"\n      }\n    ],\n    [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\" }]\n  ]\n];\n\nexport { Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst FileAxis3d = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\" }],\n    [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\" }],\n    [\"path\", { d: \"m8 18 4-4\" }],\n    [\"path\", { d: \"M8 10v8h8\" }]\n  ]\n];\n\nexport { FileAxis3d as default };\n//# sourceMappingURL=file-axis-3d.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst Rotate3d = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\n      \"path\",\n      {\n        d: \"M16.466 7.5C15.643 4.237 13.952 2 12 2 9.239 2 7 6.477 7 12s2.239 10 5 10c.342 0 .677-.069 1-.2\"\n      }\n    ],\n    [\"path\", { d: \"m15.194 13.707 3.814 1.86-1.86 3.814\" }],\n    [\n      \"path\",\n      {\n        d: \"M19 15.57c-1.804.885-4.274 1.43-7 1.43-5.523 0-10-2.239-10-5s4.477-5 10-5c4.838 0 8.873 1.718 9.8 4\"\n      }\n    ]\n  ]\n];\n\nexport { Rotate3d as default };\n//# sourceMappingURL=rotate-3d.js.map\n","/**\n * @license lucide v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport defaultAttributes from '../defaultAttributes.js';\n\nconst Scan = [\n  \"svg\",\n  defaultAttributes,\n  [\n    [\"path\", { d: \"M3 7V5a2 2 0 0 1 2-2h2\" }],\n    [\"path\", { d: \"M17 3h2a2 2 0 0 1 2 2v2\" }],\n    [\"path\", { d: \"M21 17v2a2 2 0 0 1-2 2h-2\" }],\n    [\"path\", { d: \"M7 21H5a2 2 0 0 1-2-2v-2\" }]\n  ]\n];\n\nexport { Scan as default };\n//# sourceMappingURL=scan.js.map\n","/**\n * Helper function to lazy load model-viewer only when needed\n */\nexport async function lazyLoadModelViewerIfNeeded() {\n  // If the component is already defined, no need to import again\n  if (!window.customElements.get(\"model-viewer\")) {\n    try {\n      // Dynamically import model-viewer\n      await import(\"@google/model-viewer\");\n      return true;\n    } catch (error) {\n      console.error(\"Failed to load model-viewer:\", error);\n      return false;\n    }\n  }\n  return true;\n}\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.count * itemSize;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst tupleOffset = offset / itemSize;\n\t\t\tfor ( let j = 0, l = attribute.count; j < l; j ++ ) {\n\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tconst value = attribute.getComponent( j, c );\n\t\t\t\t\tresult.setComponent( j + tupleOffset, c, value );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tarray.set( attribute.array, offset );\n\n\t\t}\n\n\t\toffset += attribute.count * itemSize;\n\n\t}\n\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute}\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new attr.constructor(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\tif ( morphAttributes ) {\n\n\t\t\tif ( ! tmpMorphAttributes[ name ] ) tmpMorphAttributes[ name ] = [];\n\t\t\tmorphAttributes.forEach( ( morphAttr, i ) => {\n\n\t\t\t\tconst array = new morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize );\n\t\t\t\ttmpMorphAttributes[ name ][ i ] = new morphAttr.constructor( array, morphAttr.itemSize, morphAttr.normalized );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newArray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewArray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttributes ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttributes.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttributes[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new tmpAttribute.constructor(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new tmpMorphAttribute.constructor(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsDispersionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_DISPERSION: 'KHR_materials_dispersion',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials dispersion Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_dispersion\n */\nclass GLTFMaterialsDispersionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_DISPERSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.dispersion = extension.dispersion !== undefined ? extension.dispersion : 0;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap, LinearSRGBColorSpace, reject );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet safariVersion = - 1;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tconst userAgent = navigator.userAgent;\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( userAgent ) === true;\n\t\t\tconst safariMatch = userAgent.match( /Version\\/(\\d+)/ );\n\t\t\tsafariVersion = isSafari && safariMatch ? parseInt( safariMatch[ 1 ], 10 ) : - 1;\n\n\t\t\tisFirefox = userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || ( isSafari && safariVersion < 17 ) || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tfor ( const scene of result.scenes ) {\n\n\t\t\t\t\tscene.updateMatrixWorld();\n\n\t\t\t\t}\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\t// Ignore normalized since we copy from sparse\n\t\t\t\tbufferAttribute.normalized = false;\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute.normalized = normalized;\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( texture, sourceDef );\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tColorManagement,\n\tFileLoader,\n\tLoader,\n\tLinearSRGBColorSpace,\n\tSRGBColorSpace\n} from 'three';\n\nconst _taskCache = new WeakMap();\n\nclass DRACOLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.decoderPath = '';\n\t\tthis.decoderConfig = {};\n\t\tthis.decoderBinary = null;\n\t\tthis.decoderPending = null;\n\n\t\tthis.workerLimit = 4;\n\t\tthis.workerPool = [];\n\t\tthis.workerNextTaskID = 1;\n\t\tthis.workerSourceURL = '';\n\n\t\tthis.defaultAttributeIDs = {\n\t\t\tposition: 'POSITION',\n\t\t\tnormal: 'NORMAL',\n\t\t\tcolor: 'COLOR',\n\t\t\tuv: 'TEX_COORD'\n\t\t};\n\t\tthis.defaultAttributeTypes = {\n\t\t\tposition: 'Float32Array',\n\t\t\tnormal: 'Float32Array',\n\t\t\tcolor: 'Float32Array',\n\t\t\tuv: 'Float32Array'\n\t\t};\n\n\t}\n\n\tsetDecoderPath( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t}\n\n\tsetDecoderConfig( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t}\n\n\tsetWorkerLimit( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis.parse( buffer, onLoad, onError );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\n\tparse( buffer, onLoad, onError = ()=>{} ) {\n\n\t\tthis.decodeDracoFile( buffer, onLoad, null, null, SRGBColorSpace, onError ).catch( onError );\n\n\t}\n\n\tdecodeDracoFile( buffer, callback, attributeIDs, attributeTypes, vertexColorSpace = LinearSRGBColorSpace, onError = () => {} ) {\n\n\t\tconst taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs,\n\t\t\tvertexColorSpace: vertexColorSpace,\n\t\t};\n\n\t\treturn this.decodeGeometry( buffer, taskConfig ).then( callback ).catch( onError );\n\n\t}\n\n\tdecodeGeometry( buffer, taskConfig ) {\n\n\t\tconst taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( _taskCache.has( buffer ) ) {\n\n\t\t\tconst cachedTask = _taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet worker;\n\t\tconst taskID = this.workerNextTaskID ++;\n\t\tconst taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tconst geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\t// Note: replaced '.finally()' with '.catch().then()' block - iOS 11 support (#19416)\n\t\tgeometryPending\n\t\t\t.catch( () => true )\n\t\t\t.then( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\t_taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t}\n\n\t_createGeometry( geometryData ) {\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tconst result = geometryData.attributes[ i ];\n\t\t\tconst name = result.name;\n\t\t\tconst array = result.array;\n\t\t\tconst itemSize = result.itemSize;\n\n\t\t\tconst attribute = new BufferAttribute( array, itemSize );\n\n\t\t\tif ( name === 'color' ) {\n\n\t\t\t\tthis._assignVertexColorSpace( attribute, result.vertexColorSpace );\n\n\t\t\t\tattribute.normalized = ( array instanceof Float32Array ) === false;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( name, attribute );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n\t_assignVertexColorSpace( attribute, inputColorSpace ) {\n\n\t\t// While .drc files do not specify colorspace, the only 'official' tooling\n\t\t// is PLY and OBJ converters, which use sRGB. We'll assume sRGB when a .drc\n\t\t// file is passed into .load() or .parse(). GLTFLoader uses internal APIs\n\t\t// to decode geometry, and vertex colors are already Linear-sRGB in there.\n\n\t\tif ( inputColorSpace !== SRGBColorSpace ) return;\n\n\t\tconst _color = new Color();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\t_color.fromBufferAttribute( attribute, i );\n\t\t\tColorManagement.toWorkingColorSpace( _color, SRGBColorSpace );\n\t\t\tattribute.setXYZ( i, _color.r, _color.g, _color.b );\n\n\t\t}\n\n\t}\n\n\t_loadLibrary( url, responseType ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t}\n\n\tpreload() {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t}\n\n\t_initDecoder() {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tconst useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tconst librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tconst jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tconst fn = DRACOWorker.toString();\n\n\t\t\t\tconst body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t}\n\n\t_getWorker( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tconst worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tconst message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t}\n\n\t_releaseTask( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t}\n\n\tdebug() {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\tif ( this.workerSourceURL !== '' ) {\n\n\t\t\tURL.revokeObjectURL( this.workerSourceURL );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/* WEB WORKER */\n\nfunction DRACOWorker() {\n\n\tlet decoderConfig;\n\tlet decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tconst message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig ); // eslint-disable-line no-undef\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tconst buffer = message.buffer;\n\t\t\t\tconst taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tconst draco = module.draco;\n\t\t\t\t\tconst decoder = new draco.Decoder();\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tconst geometry = decodeGeometry( draco, decoder, new Int8Array( buffer ), taskConfig );\n\n\t\t\t\t\t\tconst buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, array, taskConfig ) {\n\n\t\tconst attributeIDs = taskConfig.attributeIDs;\n\t\tconst attributeTypes = taskConfig.attributeTypes;\n\n\t\tlet dracoGeometry;\n\t\tlet decodingStatus;\n\n\t\tconst geometryType = decoder.GetEncodedGeometryType( array );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeArrayToMesh( array, array.byteLength, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeArrayToPointCloud( array, array.byteLength, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tconst geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( const attributeName in attributeIDs ) {\n\n\t\t\tconst attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tlet attribute;\n\t\t\tlet attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tconst attributeResult = decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute );\n\n\t\t\tif ( attributeName === 'color' ) {\n\n\t\t\t\tattributeResult.vertexColorSpace = taskConfig.vertexColorSpace;\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( attributeResult );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tgeometry.index = decodeIndex( draco, decoder, dracoGeometry );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeIndex( draco, decoder, dracoGeometry ) {\n\n\t\tconst numFaces = dracoGeometry.num_faces();\n\t\tconst numIndices = numFaces * 3;\n\t\tconst byteLength = numIndices * 4;\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetTrianglesUInt32Array( dracoGeometry, byteLength, ptr );\n\t\tconst index = new Uint32Array( draco.HEAPF32.buffer, ptr, numIndices ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn { array: index, itemSize: 1 };\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tconst numComponents = attribute.num_components();\n\t\tconst numPoints = dracoGeometry.num_points();\n\t\tconst numValues = numPoints * numComponents;\n\t\tconst byteLength = numValues * attributeType.BYTES_PER_ELEMENT;\n\t\tconst dataType = getDracoDataType( draco, attributeType );\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetAttributeDataArrayForAllPoints( dracoGeometry, attribute, dataType, byteLength, ptr );\n\t\tconst array = new attributeType( draco.HEAPF32.buffer, ptr, numValues ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n\tfunction getDracoDataType( draco, attributeType ) {\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array: return draco.DT_FLOAT32;\n\t\t\tcase Int8Array: return draco.DT_INT8;\n\t\t\tcase Int16Array: return draco.DT_INT16;\n\t\t\tcase Int32Array: return draco.DT_INT32;\n\t\t\tcase Uint8Array: return draco.DT_UINT8;\n\t\t\tcase Uint16Array: return draco.DT_UINT16;\n\t\t\tcase Uint32Array: return draco.DT_UINT32;\n\n\t\t}\n\n\t}\n\n}\n\nexport { DRACOLoader };\n","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.8.2\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? (st.l ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 20) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) {\n        if (ev.data.length) {\n            strm.push(ev.data[0], ev.data[1]);\n            postMessage([ev.data[0].length]);\n        }\n        else\n            strm.flush();\n    };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, flush, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else if (dat.length == 1) {\n            strm.queuedSize -= dat[0];\n            if (strm.ondrain)\n                strm.ondrain(dat[0]);\n        }\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.queuedSize = 0;\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        strm.queuedSize += d.length;\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n    if (flush) {\n        strm.flush = function () { w.postMessage([]); };\n    }\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            this.b.set(chunk.subarray(0, split), this.s.z);\n            this.s.z = this.b.length;\n            this.p(this.b, false);\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * deflated output for small inputs.\n     */\n    Deflate.prototype.flush = function () {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        this.p(this.b, false);\n        this.s.w = this.s.i, this.s.i -= 2;\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6, 1);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7, 0);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * GZIPped output for small inputs.\n     */\n    Gzip.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8, 1);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l && !final) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, 0, function (offset) { return _this.onmember && _this.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * zlibbed output for small inputs.\n     */\n    Zlib.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10, 1);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11, 0);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.o = StrmOpt.call(this, opts, cb) || {};\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n    }\n    // init substream\n    // overriden by AsyncDecompress\n    Decompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (dat, final) {\n            _this.ondata(dat, final);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o)\n                        : new this.Z(this.o);\n                this.i();\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        Decompress.call(this, opts, cb);\n        this.queuedSize = 0;\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n    }\n    AsyncDecompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        };\n        this.s.ondrain = function (size) {\n            _this.queuedSize -= size;\n            if (_this.ondrain)\n                _this.ondrain(size);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        this.queuedSize += chunk.length;\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this.ondata(err, dat, final);\n                    _this.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this.d & 1))\n                        return;\n                    _this.u.splice(-1, 1);\n                    _this.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this = this;\n        this.i = new Inflate(function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this.k[0] == chks_3 && _this.c)\n                                        _this.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    // Synchronously decompress under 512KB, or barely-compressed data\n                    if (su < 524288 || sc > 0.8 * su) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","import {\n\tPlaneGeometry,\n\tShaderMaterial,\n\tUniform,\n\tMesh,\n\tPerspectiveCamera,\n\tScene,\n\tWebGLRenderer,\n\tCanvasTexture,\n\tSRGBColorSpace\n} from 'three';\n\nlet _renderer;\nlet fullscreenQuadGeometry;\nlet fullscreenQuadMaterial;\nlet fullscreenQuad;\n\nexport function decompress( texture, maxTextureSize = Infinity, renderer = null ) {\n\n\tif ( ! fullscreenQuadGeometry ) fullscreenQuadGeometry = new PlaneGeometry( 2, 2, 1, 1 );\n\tif ( ! fullscreenQuadMaterial ) fullscreenQuadMaterial = new ShaderMaterial( {\n\t\tuniforms: { blitTexture: new Uniform( texture ) },\n\t\tvertexShader: `\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main(){\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = vec4(position.xy * 1.0,0.,.999999);\n\t\t\t}`,\n\t\tfragmentShader: `\n\t\t\tuniform sampler2D blitTexture; \n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main(){ \n\t\t\t\tgl_FragColor = vec4(vUv.xy, 0, 1);\n\t\t\t\t\n\t\t\t\t#ifdef IS_SRGB\n\t\t\t\tgl_FragColor = sRGBTransferOETF( texture2D( blitTexture, vUv) );\n\t\t\t\t#else\n\t\t\t\tgl_FragColor = texture2D( blitTexture, vUv);\n\t\t\t\t#endif\n\t\t\t}`\n\t} );\n\n\tfullscreenQuadMaterial.uniforms.blitTexture.value = texture;\n\tfullscreenQuadMaterial.defines.IS_SRGB = texture.colorSpace == SRGBColorSpace;\n\tfullscreenQuadMaterial.needsUpdate = true;\n\n\tif ( ! fullscreenQuad ) {\n\n\t\tfullscreenQuad = new Mesh( fullscreenQuadGeometry, fullscreenQuadMaterial );\n\t\tfullscreenQuad.frustumCulled = false;\n\n\t}\n\n\tconst _camera = new PerspectiveCamera();\n\tconst _scene = new Scene();\n\t_scene.add( fullscreenQuad );\n\n\tif ( renderer === null ) {\n\n\t\trenderer = _renderer = new WebGLRenderer( { antialias: false } );\n\n\t}\n\n\tconst width = Math.min( texture.image.width, maxTextureSize );\n\tconst height = Math.min( texture.image.height, maxTextureSize );\n\n\trenderer.setSize( width, height );\n\trenderer.clear();\n\trenderer.render( _scene, _camera );\n\n\tconst canvas = document.createElement( 'canvas' );\n\tconst context = canvas.getContext( '2d' );\n\n\tcanvas.width = width;\n\tcanvas.height = height;\n\n\tcontext.drawImage( renderer.domElement, 0, 0, width, height );\n\n\tconst readableTexture = new CanvasTexture( canvas );\n\n\treadableTexture.minFilter = texture.minFilter;\n\treadableTexture.magFilter = texture.magFilter;\n\treadableTexture.wrapS = texture.wrapS;\n\treadableTexture.wrapT = texture.wrapT;\n\treadableTexture.colorSpace = texture.colorSpace;\n\treadableTexture.name = texture.name;\n\n\tif ( _renderer ) {\n\n\t\t_renderer.forceContextLoss();\n\t\t_renderer.dispose();\n\t\t_renderer = null;\n\n\t}\n\n\treturn readableTexture;\n\n}\n","import {\n\tNoColorSpace,\n\tDoubleSide,\n\tColor,\n} from 'three';\n\nimport {\n\tstrToU8,\n\tzipSync,\n} from '../libs/fflate.module.js';\n\nimport { decompress } from './../utils/TextureUtils.js';\n\nclass USDZExporter {\n\n\tparse( scene, onDone, onError, options ) {\n\n\t\tthis.parseAsync( scene, options ).then( onDone ).catch( onError );\n\n\t}\n\n\tasync parseAsync( scene, options = {} ) {\n\n\t\toptions = Object.assign( {\n\t\t\tar: {\n\t\t\t\tanchoring: { type: 'plane' },\n\t\t\t\tplaneAnchoring: { alignment: 'horizontal' }\n\t\t\t},\n\t\t\tincludeAnchoringProperties: true,\n\t\t\tquickLookCompatible: false,\n\t\t\tmaxTextureSize: 1024,\n\t\t}, options );\n\n\t\tconst files = {};\n\t\tconst modelFileName = 'model.usda';\n\n\t\t// model file should be first in USDZ archive so we init it here\n\t\tfiles[ modelFileName ] = null;\n\n\t\tlet output = buildHeader();\n\n\t\toutput += buildSceneStart( options );\n\n\t\tconst materials = {};\n\t\tconst textures = {};\n\n\t\tscene.traverseVisible( ( object ) => {\n\n\t\t\tif ( object.isMesh ) {\n\n\t\t\t\tconst geometry = object.geometry;\n\t\t\t\tconst material = object.material;\n\n\t\t\t\tif ( material.isMeshStandardMaterial ) {\n\n\t\t\t\t\tconst geometryFileName = 'geometries/Geometry_' + geometry.id + '.usda';\n\n\t\t\t\t\tif ( ! ( geometryFileName in files ) ) {\n\n\t\t\t\t\t\tconst meshObject = buildMeshObject( geometry );\n\t\t\t\t\t\tfiles[ geometryFileName ] = buildUSDFileAsString( meshObject );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! ( material.uuid in materials ) ) {\n\n\t\t\t\t\t\tmaterials[ material.uuid ] = material;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutput += buildXform( object, geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)', object );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isCamera ) {\n\n\t\t\t\toutput += buildCamera( object );\n\n\t\t\t}\n\n\t\t} );\n\n\n\t\toutput += buildSceneEnd();\n\n\t\toutput += buildMaterials( materials, textures, options.quickLookCompatible );\n\n\t\tfiles[ modelFileName ] = strToU8( output );\n\t\toutput = null;\n\n\t\tfor ( const id in textures ) {\n\n\t\t\tlet texture = textures[ id ];\n\n\t\t\tif ( texture.isCompressedTexture === true ) {\n\n\t\t\t\ttexture = decompress( texture );\n\n\t\t\t}\n\n\t\t\tconst canvas = imageToCanvas( texture.image, texture.flipY, options.maxTextureSize );\n\t\t\tconst blob = await new Promise( resolve => canvas.toBlob( resolve, 'image/png', 1 ) );\n\n\t\t\tfiles[ `textures/Texture_${ id }.png` ] = new Uint8Array( await blob.arrayBuffer() );\n\n\t\t}\n\n\t\t// 64 byte alignment\n\t\t// https://github.com/101arrowz/fflate/issues/39#issuecomment-777263109\n\n\t\tlet offset = 0;\n\n\t\tfor ( const filename in files ) {\n\n\t\t\tconst file = files[ filename ];\n\t\t\tconst headerSize = 34 + filename.length;\n\n\t\t\toffset += headerSize;\n\n\t\t\tconst offsetMod64 = offset & 63;\n\n\t\t\tif ( offsetMod64 !== 4 ) {\n\n\t\t\t\tconst padLength = 64 - offsetMod64;\n\t\t\t\tconst padding = new Uint8Array( padLength );\n\n\t\t\t\tfiles[ filename ] = [ file, { extra: { 12345: padding } } ];\n\n\t\t\t}\n\n\t\t\toffset = file.length;\n\n\t\t}\n\n\t\treturn zipSync( files, { level: 0 } );\n\n\t}\n\n}\n\nfunction imageToCanvas( image, flipY, maxTextureSize ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof OffscreenCanvas !== 'undefined' && image instanceof OffscreenCanvas ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\tconst scale = maxTextureSize / Math.max( image.width, image.height );\n\n\t\tconst canvas = document.createElement( 'canvas' );\n\t\tcanvas.width = image.width * Math.min( 1, scale );\n\t\tcanvas.height = image.height * Math.min( 1, scale );\n\n\t\tconst context = canvas.getContext( '2d' );\n\n\t\t// TODO: We should be able to do this in the UsdTransform2d?\n\n\t\tif ( flipY === true ) {\n\n\t\t\tcontext.translate( 0, canvas.height );\n\t\t\tcontext.scale( 1, - 1 );\n\n\t\t}\n\n\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\n\n\t\treturn canvas;\n\n\t} else {\n\n\t\tthrow new Error( 'THREE.USDZExporter: No valid image data found. Unable to process texture.' );\n\n\t}\n\n}\n\n//\n\nconst PRECISION = 7;\n\nfunction buildHeader() {\n\n\treturn `#usda 1.0\n(\n\tcustomLayerData = {\n\t\tstring creator = \"Three.js USDZExporter\"\n\t}\n\tdefaultPrim = \"Root\"\n\tmetersPerUnit = 1\n\tupAxis = \"Y\"\n)\n\n`;\n\n}\n\nfunction buildSceneStart( options ) {\n\n\tconst alignment = options.includeAnchoringProperties === true ? `\n\t\ttoken preliminary:anchoring:type = \"${options.ar.anchoring.type}\"\n\t\ttoken preliminary:planeAnchoring:alignment = \"${options.ar.planeAnchoring.alignment}\"\n\t` : '';\n\treturn `def Xform \"Root\"\n{\n\tdef Scope \"Scenes\" (\n\t\tkind = \"sceneLibrary\"\n\t)\n\t{\n\t\tdef Xform \"Scene\" (\n\t\t\tcustomData = {\n\t\t\t\tbool preliminary_collidesWithEnvironment = 0\n\t\t\t\tstring sceneName = \"Scene\"\n\t\t\t}\n\t\t\tsceneName = \"Scene\"\n\t\t)\n\t\t{${alignment}\n`;\n\n}\n\nfunction buildSceneEnd() {\n\n\treturn `\n\t\t}\n\t}\n}\n\n`;\n\n}\n\nfunction buildUSDFileAsString( dataToInsert ) {\n\n\tlet output = buildHeader();\n\toutput += dataToInsert;\n\treturn strToU8( output );\n\n}\n\n// Xform\n\nfunction buildXform( object, geometry, material ) {\n\n\tconst name = 'Object_' + object.id;\n\tconst transform = buildMatrix( object.matrixWorld );\n\n\tif ( object.matrixWorld.determinant() < 0 ) {\n\n\t\tconsole.warn( 'THREE.USDZExporter: USDZ does not support negative scales', object );\n\n\t}\n\n\treturn `def Xform \"${ name }\" (\n\tprepend references = @./geometries/Geometry_${ geometry.id }.usda@</Geometry>\n\tprepend apiSchemas = [\"MaterialBindingAPI\"]\n)\n{\n\tmatrix4d xformOp:transform = ${ transform }\n\tuniform token[] xformOpOrder = [\"xformOp:transform\"]\n\n\trel material:binding = </Materials/Material_${ material.id }>\n}\n\n`;\n\n}\n\nfunction buildMatrix( matrix ) {\n\n\tconst array = matrix.elements;\n\n\treturn `( ${ buildMatrixRow( array, 0 ) }, ${ buildMatrixRow( array, 4 ) }, ${ buildMatrixRow( array, 8 ) }, ${ buildMatrixRow( array, 12 ) } )`;\n\n}\n\nfunction buildMatrixRow( array, offset ) {\n\n\treturn `(${ array[ offset + 0 ] }, ${ array[ offset + 1 ] }, ${ array[ offset + 2 ] }, ${ array[ offset + 3 ] })`;\n\n}\n\n// Mesh\n\nfunction buildMeshObject( geometry ) {\n\n\tconst mesh = buildMesh( geometry );\n\treturn `\ndef \"Geometry\"\n{\n${mesh}\n}\n`;\n\n}\n\nfunction buildMesh( geometry ) {\n\n\tconst name = 'Geometry';\n\tconst attributes = geometry.attributes;\n\tconst count = attributes.position.count;\n\n\treturn `\n\tdef Mesh \"${ name }\"\n\t{\n\t\tint[] faceVertexCounts = [${ buildMeshVertexCount( geometry ) }]\n\t\tint[] faceVertexIndices = [${ buildMeshVertexIndices( geometry ) }]\n\t\tnormal3f[] normals = [${ buildVector3Array( attributes.normal, count )}] (\n\t\t\tinterpolation = \"vertex\"\n\t\t)\n\t\tpoint3f[] points = [${ buildVector3Array( attributes.position, count )}]\n${ buildPrimvars( attributes ) }\n\t\tuniform token subdivisionScheme = \"none\"\n\t}\n`;\n\n}\n\nfunction buildMeshVertexCount( geometry ) {\n\n\tconst count = geometry.index !== null ? geometry.index.count : geometry.attributes.position.count;\n\n\treturn Array( count / 3 ).fill( 3 ).join( ', ' );\n\n}\n\nfunction buildMeshVertexIndices( geometry ) {\n\n\tconst index = geometry.index;\n\tconst array = [];\n\n\tif ( index !== null ) {\n\n\t\tfor ( let i = 0; i < index.count; i ++ ) {\n\n\t\t\tarray.push( index.getX( i ) );\n\n\t\t}\n\n\t} else {\n\n\t\tconst length = geometry.attributes.position.count;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tarray.push( i );\n\n\t\t}\n\n\t}\n\n\treturn array.join( ', ' );\n\n}\n\nfunction buildVector3Array( attribute, count ) {\n\n\tif ( attribute === undefined ) {\n\n\t\tconsole.warn( 'USDZExporter: Normals missing.' );\n\t\treturn Array( count ).fill( '(0, 0, 0)' ).join( ', ' );\n\n\t}\n\n\tconst array = [];\n\n\tfor ( let i = 0; i < attribute.count; i ++ ) {\n\n\t\tconst x = attribute.getX( i );\n\t\tconst y = attribute.getY( i );\n\t\tconst z = attribute.getZ( i );\n\n\t\tarray.push( `(${ x.toPrecision( PRECISION ) }, ${ y.toPrecision( PRECISION ) }, ${ z.toPrecision( PRECISION ) })` );\n\n\t}\n\n\treturn array.join( ', ' );\n\n}\n\nfunction buildVector2Array( attribute ) {\n\n\tconst array = [];\n\n\tfor ( let i = 0; i < attribute.count; i ++ ) {\n\n\t\tconst x = attribute.getX( i );\n\t\tconst y = attribute.getY( i );\n\n\t\tarray.push( `(${ x.toPrecision( PRECISION ) }, ${ 1 - y.toPrecision( PRECISION ) })` );\n\n\t}\n\n\treturn array.join( ', ' );\n\n}\n\nfunction buildPrimvars( attributes ) {\n\n\tlet string = '';\n\n\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\tconst id = ( i > 0 ? i : '' );\n\t\tconst attribute = attributes[ 'uv' + id ];\n\n\t\tif ( attribute !== undefined ) {\n\n\t\t\tstring += `\n\t\ttexCoord2f[] primvars:st${ id } = [${ buildVector2Array( attribute )}] (\n\t\t\tinterpolation = \"vertex\"\n\t\t)`;\n\n\t\t}\n\n\t}\n\n\t// vertex colors\n\n\tconst colorAttribute = attributes.color;\n\n\tif ( colorAttribute !== undefined ) {\n\n\t\tconst count = colorAttribute.count;\n\n\t\tstring += `\n\tcolor3f[] primvars:displayColor = [${buildVector3Array( colorAttribute, count )}] (\n\t\tinterpolation = \"vertex\"\n\t\t)`;\n\n\t}\n\n\treturn string;\n\n}\n\n// Materials\n\nfunction buildMaterials( materials, textures, quickLookCompatible = false ) {\n\n\tconst array = [];\n\n\tfor ( const uuid in materials ) {\n\n\t\tconst material = materials[ uuid ];\n\n\t\tarray.push( buildMaterial( material, textures, quickLookCompatible ) );\n\n\t}\n\n\treturn `def \"Materials\"\n{\n${ array.join( '' ) }\n}\n\n`;\n\n}\n\nfunction buildMaterial( material, textures, quickLookCompatible = false ) {\n\n\t// https://graphics.pixar.com/usd/docs/UsdPreviewSurface-Proposal.html\n\n\tconst pad = '\t\t\t';\n\tconst inputs = [];\n\tconst samplers = [];\n\n\tfunction buildTexture( texture, mapType, color ) {\n\n\t\tconst id = texture.source.id + '_' + texture.flipY;\n\n\t\ttextures[ id ] = texture;\n\n\t\tconst uv = texture.channel > 0 ? 'st' + texture.channel : 'st';\n\n\t\tconst WRAPPINGS = {\n\t\t\t1000: 'repeat', // RepeatWrapping\n\t\t\t1001: 'clamp', // ClampToEdgeWrapping\n\t\t\t1002: 'mirror' // MirroredRepeatWrapping\n\t\t};\n\n\t\tconst repeat = texture.repeat.clone();\n\t\tconst offset = texture.offset.clone();\n\t\tconst rotation = texture.rotation;\n\n\t\t// rotation is around the wrong point. after rotation we need to shift offset again so that we're rotating around the right spot\n\t\tconst xRotationOffset = Math.sin( rotation );\n\t\tconst yRotationOffset = Math.cos( rotation );\n\n\t\t// texture coordinates start in the opposite corner, need to correct\n\t\toffset.y = 1 - offset.y - repeat.y;\n\n\t\t// turns out QuickLook is buggy and interprets texture repeat inverted/applies operations in a different order.\n\t\t// Apple Feedback: \tFB10036297 and FB11442287\n\t\tif ( quickLookCompatible ) {\n\n\t\t\t// This is NOT correct yet in QuickLook, but comes close for a range of models.\n\t\t\t// It becomes more incorrect the bigger the offset is\n\n\t\t\toffset.x = offset.x / repeat.x;\n\t\t\toffset.y = offset.y / repeat.y;\n\n\t\t\toffset.x += xRotationOffset / repeat.x;\n\t\t\toffset.y += yRotationOffset - 1;\n\n\t\t} else {\n\n\t\t\t// results match glTF results exactly. verified correct in usdview.\n\t\t\toffset.x += xRotationOffset * repeat.x;\n\t\t\toffset.y += ( 1 - yRotationOffset ) * repeat.y;\n\n\t\t}\n\n\t\treturn `\n\t\tdef Shader \"PrimvarReader_${ mapType }\"\n\t\t{\n\t\t\tuniform token info:id = \"UsdPrimvarReader_float2\"\n\t\t\tfloat2 inputs:fallback = (0.0, 0.0)\n\t\t\ttoken inputs:varname = \"${ uv }\"\n\t\t\tfloat2 outputs:result\n\t\t}\n\n\t\tdef Shader \"Transform2d_${ mapType }\"\n\t\t{\n\t\t\tuniform token info:id = \"UsdTransform2d\"\n\t\t\ttoken inputs:in.connect = </Materials/Material_${ material.id }/PrimvarReader_${ mapType }.outputs:result>\n\t\t\tfloat inputs:rotation = ${ ( rotation * ( 180 / Math.PI ) ).toFixed( PRECISION ) }\n\t\t\tfloat2 inputs:scale = ${ buildVector2( repeat ) }\n\t\t\tfloat2 inputs:translation = ${ buildVector2( offset ) }\n\t\t\tfloat2 outputs:result\n\t\t}\n\n\t\tdef Shader \"Texture_${ texture.id }_${ mapType }\"\n\t\t{\n\t\t\tuniform token info:id = \"UsdUVTexture\"\n\t\t\tasset inputs:file = @textures/Texture_${ id }.png@\n\t\t\tfloat2 inputs:st.connect = </Materials/Material_${ material.id }/Transform2d_${ mapType }.outputs:result>\n\t\t\t${ color !== undefined ? 'float4 inputs:scale = ' + buildColor4( color ) : '' }\n\t\t\ttoken inputs:sourceColorSpace = \"${ texture.colorSpace === NoColorSpace ? 'raw' : 'sRGB' }\"\n\t\t\ttoken inputs:wrapS = \"${ WRAPPINGS[ texture.wrapS ] }\"\n\t\t\ttoken inputs:wrapT = \"${ WRAPPINGS[ texture.wrapT ] }\"\n\t\t\tfloat outputs:r\n\t\t\tfloat outputs:g\n\t\t\tfloat outputs:b\n\t\t\tfloat3 outputs:rgb\n\t\t\t${ material.transparent || material.alphaTest > 0.0 ? 'float outputs:a' : '' }\n\t\t}`;\n\n\t}\n\n\n\tif ( material.side === DoubleSide ) {\n\n\t\tconsole.warn( 'THREE.USDZExporter: USDZ does not support double sided materials', material );\n\n\t}\n\n\tif ( material.map !== null ) {\n\n\t\tinputs.push( `${ pad }color3f inputs:diffuseColor.connect = </Materials/Material_${ material.id }/Texture_${ material.map.id }_diffuse.outputs:rgb>` );\n\n\t\tif ( material.transparent ) {\n\n\t\t\tinputs.push( `${ pad }float inputs:opacity.connect = </Materials/Material_${ material.id }/Texture_${ material.map.id }_diffuse.outputs:a>` );\n\n\t\t} else if ( material.alphaTest > 0.0 ) {\n\n\t\t\tinputs.push( `${ pad }float inputs:opacity.connect = </Materials/Material_${ material.id }/Texture_${ material.map.id }_diffuse.outputs:a>` );\n\t\t\tinputs.push( `${ pad }float inputs:opacityThreshold = ${material.alphaTest}` );\n\n\t\t}\n\n\t\tsamplers.push( buildTexture( material.map, 'diffuse', material.color ) );\n\n\t} else {\n\n\t\tinputs.push( `${ pad }color3f inputs:diffuseColor = ${ buildColor( material.color ) }` );\n\n\t}\n\n\tif ( material.emissiveMap !== null ) {\n\n\t\tinputs.push( `${ pad }color3f inputs:emissiveColor.connect = </Materials/Material_${ material.id }/Texture_${ material.emissiveMap.id }_emissive.outputs:rgb>` );\n\n\t\tsamplers.push( buildTexture( material.emissiveMap, 'emissive', new Color( material.emissive.r * material.emissiveIntensity, material.emissive.g * material.emissiveIntensity, material.emissive.b * material.emissiveIntensity ) ) );\n\n\t} else if ( material.emissive.getHex() > 0 ) {\n\n\t\tinputs.push( `${ pad }color3f inputs:emissiveColor = ${ buildColor( material.emissive ) }` );\n\n\t}\n\n\tif ( material.normalMap !== null ) {\n\n\t\tinputs.push( `${ pad }normal3f inputs:normal.connect = </Materials/Material_${ material.id }/Texture_${ material.normalMap.id }_normal.outputs:rgb>` );\n\n\t\tsamplers.push( buildTexture( material.normalMap, 'normal' ) );\n\n\t}\n\n\tif ( material.aoMap !== null ) {\n\n\t\tinputs.push( `${ pad }float inputs:occlusion.connect = </Materials/Material_${ material.id }/Texture_${ material.aoMap.id }_occlusion.outputs:r>` );\n\n\t\tsamplers.push( buildTexture( material.aoMap, 'occlusion', new Color( material.aoMapIntensity, material.aoMapIntensity, material.aoMapIntensity ) ) );\n\n\t}\n\n\tif ( material.roughnessMap !== null ) {\n\n\t\tinputs.push( `${ pad }float inputs:roughness.connect = </Materials/Material_${ material.id }/Texture_${ material.roughnessMap.id }_roughness.outputs:g>` );\n\n\t\tsamplers.push( buildTexture( material.roughnessMap, 'roughness', new Color( material.roughness, material.roughness, material.roughness ) ) );\n\n\t} else {\n\n\t\tinputs.push( `${ pad }float inputs:roughness = ${ material.roughness }` );\n\n\t}\n\n\tif ( material.metalnessMap !== null ) {\n\n\t\tinputs.push( `${ pad }float inputs:metallic.connect = </Materials/Material_${ material.id }/Texture_${ material.metalnessMap.id }_metallic.outputs:b>` );\n\n\t\tsamplers.push( buildTexture( material.metalnessMap, 'metallic', new Color( material.metalness, material.metalness, material.metalness ) ) );\n\n\t} else {\n\n\t\tinputs.push( `${ pad }float inputs:metallic = ${ material.metalness }` );\n\n\t}\n\n\tif ( material.alphaMap !== null ) {\n\n\t\tinputs.push( `${pad}float inputs:opacity.connect = </Materials/Material_${material.id}/Texture_${material.alphaMap.id}_opacity.outputs:r>` );\n\t\tinputs.push( `${pad}float inputs:opacityThreshold = 0.0001` );\n\n\t\tsamplers.push( buildTexture( material.alphaMap, 'opacity' ) );\n\n\t} else {\n\n\t\tinputs.push( `${pad}float inputs:opacity = ${material.opacity}` );\n\n\t}\n\n\tif ( material.isMeshPhysicalMaterial ) {\n\n\t\tif ( material.clearcoatMap !== null ) {\n\n\t\t\tinputs.push( `${pad}float inputs:clearcoat.connect = </Materials/Material_${material.id}/Texture_${material.clearcoatMap.id}_clearcoat.outputs:r>` );\n\t\t\tsamplers.push( buildTexture( material.clearcoatMap, 'clearcoat', new Color( material.clearcoat, material.clearcoat, material.clearcoat ) ) );\n\n\t\t} else {\n\n\t\t\tinputs.push( `${pad}float inputs:clearcoat = ${material.clearcoat}` );\n\n\t\t}\n\n\t\tif ( material.clearcoatRoughnessMap !== null ) {\n\n\t\t\tinputs.push( `${pad}float inputs:clearcoatRoughness.connect = </Materials/Material_${material.id}/Texture_${material.clearcoatRoughnessMap.id}_clearcoatRoughness.outputs:g>` );\n\t\t\tsamplers.push( buildTexture( material.clearcoatRoughnessMap, 'clearcoatRoughness', new Color( material.clearcoatRoughness, material.clearcoatRoughness, material.clearcoatRoughness ) ) );\n\n\t\t} else {\n\n\t\t\tinputs.push( `${pad}float inputs:clearcoatRoughness = ${material.clearcoatRoughness}` );\n\n\t\t}\n\n\t\tinputs.push( `${ pad }float inputs:ior = ${ material.ior }` );\n\n\t}\n\n\treturn `\n\tdef Material \"Material_${ material.id }\"\n\t{\n\t\tdef Shader \"PreviewSurface\"\n\t\t{\n\t\t\tuniform token info:id = \"UsdPreviewSurface\"\n${ inputs.join( '\\n' ) }\n\t\t\tint inputs:useSpecularWorkflow = 0\n\t\t\ttoken outputs:surface\n\t\t}\n\n\t\ttoken outputs:surface.connect = </Materials/Material_${ material.id }/PreviewSurface.outputs:surface>\n\n${ samplers.join( '\\n' ) }\n\n\t}\n`;\n\n}\n\nfunction buildColor( color ) {\n\n\treturn `(${ color.r }, ${ color.g }, ${ color.b })`;\n\n}\n\nfunction buildColor4( color ) {\n\n\treturn `(${ color.r }, ${ color.g }, ${ color.b }, 1.0)`;\n\n}\n\nfunction buildVector2( vector ) {\n\n\treturn `(${ vector.x }, ${ vector.y })`;\n\n}\n\n\nfunction buildCamera( camera ) {\n\n\tconst name = camera.name ? camera.name : 'Camera_' + camera.id;\n\n\tconst transform = buildMatrix( camera.matrixWorld );\n\n\tif ( camera.matrixWorld.determinant() < 0 ) {\n\n\t\tconsole.warn( 'THREE.USDZExporter: USDZ does not support negative scales', camera );\n\n\t}\n\n\tif ( camera.isOrthographicCamera ) {\n\n\t\treturn `def Camera \"${name}\"\n\t\t{\n\t\t\tmatrix4d xformOp:transform = ${ transform }\n\t\t\tuniform token[] xformOpOrder = [\"xformOp:transform\"]\n\n\t\t\tfloat2 clippingRange = (${ camera.near.toPrecision( PRECISION ) }, ${ camera.far.toPrecision( PRECISION ) })\n\t\t\tfloat horizontalAperture = ${ ( ( Math.abs( camera.left ) + Math.abs( camera.right ) ) * 10 ).toPrecision( PRECISION ) }\n\t\t\tfloat verticalAperture = ${ ( ( Math.abs( camera.top ) + Math.abs( camera.bottom ) ) * 10 ).toPrecision( PRECISION ) }\n\t\t\ttoken projection = \"orthographic\"\n\t\t}\n\t\n\t`;\n\n\t} else {\n\n\t\treturn `def Camera \"${name}\"\n\t\t{\n\t\t\tmatrix4d xformOp:transform = ${ transform }\n\t\t\tuniform token[] xformOpOrder = [\"xformOp:transform\"]\n\n\t\t\tfloat2 clippingRange = (${ camera.near.toPrecision( PRECISION ) }, ${ camera.far.toPrecision( PRECISION ) })\n\t\t\tfloat focalLength = ${ camera.getFocalLength().toPrecision( PRECISION ) }\n\t\t\tfloat focusDistance = ${ camera.focus.toPrecision( PRECISION ) }\n\t\t\tfloat horizontalAperture = ${ camera.getFilmWidth().toPrecision( PRECISION ) }\n\t\t\ttoken projection = \"perspective\"\n\t\t\tfloat verticalAperture = ${ camera.getFilmHeight().toPrecision( PRECISION ) }\n\t\t}\n\t\n\t`;\n\n\t}\n\n}\n\nexport { USDZExporter };\n","// @ts-nocheck\n// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2025, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptDecoder = (function () {\n\t// Built with clang version 19.1.5-wasi-sdk\n\t// Built from meshoptimizer 0.22\n\tvar wasm_base =\n\t\t'b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:W:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:986qdbk;jYi5ud9:du8Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnalTmbcuhoaiRbbgrc;WeGc:Ge9hmbarcsGgwce0mbc9:hoalcufadcd4cbawEgDadfgrcKcaawEgqaraq0Egk6mbaicefhxcj;abad9Uc;WFbGcjdadca0EhmaialfgPar9Rgoadfhsavaoadz1jjjbgzceVhHcbhOdndninaeaO9nmeaPax9RaD6mdamaeaO9RaOamfgoae6EgAcsfglc9WGhCabaOad2fhXaAcethQaxaDfhiaOaeaoaeao6E9RhLalcl4cifcd4hKazcj;cbfaAfhYcbh8AazcjdfhEaHh3incbhodnawTmbaxa8Acd4fRbbhokaocFeGh5cbh8Eazcj;cbfhqinaih8Fdndndndna5a8Ecet4ciGgoc9:fPdebdkaPa8F9RaA6mrazcj;cbfa8EaA2fa8FaAz1jjjb8Aa8FaAfhixdkazcj;cbfa8EaA2fcbaAz:jjjjb8Aa8FhixekaPa8F9RaK6mva8FaKfhidnaCTmbaPai9RcK6mbaocdtc:q1jjbfcj1jjbawEhaczhrcbhlinargoc9Wfghaqfhrdndndndndndnaaa8Fahco4fRbbalcoG4ciGcdtfydbPDbedvivvvlvkar9cb83bbarcwf9cb83bbxlkarcbaiRbdai8Xbb9c:c:qj:bw9:9c:q;c1:I1e:d9c:b:c:e1z9:gg9cjjjjjz:dg8J9qE86bbaqaofgrcGfag9c8F1:NghcKtc8F91aicdfa8J9c8N1:Nfg8KRbbG86bbarcVfcba8KahcjeGcr4fghRbbag9cjjjjjl:dg8J9qE86bbarc7fcbaha8J9c8L1:NfghRbbag9cjjjjjd:dg8J9qE86bbarctfcbaha8J9c8K1:NfghRbbag9cjjjjje:dg8J9qE86bbarc91fcbaha8J9c8J1:NfghRbbag9cjjjj;ab:dg8J9qE86bbarc4fcbaha8J9cg1:NfghRbbag9cjjjja:dg8J9qE86bbarc93fcbaha8J9ch1:NfghRbbag9cjjjjz:dgg9qE86bbarc94fcbahag9ca1:NfghRbbai8Xbe9c:c:qj:bw9:9c:q;c1:I1e:d9c:b:c:e1z9:gg9cjjjjjz:dg8J9qE86bbarc95fag9c8F1:NgicKtc8F91aha8J9c8N1:NfghRbbG86bbarc96fcbahaicjeGcr4fgiRbbag9cjjjjjl:dg8J9qE86bbarc97fcbaia8J9c8L1:NfgiRbbag9cjjjjjd:dg8J9qE86bbarc98fcbaia8J9c8K1:NfgiRbbag9cjjjjje:dg8J9qE86bbarc99fcbaia8J9c8J1:NfgiRbbag9cjjjj;ab:dg8J9qE86bbarc9:fcbaia8J9cg1:NfgiRbbag9cjjjja:dg8J9qE86bbarcufcbaia8J9ch1:NfgiRbbag9cjjjjz:dgg9qE86bbaiag9ca1:NfhixikaraiRblaiRbbghco4g8Ka8KciSg8KE86bbaqaofgrcGfaiclfa8Kfg8KRbbahcl4ciGg8La8LciSg8LE86bbarcVfa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc7fa8Ka8Lfg8KRbbahciGghahciSghE86bbarctfa8Kahfg8KRbbaiRbeghco4g8La8LciSg8LE86bbarc91fa8Ka8Lfg8KRbbahcl4ciGg8La8LciSg8LE86bbarc4fa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc93fa8Ka8Lfg8KRbbahciGghahciSghE86bbarc94fa8Kahfg8KRbbaiRbdghco4g8La8LciSg8LE86bbarc95fa8Ka8Lfg8KRbbahcl4ciGg8La8LciSg8LE86bbarc96fa8Ka8Lfg8KRbbahcd4ciGg8La8LciSg8LE86bbarc97fa8Ka8Lfg8KRbbahciGghahciSghE86bbarc98fa8KahfghRbbaiRbigico4g8Ka8KciSg8KE86bbarc99faha8KfghRbbaicl4ciGg8Ka8KciSg8KE86bbarc9:faha8KfghRbbaicd4ciGg8Ka8KciSg8KE86bbarcufaha8KfgrRbbaiciGgiaiciSgiE86bbaraifhixdkaraiRbwaiRbbghcl4g8Ka8KcsSg8KE86bbaqaofgrcGfaicwfa8Kfg8KRbbahcsGghahcsSghE86bbarcVfa8KahfghRbbaiRbeg8Kcl4g8La8LcsSg8LE86bbarc7faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarctfaha8KfghRbbaiRbdg8Kcl4g8La8LcsSg8LE86bbarc91faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc4faha8KfghRbbaiRbig8Kcl4g8La8LcsSg8LE86bbarc93faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc94faha8KfghRbbaiRblg8Kcl4g8La8LcsSg8LE86bbarc95faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc96faha8KfghRbbaiRbvg8Kcl4g8La8LcsSg8LE86bbarc97faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc98faha8KfghRbbaiRbog8Kcl4g8La8LcsSg8LE86bbarc99faha8LfghRbba8KcsGg8Ka8KcsSg8KE86bbarc9:faha8KfghRbbaiRbrgicl4g8Ka8KcsSg8KE86bbarcufaha8KfgrRbbaicsGgiaicsSgiE86bbaraifhixekarai8Pbb83bbarcwfaicwf8Pbb83bbaiczfhikdnaoaC9pmbalcdfhlaoczfhraPai9RcL0mekkaoaC6moaimexokaCmva8FTmvkaqaAfhqa8Ecefg8Ecl9hmbkdndndndnawTmbasa8Acd4fRbbgociGPlbedrbkaATmdaza8Afh8Fazcj;cbfhhcbh8EaEhaina8FRbbhraahocbhlinaoahalfRbbgqce4cbaqceG9R7arfgr86bbaoadfhoaAalcefgl9hmbkaacefhaa8Fcefh8FahaAfhha8Ecefg8Ecl9hmbxikkaATmeaza8Afhaazcj;cbfhhcbhoceh8EaYh8FinaEaofhlaa8Vbbhrcbhoinala8FaofRbbcwtahaofRbbgqVc;:FiGce4cbaqceG9R7arfgr87bbaladfhlaLaocefgofmbka8FaQfh8FcdhoaacdfhaahaQfhha8EceGhlcbh8EalmbxdkkaATmbcbaocl49Rh8Eaza8AfRbbhqcwhoa3hlinalRbbaotaqVhqalcefhlaocwfgoca9hmbkcbhhaEh8FaYhainazcj;cbfahfRbbhrcwhoaahlinalRbbaotarVhralaAfhlaocwfgoca9hmbkara8E93aq7hqcbhoa8Fhlinalaqao486bbalcefhlaocwfgoca9hmbka8Fadfh8FaacefhaahcefghaA9hmbkkaEclfhEa3clfh3a8Aclfg8Aad6mbkaXazcjdfaAad2z1jjjb8AazazcjdfaAcufad2fadz1jjjb8AaAaOfhOaihxaimbkc9:hoxdkcbc99aPax9RakSEhoxekc9:hokavcj;kbf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:clevu8Jjjjjbcz9Rhvdnaecvfal9nmbc9:skdnaiRbbc;:eGc;qeSmbcuskav9cb83iwaicefhoaialfc98fhrdnaeTmbdnadcdSmbcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcdtfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgiBdbalaiBdbawcefgwae9hmbxdkkcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcetfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgi87ebalaiBdbawcefgwae9hmbkkcbc99aoarSEk:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbyd:K1jjbgeabcifc98GfgbBd:K1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;teeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk:3eedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdxaialBdwaialBdlaialBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkk81dbcjwk8Kbbbbdbbblbbbwbbbbbbbebbbdbbblbbbwbbbbc:Kwkl8WNbb'; // embed! base\n\tvar wasm_simd =\n\t\t'b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;X9Mqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:183lYud97dur978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnalTmbcuhoaiRbbgrc;WeGc:Ge9hmbarcsGgwce0mbc9:hoalcufadcd4cbawEgDadfgrcKcaawEgqaraq0Egk6mbaicefhxavaialfgmar9Rgoad;8qbbcj;abad9Uc;WFbGcjdadca0EhPdndndnadTmbaoadfhscbhzinaeaz9nmdamax9RaD6miabazad2fhHaxaDfhOaPaeaz9RazaPfae6EgAcsfgocl4cifcd4hCavcj;cbfaoc9WGgXcetfhQavcj;cbfaXci2fhLavcj;cbfaXfhKcbhYaoc;ab6h8AincbhodnawTmbaxaYcd4fRbbhokaocFeGhEcbh3avcj;cbfh5indndndndnaEa3cet4ciGgoc9:fPdebdkamaO9RaX6mwavcj;cbfa3aX2faOaX;8qbbaOaAfhOxdkavcj;cbfa3aX2fcbaX;8kbxekamaO9RaC6moaoclVcbawEhraOaCfhocbhidna8Ambamao9Rc;Gb6mbcbhlina5alfhidndndndndndnaOalco4fRbbgqciGarfPDbedibledibkaipxbbbbbbbbbbbbbbbbpklbxlkaiaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaiaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaiaopbbbpklbaoczfhoxekaiaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqcd4ciGarfPDbedibledibkaiczfpxbbbbbbbbbbbbbbbbpklbxlkaiczfaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaiczfaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaiczfaopbbbpklbaoczfhoxekaiczfaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqcl4ciGarfPDbedibledibkaicafpxbbbbbbbbbbbbbbbbpklbxlkaicafaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaoclffahc:q:yjjbfRbbfhoxikaicafaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaaaocwffahc:q:yjjbfRbbfhoxdkaicafaopbbbpklbaoczfhoxekaicafaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaaaocdffahc:q:yjjbfRbbfhokdndndndndndnaqco4arfPDbedibledibkaic8Wfpxbbbbbbbbbbbbbbbbpklbxlkaic8Wfaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngicitc:q1jjbfpbibaic:q:yjjbfRbbgipsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Ngqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaiaoclffaqc:q:yjjbfRbbfhoxikaic8Wfaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngicitc:q1jjbfpbibaic:q:yjjbfRbbgipsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Ngqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spklbaiaocwffaqc:q:yjjbfRbbfhoxdkaic8Wfaopbbbpklbaoczfhoxekaic8WfaopbbdaoRbbgicitc:q1jjbfpbibaic:q:yjjbfRbbgipsaoRbegqcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpklbaiaocdffaqc:q:yjjbfRbbfhokalc;abfhialcjefaX0meaihlamao9Rc;Fb0mbkkdnaiaX9pmbaici4hlinamao9RcK6mwa5aifhqdndndndndndnaOaico4fRbbalcoG4ciGarfPDbedibledibkaqpxbbbbbbbbbbbbbbbbpkbbxlkaqaopbblaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLg8Ecdp:mea8EpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9og8Fpxiiiiiiiiiiiiiiiip8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spkbbaaaoclffahc:q:yjjbfRbbfhoxikaqaopbbwaopbbbg8Eclp:mea8EpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9og8Fpxssssssssssssssssp8Jg8Ep5b9cjF;8;4;W;G;ab9:9cU1:Ngacitc:q1jjbfpbibaac:q:yjjbfRbbgapsa8Ep5e9cjF;8;4;W;G;ab9:9cU1:Nghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPa8Fa8Ep9spkbbaaaocwffahc:q:yjjbfRbbfhoxdkaqaopbbbpkbbaoczfhoxekaqaopbbdaoRbbgacitc:q1jjbfpbibaac:q:yjjbfRbbgapsaoRbeghcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPpkbbaaaocdffahc:q:yjjbfRbbfhokalcdfhlaiczfgiaX6mbkkaohOaoTmoka5aXfh5a3cefg3cl9hmbkdndndndnawTmbasaYcd4fRbbglciGPlbedwbkaXTmdavcjdfaYfhlavaYfpbdbhgcbhoinalavcj;cbfaofpblbg8JaKaofpblbg8KpmbzeHdOiAlCvXoQrLg8LaQaofpblbg8MaLaofpblbg8NpmbzeHdOiAlCvXoQrLgypmbezHdiOAlvCXorQLg8Ecep9Ta8Epxeeeeeeeeeeeeeeeeg8Fp9op9Hp9rg8Eagp9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8LaypmwDKYqk8AExm35Ps8E8Fg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8Ja8KpmwKDYq8AkEx3m5P8Es8Fg8Ja8Ma8NpmwKDYq8AkEx3m5P8Es8Fg8KpmbezHdiOAlvCXorQLg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Uggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp9Uggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp9Uggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9Abbbaladfglaga8Ja8KpmwDKYqk8AExm35Ps8E8Fg8Ecep9Ta8Ea8Fp9op9Hp9rg8Ep9Ug8Fp9Abbbaladfgla8Fa8Ea8Epmlvorlvorlvorlvorp9Ug8Fp9Abbbaladfgla8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9Ug8Fp9Abbbaladfgla8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9Uggp9AbbbaladfhlaoczfgoaX6mbxikkaXTmeavcjdfaYfhlavaYfpbdbhgcbhoinalavcj;cbfaofpblbg8JaKaofpblbg8KpmbzeHdOiAlCvXoQrLg8LaQaofpblbg8MaLaofpblbg8NpmbzeHdOiAlCvXoQrLgypmbezHdiOAlvCXorQLg8Ecep:nea8Epxebebebebebebebebg8Fp9op:bep9rg8Eagp:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8LaypmwDKYqk8AExm35Ps8E8Fg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8Ja8KpmwKDYq8AkEx3m5P8Es8Fg8Ja8Ma8NpmwKDYq8AkEx3m5P8Es8Fg8KpmbezHdiOAlvCXorQLg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeggp9Abbbaladfglaga8Ea8Epmlvorlvorlvorlvorp:oeggp9Abbbaladfglaga8Ea8EpmwDqkwDqkwDqkwDqkp:oeggp9Abbbaladfglaga8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9Abbbaladfglaga8Ja8KpmwDKYqk8AExm35Ps8E8Fg8Ecep:nea8Ea8Fp9op:bep9rg8Ep:oeg8Fp9Abbbaladfgla8Fa8Ea8Epmlvorlvorlvorlvorp:oeg8Fp9Abbbaladfgla8Fa8Ea8EpmwDqkwDqkwDqkwDqkp:oeg8Fp9Abbbaladfgla8Fa8Ea8EpmxmPsxmPsxmPsxmPsp:oeggp9AbbbaladfhlaoczfgoaX6mbxdkkaXTmbcbhocbalcl4gl9Rc8FGhiavcjdfaYfhravaYfpbdbh8Finaravcj;cbfaofpblbggaKaofpblbg8JpmbzeHdOiAlCvXoQrLg8KaQaofpblbg8LaLaofpblbg8MpmbzeHdOiAlCvXoQrLg8NpmbezHdiOAlvCXorQLg8Eaip:Rea8Ealp:Sep9qg8Ea8Fp9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Fa8Ka8NpmwDKYqk8AExm35Ps8E8Fg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Faga8JpmwKDYq8AkEx3m5P8Es8Fgga8La8MpmwKDYq8AkEx3m5P8Es8Fg8JpmbezHdiOAlvCXorQLg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9Abbbaradfgra8Faga8JpmwDKYqk8AExm35Ps8E8Fg8Eaip:Rea8Ealp:Sep9qg8Ep9rg8Fp9Abbbaradfgra8Fa8Ea8Epmlvorlvorlvorlvorp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmwDqkwDqkwDqkwDqkp9rg8Fp9Abbbaradfgra8Fa8Ea8EpmxmPsxmPsxmPsxmPsp9rg8Fp9AbbbaradfhraoczfgoaX6mbkkaYclfgYad6mbkaHavcjdfaAad2;8qbbavavcjdfaAcufad2fad;8qbbaAazfhzc9:hoaOhxaOmbxlkkaeTmbaDalfhrcbhocuhlinaralaD9RglfaD6mdaPaeao9RaoaPfae6Eaofgoae6mbkaial9Rhxkcbc99amax9RakSEhoxekc9:hokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:clevu8Jjjjjbcz9Rhvdnaecvfal9nmbc9:skdnaiRbbc;:eGc;qeSmbcuskav9cb83iwaicefhoaialfc98fhrdnaeTmbdnadcdSmbcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcdtfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgiBdbalaiBdbawcefgwae9hmbxdkkcbhwindnaoar6mbc9:skaocefhlao8SbbgicFeGhddndnaicu9mmbalhoxekaocvfhoadcFbGhdcrhidninal8SbbgDcFbGaitadVhdaDcu9kmealcefhlaicrfgic8J9hmbxdkkalcefhokabawcetfadc8Etc8F91adcd47avcwfadceGcdtVglydbfgi87ebalaiBdbawcefgwae9hmbkkcbc99aoarSEk:SPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;7eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiczfpxbbbbbbbbbbbbbbbbgopklbaiaopklbaiabalcitfgdaeciGglcitgv;8qbbdnalTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;7eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkadaiav;8qbbkk:oDllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiczfpxbbbbbbbbbbbbbbbbgkpklbaiakpklbaiabalcitfgoaeciGgvcitgw;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkaoaiaw;8qbbkk;uddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaic8WfpxbbbbbbbbbbbbbbbbgopklbaicafaopklbaiczfaopklbaiaopklbaiabavcdtfgdalciGgecdtgv;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkadaiav;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb'; // embed! simd\n\n\tvar detector = new Uint8Array([\n\t\t0, 97, 115, 109, 1, 0, 0, 0, 1, 4, 1, 96, 0, 0, 3, 3, 2, 0, 0, 5, 3, 1, 0, 1, 12, 1, 0, 10, 22, 2, 12, 0, 65, 0, 65, 0, 65, 0, 252, 10, 0, 0,\n\t\t11, 7, 0, 65, 0, 253, 15, 26, 11,\n\t]);\n\tvar wasmpack = new Uint8Array([\n\t\t32, 0, 65, 2, 1, 106, 34, 33, 3, 128, 11, 4, 13, 64, 6, 253, 10, 7, 15, 116, 127, 5, 8, 12, 40, 16, 19, 54, 20, 9, 27, 255, 113, 17, 42, 67,\n\t\t24, 23, 146, 148, 18, 14, 22, 45, 70, 69, 56, 114, 101, 21, 25, 63, 75, 136, 108, 28, 118, 29, 73, 115,\n\t]);\n\n\tif (typeof WebAssembly !== 'object') {\n\t\treturn {\n\t\t\tsupported: false,\n\t\t};\n\t}\n\n\tvar wasm = WebAssembly.validate(detector) ? unpack(wasm_simd) : unpack(wasm_base);\n\n\tvar instance;\n\n\tvar ready = WebAssembly.instantiate(wasm, {}).then(function (result) {\n\t\tinstance = result.instance;\n\t\tinstance.exports.__wasm_call_ctors();\n\t});\n\n\tfunction unpack(data) {\n\t\tvar result = new Uint8Array(data.length);\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar ch = data.charCodeAt(i);\n\t\t\tresult[i] = ch > 96 ? ch - 97 : ch > 64 ? ch - 39 : ch + 4;\n\t\t}\n\t\tvar write = 0;\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tresult[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n\t\t}\n\t\treturn result.buffer.slice(0, write);\n\t}\n\n\tfunction decode(instance, fun, target, count, size, source, filter) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar count4 = (count + 3) & ~3;\n\t\tvar tp = sbrk(count4 * size);\n\t\tvar sp = sbrk(source.length);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(source, sp);\n\t\tvar res = fun(tp, count, size, sp, source.length);\n\t\tif (res == 0 && filter) {\n\t\t\tfilter(tp, count4, size);\n\t\t}\n\t\ttarget.set(heap.subarray(tp, tp + count * size));\n\t\tsbrk(tp - sbrk(0));\n\t\tif (res != 0) {\n\t\t\tthrow new Error('Malformed buffer data: ' + res);\n\t\t}\n\t}\n\n\tvar filters = {\n\t\tNONE: '',\n\t\tOCTAHEDRAL: 'meshopt_decodeFilterOct',\n\t\tQUATERNION: 'meshopt_decodeFilterQuat',\n\t\tEXPONENTIAL: 'meshopt_decodeFilterExp',\n\t};\n\n\tvar decoders = {\n\t\tATTRIBUTES: 'meshopt_decodeVertexBuffer',\n\t\tTRIANGLES: 'meshopt_decodeIndexBuffer',\n\t\tINDICES: 'meshopt_decodeIndexSequence',\n\t};\n\n\tvar workers = [];\n\tvar requestId = 0;\n\n\tfunction createWorker(url) {\n\t\tvar worker = {\n\t\t\tobject: new Worker(url),\n\t\t\tpending: 0,\n\t\t\trequests: {},\n\t\t};\n\n\t\tworker.object.onmessage = function (event) {\n\t\t\tvar data = event.data;\n\n\t\t\tworker.pending -= data.count;\n\t\t\tworker.requests[data.id][data.action](data.value);\n\t\t\tdelete worker.requests[data.id];\n\t\t};\n\n\t\treturn worker;\n\t}\n\n\tfunction initWorkers(count) {\n\t\tvar source =\n\t\t\t'self.ready = WebAssembly.instantiate(new Uint8Array([' +\n\t\t\tnew Uint8Array(wasm) +\n\t\t\t']), {})' +\n\t\t\t'.then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });' +\n\t\t\t'self.onmessage = ' +\n\t\t\tworkerProcess.name +\n\t\t\t';' +\n\t\t\tdecode.toString() +\n\t\t\tworkerProcess.toString();\n\n\t\tvar blob = new Blob([source], { type: 'text/javascript' });\n\t\tvar url = URL.createObjectURL(blob);\n\n\t\tfor (var i = workers.length; i < count; ++i) {\n\t\t\tworkers[i] = createWorker(url);\n\t\t}\n\n\t\tfor (var i = count; i < workers.length; ++i) {\n\t\t\tworkers[i].object.postMessage({});\n\t\t}\n\n\t\tworkers.length = count;\n\n\t\tURL.revokeObjectURL(url);\n\t}\n\n\tfunction decodeWorker(count, size, source, mode, filter) {\n\t\tvar worker = workers[0];\n\n\t\tfor (var i = 1; i < workers.length; ++i) {\n\t\t\tif (workers[i].pending < worker.pending) {\n\t\t\t\tworker = workers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar data = new Uint8Array(source);\n\t\t\tvar id = ++requestId;\n\n\t\t\tworker.pending += count;\n\t\t\tworker.requests[id] = { resolve: resolve, reject: reject };\n\t\t\tworker.object.postMessage({ id: id, count: count, size: size, source: data, mode: mode, filter: filter }, [data.buffer]);\n\t\t});\n\t}\n\n\tfunction workerProcess(event) {\n\t\tvar data = event.data;\n\t\tif (!data.id) {\n\t\t\treturn self.close();\n\t\t}\n\t\tself.ready.then(function (instance) {\n\t\t\ttry {\n\t\t\t\tvar target = new Uint8Array(data.count * data.size);\n\t\t\t\tdecode(instance, instance.exports[data.mode], target, data.count, data.size, data.source, instance.exports[data.filter]);\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: 'resolve', value: target }, [target.buffer]);\n\t\t\t} catch (error) {\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: 'reject', value: error });\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: true,\n\t\tuseWorkers: function (count) {\n\t\t\tinitWorkers(count);\n\t\t},\n\t\tdecodeVertexBuffer: function (target, count, size, source, filter) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeVertexBuffer, target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeIndexBuffer: function (target, count, size, source) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeIndexBuffer, target, count, size, source);\n\t\t},\n\t\tdecodeIndexSequence: function (target, count, size, source) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeIndexSequence, target, count, size, source);\n\t\t},\n\t\tdecodeGltfBuffer: function (target, count, size, source, mode, filter) {\n\t\t\tdecode(instance, instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeGltfBufferAsync: function (count, size, source, mode, filter) {\n\t\t\tif (workers.length > 0) {\n\t\t\t\treturn decodeWorker(count, size, source, decoders[mode], filters[filter]);\n\t\t\t}\n\n\t\t\treturn ready.then(function () {\n\t\t\t\tvar target = new Uint8Array(count * size);\n\t\t\t\tdecode(instance, instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t\t\treturn target;\n\t\t\t});\n\t\t},\n\t};\n})();\n\nexport { MeshoptDecoder };\n","import * as THREE from \"three\";\r\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader.js\";\r\nimport { DRACOLoader } from \"three/examples/jsm/loaders/DRACOLoader.js\";\r\nimport { USDZExporter } from \"three/examples/jsm/exporters/USDZExporter.js\";\r\nimport { MeshoptDecoder } from \"./meshopt_decoder.module.js\"; // Ensure this path is correct\r\n\r\n/**\r\n * Generates a USDZ Blob URL from a given GLB file URL.\r\n *\r\n * @param {string} glbUrl - The URL of the GLB file to convert.\r\n * @param {\"horizontal\"|\"vertical\"} [anchoringAlignment=\"horizontal\"] - Use \"horizontal\" for floor, \"vertical\" for wall placement.\r\n * @param {{scaleX: number, scaleY: number, scaleZ: number}} [scale] - If given, apply this scale to the scene before export.\r\n * @returns {Promise<string>} A promise that resolves with a Blob URL string (e.g., \"blob:http://...\").\r\n *                            The caller is responsible for revoking this URL using URL.revokeObjectURL() when no longer needed.\r\n */\r\nexport function createUSDZModelFromGLB(\r\n  glbUrl,\r\n  anchoringAlignment = \"horizontal\",\r\n  scale\r\n) {\r\n  return new Promise((resolve, reject) => {\r\n    const loader = new GLTFLoader();\r\n    loader.setMeshoptDecoder(MeshoptDecoder);\r\n\r\n    // Setup DRACOLoader\r\n    const dracoLoader = new DRACOLoader();\r\n    dracoLoader.setDecoderPath(\r\n      \"https://www.gstatic.com/draco/versioned/decoders/\"\r\n    ); // Use CDN URL for decoders\r\n    dracoLoader.preload(); // Optional, but can help to load decoders sooner\r\n    console.log(dracoLoader);\r\n    loader.setDRACOLoader(dracoLoader);\r\n\r\n    loader.load(\r\n      glbUrl,\r\n      (gltf) => {\r\n        // Process the loaded GLTF scene\r\n        gltf.scene.traverse((child) => {\r\n          if (child.isMesh && child.material) {\r\n            // Ensure materials are single-sided for USDZ compatibility/performance\r\n            const materials = Array.isArray(child.material)\r\n              ? child.material\r\n              : [child.material];\r\n            materials.forEach((material) => {\r\n              if (material.side === THREE.DoubleSide) {\r\n                material.side = THREE.FrontSide;\r\n                material.needsUpdate = true; // Good practice to flag update\r\n              }\r\n              // Optional: Add other material adjustments if needed\r\n              // if (material.map) material.map.encoding = THREE.sRGBEncoding;\r\n              // if (material.emissiveMap) material.emissiveMap.encoding = THREE.sRGBEncoding;\r\n              // ... etc ...\r\n            });\r\n          }\r\n        });\r\n\r\n        if (scale) {\r\n          gltf.scene.scale.set(scale.scaleX, scale.scaleY, scale.scaleZ);\r\n        }\r\n\r\n        // Apply rotation for vertical anchoring *before* exporting\r\n        if (anchoringAlignment === \"vertical\") {\r\n          // Rotate around the X-axis to align Z-up (GLTF) with Y-up (often expected for vertical AR)\r\n          // Note: USDZ itself is Y-up, so this might be correct depending on exporter interpretation\r\n          gltf.scene.rotation.x = -Math.PI / 2;\r\n        }\r\n\r\n        // Ensure world matrices are updated after scale/rotation changes\r\n        gltf.scene.updateMatrixWorld(true);\r\n\r\n        const usdzExportOptions = {\r\n          ar: {\r\n            anchoring: { type: \"plane\" },\r\n            planeAnchoring: { alignment: anchoringAlignment },\r\n          },\r\n          // includeAnchoringProperties: true, // Generally implied by 'ar' options\r\n          quickLookCompatible: false, // Set true for basic iOS AR Quick Look compatibility if needed, might limit features\r\n          maxTextureSize: 1024, // Limit texture size for performance/compatibility\r\n          // Consider adding `embedImages: true` if textures aren't loading\r\n        };\r\n\r\n        const exporter = new USDZExporter();\r\n        exporter.parse(\r\n          gltf.scene,\r\n          (usdzArrayBuffer) => {\r\n            // Create a Blob from the ArrayBuffer\r\n            const usdzBlob = new Blob([usdzArrayBuffer], {\r\n              type: \"model/vnd.usdz+zip\", // More specific USDZ MIME type\r\n            });\r\n\r\n            // Create a Blob URL from the Blob\r\n            const blobUrl = URL.createObjectURL(usdzBlob);\r\n\r\n            console.log(blobUrl);\r\n\r\n            // Resolve the promise with the Blob URL string\r\n            resolve(blobUrl);\r\n          },\r\n          (error) => {\r\n            console.error(\"Error during USDZ export:\", error);\r\n            reject(new Error(`USDZ export failed: ${String(error)}`));\r\n          },\r\n          usdzExportOptions\r\n        );\r\n      },\r\n      undefined, // onProgress callback (optional)\r\n      (error) => {\r\n        // Handle GLTF loading errors\r\n        console.error(\"Error loading GLB:\", glbUrl, error);\r\n        reject(\r\n          new Error(`Failed to load GLB from ${glbUrl}: ${String(error)}`)\r\n        );\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// --- Example Usage (and cleanup) ---\r\n/*\r\nasync function convertAndUse() {\r\n  const glbModelUrl = '/path/to/your/model.glb'; // Replace with your actual GLB URL\r\n  let usdzBlobUrl = null;\r\n\r\n  try {\r\n    console.log(\"Starting conversion...\");\r\n    usdzBlobUrl = await createUSDZModelFromGLB(glbModelUrl, \"horizontal\");\r\n    console.log(\"Conversion successful. USDZ Blob URL:\", usdzBlobUrl);\r\n\r\n    // Now you can use the blobUrl, e.g., set it as the src for an <a> tag or <model-viewer>\r\n    const link = document.createElement('a');\r\n    link.href = usdzBlobUrl;\r\n    // Derive filename for download attribute (optional but good practice)\r\n    const filename = (glbModelUrl.split('/').pop() || 'model.glb').replace(/\\.glb$/i, '.usdz');\r\n    link.download = filename;\r\n    link.textContent = `Download ${filename}`;\r\n    link.rel=\"ar\"; // Add rel=\"ar\" for iOS Quick Look hint\r\n    const img = document.createElement('img'); // Add a preview image inside the link if desired\r\n    img.src = '/path/to/your/preview.jpg'; // Optional preview image\r\n    img.alt = 'Preview of 3D model';\r\n    link.appendChild(img);\r\n\r\n    document.body.appendChild(link);\r\n\r\n    // Or use with <model-viewer>\r\n    // const modelViewer = document.getElementById('my-model-viewer');\r\n    // if (modelViewer) {\r\n    //   modelViewer.iosSrc = usdzBlobUrl;\r\n    // }\r\n\r\n    // --- IMPORTANT CLEANUP ---\r\n    // Keep the URL alive for as long as needed.\r\n    // For example, if it's just for a download link that the user clicks once:\r\n    // You might revoke it *after* the user potentially clicks, maybe on window unload,\r\n    // or after a timeout if you assume the download started.\r\n    // If it's for a <model-viewer>, revoke it when the component is removed or the src changes.\r\n\r\n    // Example: Revoke after 5 minutes (adjust strategy as needed)\r\n    // setTimeout(() => {\r\n    //   if (usdzBlobUrl) {\r\n    //     console.log(\"Revoking Blob URL:\", usdzBlobUrl);\r\n    //     URL.revokeObjectURL(usdzBlobUrl);\r\n    //     usdzBlobUrl = null; // Clear reference\r\n    //   }\r\n    // }, 5 * 60 * 1000);\r\n\r\n  } catch (error) {\r\n    console.error(\"USDZ generation failed:\", error);\r\n    // Handle the error appropriately in your UI\r\n\r\n    // Ensure cleanup even on failure if a URL was somehow created before error\r\n    if (usdzBlobUrl) {\r\n       URL.revokeObjectURL(usdzBlobUrl);\r\n    }\r\n  }\r\n}\r\n\r\n// Call the example usage function\r\n// convertAndUse();\r\n*/\r\n","import QRCodeStyling from \"qr-code-styling\";\r\nimport normalTemplate from \"./templates/normal.js\";\r\nimport modalTemplate from \"./templates/modal.js\";\r\nimport buttonTemplate from \"./templates/button.js\";\r\nimport hotspotsTemplate from \"./templates/hotspots.js\";\r\nimport { Eye, Blocks, Rotate3D, Box, FileAxis3D, Scan } from \"lucide\";\r\nimport { BRIDGE_URL, CDN_URL } from \"./config/config.js\";\r\nimport { lazyLoadModelViewerIfNeeded } from \"./utils/modelViewerLoader.js\";\r\nimport { createUSDZModelFromGLB } from \"./utils/glbToUsdz.js\";\r\n\r\nconst NODE_ENV = \"production\";\r\n\r\nconst encodeBase64 = (text) => {\r\n  return btoa(text);\r\n};\r\n\r\nconst decodeBase64 = (text) => {\r\n  return atob(text);\r\n};\r\n\r\n// Utility for creating and appending elements\r\nconst createDomElement = (tag, options = {}) => {\r\n  const el = document.createElement(tag);\r\n  if (options.classList) {\r\n    options.classList.forEach((cls) => el.classList.add(cls));\r\n  }\r\n  if (options.textContent) {\r\n    el.textContent = options.textContent;\r\n  }\r\n  if (options.attributes) {\r\n    Object.entries(options.attributes).forEach(([attr, val]) => {\r\n      el.setAttribute(attr, val);\r\n    });\r\n  }\r\n  return el;\r\n};\r\n\r\nfunction createPortal(element, container = document.body) {\r\n  container.appendChild(element);\r\n  return element;\r\n}\r\n\r\n// Debug/Logging Utility\r\nconst logger = {\r\n  debug: (...args) => {\r\n    if (NODE_ENV === \"development\") {\r\n      console.log(...args);\r\n    }\r\n  },\r\n  error: (...args) => {\r\n    // console.error(...args);\r\n  },\r\n  warn: (...args) => {\r\n    // console.warn(...args)\r\n  },\r\n};\r\n\r\nasync function PosterWithCache(posterUrl, cache) {\r\n  if (cache[posterUrl]) {\r\n    return cache[posterUrl];\r\n  } else {\r\n    try {\r\n      const fetchPromise = fetch(posterUrl)\r\n        .then((response) => {\r\n          if (!response.ok) throw new Error(\"Network response was not ok\");\r\n          return response.blob();\r\n        })\r\n        .then((blob) => {\r\n          const blobUrl = URL.createObjectURL(blob);\r\n          cache[posterUrl] = blobUrl;\r\n          return blobUrl;\r\n        });\r\n      cache[posterUrl] = fetchPromise;\r\n      return await fetchPromise;\r\n    } catch (error) {\r\n      console.error(\"Failed to load poster:\", error);\r\n      delete cache[posterUrl];\r\n      return posterUrl; // Fallback to original URL\r\n    }\r\n  }\r\n}\r\n\r\n// QR Code Manager\r\nclass QrCodeManager {\r\n  constructor(container, modelData) {\r\n    this.container = container;\r\n    this.modelData = modelData;\r\n    this.qrCode = null;\r\n  }\r\n\r\n  async loadImage(url) {\r\n    return new Promise((resolve, reject) => {\r\n      const img = new Image();\r\n      img.onload = () => resolve();\r\n      img.onerror = img.onabort = () =>\r\n        reject(new Error(\"Image failed to load\"));\r\n      img.src = url;\r\n    });\r\n  }\r\n\r\n  async updateQrCode(url) {\r\n    // Clear all existing content inside the container\r\n    this.container.innerHTML = \"\";\r\n\r\n    const qrCodeSettings = this.modelData?.qrCode;\r\n    let imageUrl = qrCodeSettings?.faviconUrl;\r\n\r\n    if (imageUrl) {\r\n      try {\r\n        await this.loadImage(imageUrl);\r\n      } catch (err) {\r\n        logger.warn(\"Failed to load image for QR code:\", err);\r\n        imageUrl = null;\r\n      }\r\n    }\r\n\r\n    const qrCodeOptions = {\r\n      width: parseInt(qrCodeSettings.QRsize) || 240,\r\n      height: parseInt(qrCodeSettings.QRsize) || 240,\r\n      data: url,\r\n      dotsOptions: {\r\n        color: qrCodeSettings.dotColor || \"#000000\",\r\n        type: qrCodeSettings.dotStyle || \"square\",\r\n      },\r\n      cornersSquareOptions: {\r\n        color: qrCodeSettings.cornerColor || \"#000000\",\r\n        type: qrCodeSettings.cornerStyle || \"square\",\r\n      },\r\n      cornersDotOptions: {\r\n        color: qrCodeSettings.cornerDotColor || \"#000000\",\r\n        type: qrCodeSettings.cornerDotStyle || \"square\",\r\n      },\r\n      backgroundOptions: {\r\n        color: qrCodeSettings.backgroundColor || \"#ffffff\",\r\n      },\r\n    };\r\n\r\n    if (imageUrl) {\r\n      qrCodeOptions.image = imageUrl;\r\n      qrCodeOptions.imageOptions = {\r\n        margin: parseInt(qrCodeSettings.faviconMargin) || 0,\r\n      };\r\n    }\r\n\r\n    this.qrCode = new QRCodeStyling(qrCodeOptions);\r\n    this.qrCode.append(this.container);\r\n  }\r\n}\r\n\r\n// Progress modal template\r\nconst progressModalTemplate = document.createElement(\"template\");\r\nprogressModalTemplate.innerHTML = `\r\n  <div class=\"ardisplay-progress-modal\" id=\"ardisplayProgressModal\" style=\"display: none;direction: ltr;\">\r\n    <div class=\"ardisplay-progress-content\">\r\n      <button class=\"ardisplay-progress-close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\r\n        </svg></button>\r\n      <h3 class=\"ardisplay-progress-text\">Loading...</h3>\r\n      <div class=\"ardisplay-progress-bar\">\r\n        <div class=\"ardisplay-progress-bar-fill\" id=\"ardisplayProgressBarFill\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <style>\r\n    .ardisplay-progress-modal {\r\n      position: fixed;\r\n      z-index: 9999;\r\n      width: 100%;\r\n      height: 100%;\r\n      top: 0;\r\n      left: 0;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      background: rgba(0,0,0,0.6);\r\n      backdrop-filter: blur(10px);\r\n      -webkit-backdrop-filter: blur(10px);\r\n    }\r\n    .ardisplay-progress-content {\r\n      position: relative;\r\n      text-align: center;\r\n      font-family: sans-serif;\r\n    }\r\n    .ardisplay-progress-text {\r\n      color:white;\r\n    }\r\n    .ardisplay-progress-bar {\r\n      width: 200px;\r\n      background: transparent;\r\n      border: 2px solid white;\r\n      border-radius: 4px;\r\n      margin-top: 16px;\r\n      overflow: hidden;\r\n    }\r\n    .ardisplay-progress-bar-fill {\r\n      width: 0;\r\n      height: 8px;\r\n      background: white;\r\n      transition: width 0.2s linear;\r\n    }\r\n    .ar-button {\r\n      margin-top: 16px;\r\n      padding: 8px 16px;\r\n      background: #0072f5;\r\n      color: white;\r\n      border: none;\r\n      border-radius: 4px;\r\n      cursor: pointer;\r\n      font-size: 14px;\r\n      display: none;\r\n    }\r\n    .ar-button:hover {\r\n      background: #0058bc;\r\n    }\r\n    .ardisplay-progress-close-button {\r\n      position: fixed;\r\n        top: 10px;\r\n        right: 10px;\r\n        width: 30px;\r\n        height: 30px;\r\n        color: white;\r\n        font-size: 28px;\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n        border: none;\r\n        border-radius: 50%;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        padding: 0;\r\n        background: transparent;\r\n    }\r\n    .ardisplay-progress-close-button:hover {\r\n      color: #ccc;\r\n    }\r\n    .ardisplay-progress-close-button svg{\r\n      width:30px;\r\n      height:30px;\r\n    }\r\n  </style>\r\n`;\r\n\r\nconst STEPS = [\r\n  {\r\n    title: \"Scanning\",\r\n    description:\r\n      \"Stand several feet back. With camera facing wall, make sweeping motion side to side, up and down.\",\r\n  },\r\n  {\r\n    title: \"Ready to view\",\r\n    description: \"Get started with AR view\",\r\n  },\r\n];\r\n\r\n// Multi-steps modal template (bottom 60vh, 90vw, dark overlay)\r\nconst stepsModalTemplate = document.createElement(\"template\");\r\nstepsModalTemplate.innerHTML = `\r\n  <div class=\"ardisplay-multi-steps-overlay\" style=\"display: none;direction: ltr;\">\r\n    <div class=\"ardisplay-overlay-bg\" style=\"\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      background: rgba(0,0,0,0.6);\r\n      backdrop-filter: blur(10px);\r\n      -webkit-backdrop-filter: blur(10px);\r\n      z-index: 9998;\r\n    \">\r\n      <div class=\"ardisplay-steps-close-button\" style=\"\r\n        position: fixed;\r\n        top: 10px;\r\n        right: 10px;\r\n        width: 30px;\r\n        height: 30px;\r\n        color: white;\r\n        font-size: 28px;\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n        border: none;\r\n        border-radius: 50%;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n      \">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" style=\"width:30px;height:30px;\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n        </svg>\r\n      </div>\r\n    </div>\r\n    <div class=\"ardisplay-multi-steps-modal\" style=\"\r\n      position: fixed;\r\n      bottom: .5rem;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      width: calc(100% - 1rem);\r\n      height: auto;\r\n      max-height: 90vh;\r\n      background-color: rgba(255, 255, 255, 0.85);\r\n      -webkit-backdrop-filter: blur(15px);\r\n      backdrop-filter: blur(15px);\r\n      z-index: 9999;\r\n      border-radius: 10px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      overflow: hidden;\r\n      padding: 15px;\r\n    \">\r\n      <div class=\"ardisplay-steps-content\" style=\"padding: 1rem; flex: 1;padding-top: 0;\">\r\n        <h3 class=\"ardisplay-translate-lang instructions-title\">Scanning</h3>\r\n        <img id=\"instructionGif\" src=\"\" class=\"ardisplay-steps-gif\" alt=\"Computer man\">\r\n        <div class=\"ardisplay-instructions-body translate-lang\" data-id=\"space-info\">Stand several feet back. With camera facing wall, make sweeping motion side to side, up and down.</div>\r\n      </div>\r\n      <div class=\"ardisplay-steps-footer\" style=\"\r\n        display: flex; \r\n        justify-content: flex-end; \r\n        flex-direction:column;\r\n        gap: 0.5rem; \r\n        border-top: 1px solid #ccc; \r\n        font-size: 16px;\r\n        font-weight: bold;\r\n        line-height: 1.5;\r\n        padding: 8px;\r\n        width: 75%;\r\n        max-width: 100%;\r\n        margin: 10px auto;\r\n      \">\r\n        <button class=\"ardisplay-next-button ardisplay-multi-button\">Next</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <style>\r\n    /* You can customize these classes as well */\r\n    .ardisplay-multi-steps-overlay.show {\r\n      display: block;\r\n    }\r\n\r\n    .ardisplay-steps-gif{\r\n      width:100%;\r\n      height:auto;\r\n      border-radius: 20px;\r\n    }\r\n\r\n    .ardisplay-view-wall-button{\r\n      width: 100%;\r\n    }\r\n\r\n    .ardisplay-view-wall-button svg{\r\n      width: 24px;\r\n      height: 24px;\r\n      margin-right: 8px;\r\n      fill: white;\r\n      stroke: white;\r\n    }\r\n\r\n    .ardisplay-instructions-body {\r\n        display:flex;\r\n        align-items:center;\r\n        font-size: 16px;\r\n        line-height: 1.5;\r\n        color: #272727;\r\n        margin: 10px 0 10px 0;\r\n        text-align: justify;\r\n        font-family:sans-serif;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 20px;\r\n        font-weight: bold;\r\n        font-family:sans-serif;\r\n        line-height: 1.5;\r\n        margin: 5px;\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        margin: 10px 10px 10px 10px;\r\n    }\r\n\r\n    .ardisplay-steps-header{\r\n      display:flex;\r\n      flex-direction:row;\r\n      width:80%;\r\n      gap:12px;\r\n      margin:auto;\r\n    }\r\n\r\n    .ardisplay-steps-content{\r\n      display:flex;\r\n      flex-direction:column;\r\n      justify-content: center;\r\n      align-items: center;\r\n      overflow:hidden;\r\n    }\r\n\r\n    .ardisplay-step-indicator{\r\n      height:6px;\r\n      background:#bbbbbb;\r\n      flex:1;\r\n    }\r\n\r\n    .ardisplay-step-indicator.active{\r\n      background:black;\r\n    }\r\n\r\n    .ardisplay-multi-button{\r\n      padding-block: .5rem;\r\n      cursor:pointer;\r\n      height:45px;\r\n      border-radius:10px;\r\n      flex-shrink:0;\r\n      font-weight:bold;\r\n    }\r\n\r\n    .ardisplay-next-button{\r\n      background:black!important;\r\n      color:white;\r\n    }\r\n\r\n    .ardisplay-skip-button{\r\n      border:none;\r\n      color:gray;\r\n      text-decoration:underline;\r\n    }\r\n  </style>\r\n`;\r\n\r\nclass ARDisplayViewer extends HTMLElement {\r\n  constructor() {\r\n    super();\r\n    this.attachShadow({ mode: \"open\" });\r\n\r\n    this.selectedIndex = 0;\r\n    this.calculatedScale = null;\r\n    this.modelData = null;\r\n    this.originalSize = null;\r\n    this.variants = [];\r\n    this.variantSizes = [];\r\n    this.scaleEvent = new Event(\"scale\", { bubbles: true, composed: true });\r\n\r\n    this.isModelLoaded = false;\r\n    this.userClickedAR = false;\r\n\r\n    this.currentStep = 1;\r\n    this.totalSteps = 2;\r\n\r\n    // Initialize QR related properties\r\n    this.qrCodeManager = null;\r\n    this.qrModal = null;\r\n\r\n    this.posters = {};\r\n\r\n    // Cache elements\r\n    this.modelViewer = null;\r\n\r\n    // Use a requestAnimationFrame for smoother updates\r\n    this.debouncedRenderSVG = this.animationFrameDebounce(this._renderSVG);\r\n    this.debouncedUpdateDimensionHotspots = this.animationFrameDebounce(\r\n      this._updateDimensionHotspots\r\n    );\r\n\r\n    // Array of GIF URLs for each step\r\n    this.GIF_URLS = [];\r\n\r\n    // Cache for blob URLs\r\n    this.gifCache = {};\r\n\r\n    // Simple preloader function with blob URL caching\r\n    this.preloadImage = async (url) => {\r\n      // If we already have something in cache, return it.\r\n      // It could be a promise or the final blob URL.\r\n      if (this.gifCache[url]) {\r\n        return this.gifCache[url];\r\n      }\r\n\r\n      // Create and cache the promise immediately.\r\n      const promise = fetch(url)\r\n        .then((response) => response.blob())\r\n        .then((blob) => {\r\n          const blobUrl = URL.createObjectURL(blob);\r\n          // Replace the promise with the final blob URL.\r\n          this.gifCache[url] = blobUrl;\r\n          logger.debug(`Created blob URL for: ${url}`);\r\n          return blobUrl;\r\n        })\r\n        .catch((error) => {\r\n          logger.warn(`Failed to preload: ${url}`, error);\r\n          // Remove the failed promise so future attempts can try again\r\n          delete this.gifCache[url];\r\n          // Return the original URL as a fallback\r\n          return url;\r\n        });\r\n\r\n      // Temporarily store the promise to avoid duplicate fetches\r\n      this.gifCache[url] = promise;\r\n      return promise;\r\n    };\r\n\r\n    // Function to setup the preloader for a given step-index\r\n    this.setupPreloaderForStep = (stepIndex, container) => {\r\n      // Only preload if the next gif exists and hasn't been preloaded yet\r\n      if (\r\n        stepIndex + 1 < this.GIF_URLS.length &&\r\n        !this.gifCache[this.GIF_URLS[stepIndex + 1]]\r\n      ) {\r\n        const nextGifUrl = this.GIF_URLS[stepIndex + 1];\r\n        const currentGif = container.querySelector(\".ardisplay-steps-gif\");\r\n\r\n        if (!currentGif) return;\r\n\r\n        // Immediately preload if element is already visible\r\n        const rect = currentGif.getBoundingClientRect();\r\n        const isVisible = rect.top >= 0 && rect.bottom <= window.innerHeight;\r\n\r\n        if (isVisible) {\r\n          this.preloadImage(nextGifUrl);\r\n          return;\r\n        }\r\n\r\n        const observer = new IntersectionObserver(\r\n          (entries, observerInstance) => {\r\n            entries.forEach((entry) => {\r\n              if (entry.isIntersecting) {\r\n                this.preloadImage(nextGifUrl);\r\n                observerInstance.disconnect();\r\n              }\r\n            });\r\n          },\r\n          {\r\n            threshold: 0.5,\r\n          }\r\n        );\r\n\r\n        observer.observe(currentGif);\r\n      }\r\n    };\r\n  }\r\n\r\n  // Debounce using requestAnimationFrame\r\n  animationFrameDebounce(func) {\r\n    let requested = false;\r\n    return (...args) => {\r\n      if (!requested) {\r\n        requested = true;\r\n        requestAnimationFrame(() => {\r\n          func.apply(this, args);\r\n          requested = false;\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  debounce(func, wait) {\r\n    let timeout;\r\n    return function (...args) {\r\n      const context = this;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(() => func.apply(context, args), wait);\r\n    };\r\n  }\r\n\r\n  _sendShortStatsEvent(action, message = \"\") {\r\n    logger.debug(this.modelData);\r\n    const eventData = {\r\n      dmodelId: this.modelData?.modelId || \"no-model-id\",\r\n      action,\r\n      browser: navigator.userAgent,\r\n      message: message || undefined,\r\n    };\r\n\r\n    // Use a queue or offline handling for stats if necessary\r\n    fetch(\"https://ardisplayboilerplate.vercel.app/api/stats\", {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(eventData),\r\n    })\r\n      .then((response) => {\r\n        if (!response.ok) {\r\n          logger.error(\"Error sending stats:\", response.status);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        logger.error(\"Error sending stats:\", error);\r\n      });\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    return [\"ar-btn-config\"];\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    if (name === \"ar-btn-config\" && oldValue !== newValue) {\r\n      // Update the AR button configuration when the attribute changes.\r\n      this._updateArBtnConfig(newValue);\r\n    }\r\n  }\r\n\r\n  _updateArBtnConfig(encodedConfig) {\r\n    if (!this.modelData) {\r\n      console.warn(\r\n        \"Deferring AR button config update: modelData not ready yet.\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (encodedConfig) {\r\n      try {\r\n        // Decode from base64 and parse the JSON.\r\n        const decoded = decodeBase64(encodedConfig);\r\n        const customArBtnConfig = JSON.parse(decoded);\r\n\r\n        // Instead of completely replacing, merge with any API/default config.\r\n        let customConfig = {\r\n          ...this.modelData.arBtn, // the existing/default configuration\r\n          ...customArBtnConfig, // any properties provided by the user will override the default ones\r\n        };\r\n\r\n        const arBtn =\r\n          this.modelData.mode !== \"popup\"\r\n            ? this.shadowRoot.querySelector(\".ardisplay-qr-code-button\")\r\n            : document.querySelector(\".ardisplay-qr-code-button\");\r\n\r\n        const view3DButton = this.shadowRoot.querySelector(\r\n          \".ardisplay-view-3d-button\"\r\n        );\r\n\r\n        if (view3DButton) {\r\n          view3DButton.style.backgroundColor = customConfig.btnBgColor;\r\n          view3DButton.style.color = customConfig.btnTextColor;\r\n          view3DButton.style.borderRadius = customConfig.cornerRadius + \"px\";\r\n          view3DButton.style.fontSize = customConfig.btnSize + \"px\";\r\n          view3DButton.style.boxSizing = \"border-box\";\r\n\r\n          if (customConfig.modalButtonText) {\r\n            view3DButton.querySelector(\"span\").innerHTML =\r\n              customConfig.modalButtonText;\r\n          }\r\n        }\r\n\r\n        if (arBtn) {\r\n          arBtn.style.backgroundColor = customConfig.btnBgColor;\r\n          arBtn.style.color = customConfig.btnTextColor;\r\n          arBtn.style.borderRadius = customConfig.cornerRadius + \"px\";\r\n          arBtn.style.fontSize = customConfig.btnSize + \"px\";\r\n          arBtn.style.boxSizing = \"border-box\";\r\n\r\n          // Update the button icon and text based on the configuration.\r\n          // This creates an <i> element with a data-lucide attribute.\r\n          const iconHTML = customConfig.btnIcon\r\n            ? `<i data-lucide=\"${customConfig.btnIcon}\" style=\"width: 24px; height: 24px; color: inherit;\"></i>`\r\n            : \"\";\r\n          arBtn.innerHTML = `${iconHTML} ${customConfig.btnText}`;\r\n\r\n          // Process the lucide icons within the button so that the <i> element is replaced with an SVG.\r\n          this._processLucideIcons(arBtn);\r\n        }\r\n      } catch (error) {\r\n        console.error(\r\n          \"Invalid AR button configuration provided in ar-btn-config attribute:\",\r\n          error\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  async connectedCallback() {\r\n    const attributes = this._getAttributes();\r\n\r\n    await this._getModelData();\r\n\r\n    if (this.modelData.enabled === false && !this.hasAttribute(\"enabled\"))\r\n      return;\r\n\r\n    const initialPlacement =\r\n      (this.modelData.options &&\r\n        this.modelData.options.length > 0 &&\r\n        this.modelData.options[0].placement) ||\r\n      this.modelData.placement;\r\n\r\n    if (initialPlacement === \"wall\") {\r\n      this.GIF_URLS.push(`${CDN_URL}/wall.webp`);\r\n    } else {\r\n      this.GIF_URLS.push(`${CDN_URL}/floor.gif`);\r\n    }\r\n\r\n    // Bundling external styles and scripts\r\n    this.styles = this._consolidateStyles();\r\n    if (this.modelData.mode !== \"popup\") {\r\n      this.shadowRoot.appendChild(this.styles);\r\n    } else {\r\n      document.body.appendChild(this.styles);\r\n    }\r\n\r\n    const qrModalTemplate = document.createElement(\"template\");\r\n    qrModalTemplate.innerHTML = `\r\n      <!-- QR Code Modal -->\r\n      <style>\r\n        #qrModal {\r\n          position: fixed;\r\n          top: 0;\r\n          left: 0;\r\n          width: 100vw;\r\n          height: 100vh;\r\n          background: rgba(0, 0, 0, 0.5);\r\n          display: none;\r\n          justify-content: center;\r\n          align-items: center;\r\n          z-index: 1000;\r\n        }\r\n        .qr-modal-content {\r\n          background: white;\r\n          border-radius: 8px;\r\n          position: relative;\r\n          background-color: #fefefe;\r\n          border: 1px solid #888;\r\n          width: 820px;\r\n          height: 418px;\r\n          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\r\n        }\r\n        .qr-close-button {\r\n          position: absolute;\r\n          top: 10px;\r\n          right: 10px;\r\n          width: 30px;\r\n          height: 30px;\r\n          background-color: rgba(0, 0, 0, 0.5);\r\n          color: white;\r\n          font-size: 28px;\r\n          font-weight: bold;\r\n          cursor: pointer;\r\n          border: none;\r\n          border-radius: 50%;\r\n          display: flex;\r\n          justify-content: center;\r\n          align-items: center;\r\n        }\r\n        .qr-modal-content h2 {\r\n          margin-top: 0;\r\n          color: #333;\r\n          text-align: center;\r\n        }\r\n        .qr-code-container {\r\n          display: flex;\r\n          justify-content: center;\r\n          align-items: center;\r\n        }\r\n        #qr-code {\r\n          margin: 20px auto;\r\n        }\r\n      </style>\r\n      <div id=\"qrModal\" class=\"qr-modal\" style=\"direction: ltr;\">\r\n          <div class=\"qr-modal-content\" style=\"display: flex; flex-direction: row;text-align: center;overflow: hidden;\">\r\n          <button class=\"qr-close-button\">×</button>\r\n          <div style=\"width: 50%; height:100%;flex-grow: 0; flex-shrink: 0;display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;\">\r\n              <h2 style=\"padding-block: 10px;\">\r\n                  <p id=\"btn-text\" style=\"margin: 0\">${this.modelData.title}</p>\r\n              </h2>\r\n              <p data-id=\"qrcode-info\" class=\"translate-lang\" style=\"margin:0\">${this.modelData.description}</p>\r\n              <div class=\"qr-code-container\">\r\n                  <div id=\"qr-code\"></div>\r\n              </div>\r\n          </div>\r\n          <div style=\"width: 50%; height:100%; flex-grow: 0; flex-shrink: 0;\">\r\n              <img src=\"${this.modelData.options[0].posterFileUrl}\" alt=\"Artwork\" style=\"width: 100%; height: 100%; object-fit: contain; object-position: center;\">\r\n          </div>\r\n          </div>\r\n      </div>\r\n    `;\r\n\r\n    const template = hotspotsTemplate();\r\n\r\n    const modalModeTemplate = document.createElement(\"template\");\r\n    modalModeTemplate.innerHTML = `\r\n      <style>\r\n      .model-viewer-container{\r\n        position: fixed;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        width: calc(100% - 96px);\r\n        height: calc(100% - 96px);\r\n        display: none;\r\n        background-color: white;\r\n        flex-direction: row;\r\n        z-index: 999;\r\n      }\r\n\r\n      /* Consolidated Styles */\r\n      model-viewer {\r\n        width: 100%;\r\n        height: 100%;\r\n        --min-hotspot-opacity: 0;\r\n        position: relative;\r\n      }\r\n        \r\n      .ardisplay-close-button{\r\n        position: absolute;\r\n        top: 10px;\r\n        right: 10px;\r\n        background: none;\r\n        border: none;\r\n        cursor: pointer;\r\n        padding: 0;\r\n      }\r\n      .ardisplay-close-button svg{\r\n        width: 24px;\r\n        height: 24px;\r\n        fill: black;\r\n      }\r\n      .ardisplay-model-viewer-overlay{\r\n        content: '';\r\n        position: fixed;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        width: 100%;\r\n        height: 100%;\r\n        background-color: rgba(0, 0, 0, 0.5);\r\n        z-index: 10;\r\n        display: none;\r\n      }\r\n      .ardisplay-details-panel{\r\n        width: 400px;\r\n        height: 100%;\r\n        background-color: white;\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding-block: 1rem;\r\n        padding-top: 50px; // added padding\r\n      }\r\n      @media only screen and (max-width: 900px){\r\n        .model-viewer-container{\r\n          width: 100%;\r\n          height: calc(100% - 48px);\r\n          transform: translate(-50%, 0);\r\n          top: 48px;\r\n        }\r\n        .ardisplay-details-panel{\r\n          display: none!important;\r\n        }\r\n\r\n        .ardisplay-model-viewer-overlay{\r\n          top: -48px;\r\n        }\r\n\r\n        .ardisplay-qr-code-button{\r\n          display:flex!important;\r\n        }\r\n      }\r\n      .ardisplay-details-panel{\r\n        display:flex;\r\n      }\r\n      .ardisplay-qr-code-button{\r\n        all: unset;\r\n        position: absolute;\r\n        display:none;\r\n        top: 10px;\r\n        right: 50%;\r\n        transform: translateX(50%);\r\n        background: white;\r\n        cursor: pointer;\r\n        padding: 10px;\r\n        z-index: 1000;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 10px;\r\n        white-space: nowrap;\r\n      }\r\n      .ardisplay-show{\r\n        display:flex!important;\r\n      }\r\n      </style>\r\n      <div class=\"model-viewer-container\" style=\"direction: ltr;\">\r\n                <model-viewer  \r\n                    ar\r\n                    shadow-intensity=\"${this.modelData.shadow}\"\r\n                    ar-placement=\"${\r\n                      (this.modelData.options &&\r\n                        this.modelData.options.length > 0 &&\r\n                        this.modelData.options[0].placement) ||\r\n                      this.modelData.placement\r\n                    }\"\r\n                    ar-modes=\"webxr scene-viewer quick-look\"\r\n                    ar-scale=\"fixed\"\r\n                    camera-controls=\"true\"\r\n                    disable-pan=\"true\"\r\n                    disable-tap=\"true\"\r\n                    ar-status=\"not-presenting\"\r\n                >\r\n                    ${template}\r\n                    <button class=\"ardisplay-qr-code-button\" style=\"background-color: ${\r\n                      this.modelData.arBtn.btnBgColor\r\n                    };color: ${\r\n      this.modelData.arBtn.btnTextColor\r\n    };border-radius: ${this.modelData.arBtn.cornerRadius}px;font-size: ${\r\n      this.modelData.arBtn.btnSize - 6\r\n    }px;text-wrap: nowrap;box-sizing: border-box;\">\r\n                        ${\r\n                          this.modelData.arBtn.btnIcon\r\n                            ? `<i data-lucide=\"${this.modelData.arBtn.btnIcon}\" style=\"width: 24px; height: 24px;color: inherit;\"></i>`\r\n                            : \"\"\r\n                        }\r\n                        ${this.modelData.arBtn.btnText}\r\n                    </button>\r\n                </model-viewer>\r\n                <button class=\"ardisplay-close-button\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                        <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\r\n                    </svg>\r\n                </button>\r\n                <div class=\"ardisplay-details-panel\" style=\"flex-direction:column;\">\r\n                    <div class=\"ar-display-custom-panel\" style=\"flex:1;display:block;\"></div>\r\n                    <button id=\"showQRButton\" style=\"margin-top: 16px; margin-right: 16px; padding: 8px 16px; color: black; border: none; border-radius: 4px; cursor: pointer;display:flex;flex-direction:row;align-items:center;gap:16px;font-weight:700;\">\r\n                      <svg viewBox=\"0 0 24 24\" focusable=\"false\" width=\"24\" height=\"24\" aria-hidden=\"true\" class=\"rotera-svg-icon\"><path d=\"M2 2h7v2H4v5H2V2zm18 2h-5V2h7v7h-2V4zM4 15H2v7h7v-2H4v-5zm18 0h-2v5h-5v2h7v-7z\"></path><path d=\"M11 6h2v5h5v7h-7v-5H6v-2h5V6z\"></path><path d=\"M9 6H6v3h3V6zm6 0h3v3h-3V6zm-6 9H6v3h3v-3z\"></path></svg>\r\n                      Try it in your home\r\n                    </button>\r\n                    <div id=\"inline-qr-container\" style=\"display: none; margin-top: 16px;justify-content:center;align-items:center;\"></div>\r\n                </div>\r\n            </div>\r\n            <div class=\"ardisplay-model-viewer-overlay\"></div>\r\n        </div>\r\n    `;\r\n\r\n    this.styles = this._consolidateStyles();\r\n    this.shadowRoot.appendChild(this.styles);\r\n\r\n    // Load template first\r\n    await this._loadTemplate(this.modelData.mode);\r\n    this._moveSlottedContent();\r\n\r\n    // Initialize the AR button configuration based on the current attribute.\r\n    this._updateArBtnConfig(this.getAttribute(\"ar-btn-config\"));\r\n\r\n    // Check if the user passed an override for the AR button configuration\r\n    const arBtnConfigEncoded = this.getAttribute(\"ar-btn-config\");\r\n    if (arBtnConfigEncoded) {\r\n      try {\r\n        // Decode from base64 and parse the JSON\r\n        const decoded = decodeBase64(arBtnConfigEncoded);\r\n        const customArBtnConfig = JSON.parse(decoded);\r\n        // Override the API data with the user-provided configuration.\r\n        // This means that later in your code, when you use:\r\n        //   this.modelData.arBtn.btnBgColor, btnText, etc.\r\n        // they will come from this custom configuration.\r\n        this.modelData.arBtn = customArBtnConfig;\r\n      } catch (error) {\r\n        console.error(\r\n          \"Invalid AR button configuration provided in ar-btn-config attribute:\",\r\n          error\r\n        );\r\n      }\r\n    }\r\n\r\n    // Add progress modal to shadow DOM\r\n    createPortal(progressModalTemplate.content.cloneNode(true));\r\n\r\n    // Add multi-steps modal template using portal\r\n    createPortal(stepsModalTemplate.content.cloneNode(true));\r\n\r\n    const gifFile = initialPlacement === \"wall\" ? \"wall.webp\" : \"floor.gif\";\r\n    const instructionGif = document.querySelector(\"#instructionGif\");\r\n    if (instructionGif) {\r\n      instructionGif.src = `${CDN_URL}/${gifFile}`;\r\n    }\r\n\r\n    const contentBody = this.modelData.placement === \"wall\" ? \"wall\" : \"floor\";\r\n    const instructionBody = document.querySelector(\r\n      \".ardisplay-instructions-body\"\r\n    );\r\n    if (instructionBody) {\r\n      instructionBody.innerHTML = `Stand several feet back. With camera facing ${\r\n        initialPlacement === \"wall\" ? \"wall\" : \"floor\"\r\n      }, make sweeping motion side to side, up and down.`;\r\n    }\r\n\r\n    if (this.modelData.mode !== \"popup\") {\r\n      // Add QR modal template using portal\r\n      createPortal(qrModalTemplate.content.cloneNode(true));\r\n    }\r\n\r\n    if (this.modelData.mode === \"popup\") {\r\n      createPortal(modalModeTemplate.content.cloneNode(true));\r\n    }\r\n\r\n    this.modelViewer =\r\n      this.modelData.mode === \"popup\"\r\n        ? document.querySelector(\"model-viewer\")\r\n        : this.shadowRoot.querySelector(\"model-viewer\");\r\n\r\n    const showQRButton = document.querySelector(\"#showQRButton\");\r\n    if (showQRButton) {\r\n      showQRButton.addEventListener(\"click\", () => {\r\n        // NEW CODE: show the QR inline\r\n        const inlineQrContainer = document.querySelector(\r\n          \"#inline-qr-container\"\r\n        );\r\n        if (inlineQrContainer) {\r\n          // Reveal the container if it was hidden\r\n          inlineQrContainer.classList.toggle(\"ardisplay-show\");\r\n\r\n          // Update the QR code to reflect your desired URL\r\n          const currentUrl = `${BRIDGE_URL}/${this.modelData.modelId}`;\r\n          if (this.qrCodeManager) {\r\n            this.qrCodeManager.updateQrCode(currentUrl);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    if (this.modelData.mode === \"popup\") {\r\n      this._processLucideIcons(\r\n        document.querySelector(\".ardisplay-qr-code-button\")\r\n      );\r\n    }\r\n\r\n    // Set up QR code listeners after template is loaded\r\n    const qrCodeButton =\r\n      this.modelData.mode !== \"popup\"\r\n        ? this.shadowRoot.querySelector(\".ardisplay-qr-code-button\")\r\n        : document.querySelector(\".ardisplay-qr-code-button\");\r\n\r\n    if (this.hasAttribute(\"fullWidth\") && this.modelData.mode === \"none\") {\r\n      qrCodeButton.style.width = \"100%\";\r\n    }\r\n    qrCodeButton.style.boxSizing = \"border-box\";\r\n    const qrCodeContainer = document.querySelector(\"#qr-code\");\r\n\r\n    if (qrCodeButton) {\r\n      // Initialize QR code manager\r\n      this.qrCodeManager = new QrCodeManager(qrCodeContainer, this.modelData);\r\n      this._setupQRCodeListeners();\r\n    }\r\n\r\n    if (this.modelData.mode === \"popup\") {\r\n      const inlineQrContainer = document.querySelector(\"#inline-qr-container\");\r\n      if (inlineQrContainer) {\r\n        this.qrCodeManager = new QrCodeManager(\r\n          inlineQrContainer,\r\n          this.modelData\r\n        );\r\n      }\r\n    }\r\n\r\n    const nextBtn = document.querySelector(\".ardisplay-next-button\");\r\n    const stepsCloseBtn = document.querySelector(\r\n      \".ardisplay-steps-close-button\"\r\n    );\r\n    nextBtn?.addEventListener(\"click\", this._goToNextStep.bind(this));\r\n    stepsCloseBtn?.addEventListener(\"click\", () => {\r\n      const stepsOverlay = document.querySelector(\r\n        \".ardisplay-multi-steps-overlay\"\r\n      );\r\n      if (stepsOverlay) {\r\n        stepsOverlay.style.display = \"none\";\r\n      }\r\n    });\r\n\r\n    // Setup progress modal close functionality\r\n    const progressModal = document.querySelector(\"#ardisplayProgressModal\");\r\n    const progressContent = document.querySelector(\r\n      \".ardisplay-progress-content\"\r\n    );\r\n    const closeButton = document.querySelector(\r\n      \".ardisplay-progress-close-button\"\r\n    );\r\n\r\n    if (progressModal && closeButton) {\r\n      // Close on X button click\r\n      closeButton.addEventListener(\"click\", () => {\r\n        progressModal.style.display = \"none\";\r\n      });\r\n\r\n      // Close on click outside modal content\r\n      progressModal.addEventListener(\"click\", (event) => {\r\n        if (!progressContent.contains(event.target)) {\r\n          progressModal.style.display = \"none\";\r\n        }\r\n      });\r\n    }\r\n\r\n    this._setupEventListeners();\r\n    // this._setupBottomNavBar(this.modelViewer);\r\n\r\n    this._sendShortStatsEvent(\"View\");\r\n\r\n    // ---------- UI updates for bottom nav and floating cart ----------\r\n    // Bottom area container (relative positioning for floating button)\r\n    const bottomContainer = createDomElement(\"div\", {\r\n      classList: [\"bottom-container\"],\r\n    });\r\n    bottomContainer.style.direction = \"ltr\";\r\n    this.modelViewer.appendChild(bottomContainer);\r\n\r\n    // Setup the floating cart button\r\n    this._setupCartButton(bottomContainer);\r\n\r\n    // Setup the panels and bottom nav\r\n    this._setupBottomNavBar(bottomContainer);\r\n    // ------------------------------------------------------------------\r\n\r\n    if (this._isIOSDevice() && this.modelViewer) {\r\n      this.modelViewer.removeAttribute(\"ar-scale\");\r\n    }\r\n  }\r\n\r\n  _showStepsModal() {\r\n    const modal = document.querySelector(\".ardisplay-multi-steps-overlay\");\r\n    if (modal) {\r\n      modal.style.display = \"block\";\r\n      // Preload the first GIF immediately since it's visible\r\n      const firstGifUrl = this.GIF_URLS[0];\r\n      this.preloadImage(firstGifUrl);\r\n      // Setup preloading for the second GIF\r\n      this.setupPreloaderForStep(0, document);\r\n      // Initialize swipe listeners\r\n      this._setupSwipeListeners();\r\n    }\r\n  }\r\n\r\n  _skipToLast() {\r\n    this.currentStep = this.totalSteps;\r\n    const stepsContent = document.querySelector(\".ardisplay-steps-content\");\r\n    const nextBtn = document.querySelector(\".ardisplay-next-button\");\r\n    const skipBtn = document.querySelector(\".ardisplay-skip-button\");\r\n\r\n    // Update step indicators\r\n    document\r\n      .querySelectorAll(\".ardisplay-step-indicator\")\r\n      .forEach((el, index) => {\r\n        el.classList.toggle(\"active\", index < this.currentStep);\r\n      });\r\n\r\n    // Update content for final step\r\n    stepsContent.innerHTML = `\r\n      <h3 class=\"ardisplay-instructions-title\">${\r\n        STEPS[this.currentStep - 1].title\r\n      }</h3>\r\n      <img src=\"${this.GIF_URLS[this.GIF_URLS.length - 1]}\"\r\n           class=\"ardisplay-steps-gif\"\r\n           alt=\"Product preview\"\r\n           style=\"width: 100%;\">\r\n      <div class=\"ardisplay-instructions-body\">${\r\n        STEPS[this.currentStep - 1].description\r\n      }</div>\r\n      <button class=\"ardisplay-view-wall-button\" style=\"\r\n        background: black;\r\n        color: white;\r\n        border: none;\r\n        padding: 12px 24px;\r\n        border-radius: 8px;\r\n        margin-top: 16px;\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n        justify-content: center;\r\n        \">\r\n        <svg version=\"1.1\" id=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\r\n            viewBox=\"0 0 50 50\" enable-background=\"new 0 0 50 50\" xml:space=\"preserve\">\r\n        <g>\r\n          <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n            M33.002,49H44c2.762,0,5-2.239,5-5V32.626\"/>\r\n          <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n            M1,33v10.999c0,2.763,2.24,5,5,5h11\"/>\r\n          <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n            M17,1H6C3.238,1,1,3.238,1,6v11\"/>\r\n          <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n            M49,16.625V6c0-2.762-2.238-5-5-5H33.002\"/>\r\n          <g>\r\n            <path d=\"M39,39c0,1.104-1.116,2-2.22,2L14.89,35C13.785,35,13,34.104,13,33V17c0-1.104,0.676-2,1.78-2l22.11-6\r\n              C37.994,9,39,9.896,39,11V39z M23.686,29.171c-0.59,0.588-0.59,1.541,0,2.129c0.293,0.295,0.678,0.441,1.064,0.441\r\n              c0.385,0,0.77-0.146,1.064-0.441l4.377-4.376l4.199,4.198c0.588,0.59,1.541,0.59,2.129,0c0.588-0.588,0.588-1.541,0-2.129\r\n              l-5.264-5.264c-0.588-0.59-1.541-0.59-2.129,0l-1.697,1.697l-3.76-3.758c-0.586-0.586-1.535-0.586-2.121,0l-6.943,6.943\r\n              c-0.586,0.586-0.586,1.535,0,2.121c0.293,0.293,0.676,0.439,1.061,0.439c0.383,0,0.768-0.146,1.061-0.439l5.883-5.883l2.699,2.697\r\n              L23.686,29.171z M29.119,19.571c0-0.998-0.809-1.807-1.807-1.807c-0.996,0-1.805,0.809-1.805,1.807\r\n              c0,0.996,0.809,1.805,1.805,1.805C28.311,21.376,29.119,20.567,29.119,19.571\"/>\r\n          </g>\r\n        </g>\r\n        </svg>\r\n        View on your wall\r\n      </button>\r\n    `;\r\n\r\n    // Hide next/skip buttons on last step\r\n    if (nextBtn) {\r\n      requestAnimationFrame(() => {\r\n        nextBtn.parentElement.style.display = \"none\";\r\n      });\r\n    }\r\n    if (skipBtn) {\r\n      requestAnimationFrame(() => {\r\n        skipBtn.style.display = \"none\";\r\n      });\r\n    }\r\n\r\n    // Add click handler for view wall button\r\n    const viewWallBtn = stepsContent.querySelector(\r\n      \".ardisplay-view-wall-button\"\r\n    );\r\n    if (viewWallBtn) {\r\n      viewWallBtn.addEventListener(\"click\", () => {\r\n        this.handleActivateAR();\r\n        const modal = document.querySelector(\".ardisplay-multi-steps-overlay\");\r\n        if (modal) modal.style.display = \"none\";\r\n      });\r\n    }\r\n  }\r\n\r\n  async _goToNextStep() {\r\n    if (this.currentStep < this.totalSteps) {\r\n      this.currentStep++;\r\n      document\r\n        .querySelectorAll(\".ardisplay-step-indicator\")\r\n        .forEach((el, index) => {\r\n          el.classList.remove(\"active\");\r\n          if (index <= this.currentStep - 1) {\r\n            el.classList.add(\"active\");\r\n          }\r\n        });\r\n\r\n      // Handle last step specially\r\n      if (this.currentStep === this.totalSteps) {\r\n        const stepsContent = document.querySelector(\".ardisplay-steps-content\");\r\n        const nextBtn = document.querySelector(\".ardisplay-next-button\");\r\n        const skipBtn = document.querySelector(\".ardisplay-skip-button\");\r\n\r\n        // Update content for final step\r\n        stepsContent.innerHTML = `\r\n          <h3 class=\"ardisplay-instructions-title\">${\r\n            STEPS[this.currentStep - 1].title\r\n          }</h3>\r\n          <img src=\"${this.GIF_URLS[this.GIF_URLS.length - 1]}\"\r\n               class=\"ardisplay-steps-gif\"\r\n               alt=\"Product preview\"\r\n               style=\"object-fit: cover;width: 100%;\">\r\n          <div class=\"ardisplay-instructions-body\">${\r\n            STEPS[this.currentStep - 1].description\r\n          }</div>\r\n          <button class=\"ardisplay-view-wall-button\" style=\"\r\n            background: black;\r\n            color: white;\r\n            border: none;\r\n            padding: 12px 24px;\r\n            border-radius: 8px;\r\n            margin-top: 16px;\r\n            font-weight: bold;\r\n            cursor: pointer;\r\n            display: flex;\r\n            flex-direction: row;\r\n            align-items: center;\r\n            justify-content: center;\r\n            \">\r\n              <svg version=\"1.1\" id=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\r\n                  viewBox=\"0 0 50 50\" enable-background=\"new 0 0 50 50\" xml:space=\"preserve\">\r\n              <g>\r\n                <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n                  M33.002,49H44c2.762,0,5-2.239,5-5V32.626\"/>\r\n                <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n                  M1,33v10.999c0,2.763,2.24,5,5,5h11\"/>\r\n                <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n                  M17,1H6C3.238,1,1,3.238,1,6v11\"/>\r\n                <path fill=\"none\"  stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"\r\n                  M49,16.625V6c0-2.762-2.238-5-5-5H33.002\"/>\r\n                <g>\r\n                  <path d=\"M39,39c0,1.104-1.116,2-2.22,2L14.89,35C13.785,35,13,34.104,13,33V17c0-1.104,0.676-2,1.78-2l22.11-6\r\n                    C37.994,9,39,9.896,39,11V39z M23.686,29.171c-0.59,0.588-0.59,1.541,0,2.129c0.293,0.295,0.678,0.441,1.064,0.441\r\n                    c0.385,0,0.77-0.146,1.064-0.441l4.377-4.376l4.199,4.198c0.588,0.59,1.541,0.59,2.129,0c0.588-0.588,0.588-1.541,0-2.129\r\n                    l-5.264-5.264c-0.588-0.59-1.541-0.59-2.129,0l-1.697,1.697l-3.76-3.758c-0.586-0.586-1.535-0.586-2.121,0l-6.943,6.943\r\n                    c-0.586,0.586-0.586,1.535,0,2.121c0.293,0.293,0.676,0.439,1.061,0.439c0.383,0,0.768-0.146,1.061-0.439l5.883-5.883l2.699,2.697\r\n                    L23.686,29.171z M29.119,19.571c0-0.998-0.809-1.807-1.807-1.807c-0.996,0-1.805,0.809-1.805,1.807\r\n                    c0,0.996,0.809,1.805,1.805,1.805C28.311,21.376,29.119,20.567,29.119,19.571\"/>\r\n                </g>\r\n              </g>\r\n              </svg>\r\n              View on your wall\r\n          </button>\r\n        `;\r\n\r\n        const gifElement = stepsContent.querySelector(\".ardisplay-steps-gif\"); // Get the newly created img element\r\n        const currentGifUrl = this.GIF_URLS[this.GIF_URLS.length - 1]; // URL for the last step\r\n\r\n        // Hide next/skip buttons on last step\r\n        if (nextBtn) {\r\n          requestAnimationFrame(() => {\r\n            nextBtn.parentElement.style.display = \"none\";\r\n          });\r\n        }\r\n        if (skipBtn) {\r\n          requestAnimationFrame(() => {\r\n            skipBtn.style.display = \"none\";\r\n          });\r\n        }\r\n\r\n        try {\r\n          const blobUrl = await this.preloadImage(currentGifUrl);\r\n          gifElement.src = blobUrl;\r\n          gifElement.setAttribute(\"loading\", \"eager\");\r\n        } catch (error) {\r\n          gifElement.src = currentGifUrl;\r\n          logger.warn(\r\n            \"Failed to use blob URL for last step, falling back to original URL\",\r\n            error\r\n          );\r\n        }\r\n\r\n        // Add click handler for view wall button\r\n        const viewWallBtn = stepsContent.querySelector(\r\n          \".ardisplay-view-wall-button\"\r\n        );\r\n        if (viewWallBtn) {\r\n          viewWallBtn.addEventListener(\"click\", () => {\r\n            this.handleActivateAR();\r\n            const modal = document.querySelector(\r\n              \".ardisplay-multi-steps-overlay\"\r\n            );\r\n            if (modal) modal.style.display = \"none\";\r\n          });\r\n        }\r\n      } else {\r\n        // Normal step update\r\n        const gifElement = document.querySelector(\".ardisplay-steps-gif\");\r\n        const currentGifUrl = this.GIF_URLS[this.currentStep - 1];\r\n\r\n        try {\r\n          // Get or create blob URL for the current GIF\r\n          const blobUrl = await this.preloadImage(currentGifUrl);\r\n          gifElement.src = blobUrl;\r\n          gifElement.setAttribute(\"loading\", \"eager\");\r\n        } catch (error) {\r\n          // Fallback to original URL if blob creation fails\r\n          gifElement.src = currentGifUrl;\r\n          logger.warn(\r\n            \"Failed to use blob URL, falling back to original URL\",\r\n            error\r\n          );\r\n        }\r\n\r\n        document.querySelector(\".ardisplay-instructions-title\").innerHTML =\r\n          STEPS[this.currentStep - 1].title;\r\n        document.querySelector(\".ardisplay-instructions-body\").innerHTML =\r\n          STEPS[this.currentStep - 1].description;\r\n\r\n        // Setup preloading for the next step's gif\r\n        this.setupPreloaderForStep(this.currentStep - 1, document);\r\n      }\r\n    }\r\n  }\r\n\r\n  async _goToPreviousStep() {\r\n    if (this.currentStep > 1) {\r\n      this.currentStep--;\r\n      document\r\n        .querySelectorAll(\".ardisplay-step-indicator\")\r\n        .forEach((el, index) => {\r\n          el.classList.remove(\"active\");\r\n          if (index < this.currentStep) {\r\n            el.classList.add(\"active\");\r\n          }\r\n        });\r\n\r\n      // Update content for the previous slide using this.modelData.placement\r\n      const stepsContent = document.querySelector(\".ardisplay-steps-content\");\r\n      stepsContent.innerHTML = `\r\n        <h3 class=\"ardisplay-instructions-title\">${\r\n          STEPS[this.currentStep - 1].title\r\n        }</h3>\r\n        <img src=\"${this.GIF_URLS[this.currentStep - 1]}\"\r\n             class=\"ardisplay-steps-gif\"\r\n             alt=\"Product preview\"\r\n             style=\"width: 100%;\">\r\n        <div class=\"ardisplay-instructions-body\">\r\n          Stand several feet back. With camera facing ${\r\n            (this.variants[this.selectedIndex] &&\r\n              this.variants[this.selectedIndex].placement) ||\r\n            this.modelData.placement\r\n          }, make sweeping motion side to side, up and down.\r\n        </div>\r\n      `;\r\n\r\n      // Restore next button container to flex (in case it was hidden on the final slide)\r\n      const nextBtn = document.querySelector(\".ardisplay-next-button\");\r\n      if (nextBtn && nextBtn.parentElement) {\r\n        nextBtn.parentElement.style.display = \"flex\";\r\n      }\r\n    }\r\n  }\r\n\r\n  _setupSwipeListeners() {\r\n    const stepsContent = document.querySelector(\".ardisplay-steps-content\");\r\n    if (!stepsContent) return;\r\n\r\n    let touchStartX = 0;\r\n    let touchEndX = 0;\r\n    const swipeThreshold = 50; // minimum px needed for a valid swipe\r\n\r\n    const touchStartHandler = (e) => {\r\n      touchStartX = e.changedTouches[0].screenX;\r\n    };\r\n\r\n    const touchEndHandler = (e) => {\r\n      touchEndX = e.changedTouches[0].screenX;\r\n      this._handleSwipeGesture(touchStartX, touchEndX, swipeThreshold);\r\n    };\r\n\r\n    stepsContent.addEventListener(\"touchstart\", touchStartHandler);\r\n    stepsContent.addEventListener(\"touchend\", touchEndHandler);\r\n\r\n    // Store handlers for cleanup\r\n    this._swipeHandlers = {\r\n      start: touchStartHandler,\r\n      end: touchEndHandler,\r\n      element: stepsContent,\r\n    };\r\n  }\r\n\r\n  _handleSwipeGesture(startX, endX, threshold) {\r\n    const diffX = endX - startX;\r\n    if (Math.abs(diffX) > threshold) {\r\n      if (diffX < 0) {\r\n        // Swipe left: go to next step\r\n        this._goToNextStep();\r\n      } else {\r\n        // Swipe right: go to previous step\r\n        this._goToPreviousStep();\r\n      }\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    // Remove global event listeners\r\n    document.removeEventListener(\r\n      \"mousedown\",\r\n      this.boundHandleDocumentMouseDown\r\n    );\r\n    document.removeEventListener(\"scale\", this.boundHandleScale);\r\n\r\n    if (this.modelViewer) {\r\n      this.modelViewer.removeEventListener(\r\n        \"model-visibility\",\r\n        this.boundHandleModelVisibility\r\n      );\r\n      this.modelViewer.removeEventListener(\r\n        \"ar-status\",\r\n        this.boundHandleArStatus\r\n      );\r\n      this.modelViewer.removeEventListener(\r\n        \"camera-change\",\r\n        this.boundHandleCameraChange\r\n      );\r\n      this.modelViewer.removeEventListener(\r\n        \"scene-graph-ready\",\r\n        this.boundHandleSceneGraphReady\r\n      );\r\n      this.modelViewer.removeEventListener(\"load\", this.boundHandleLoad);\r\n    }\r\n\r\n    // Cleanup blob URLs when component is destroyed\r\n    this.cleanupBlobUrls();\r\n\r\n    // Clean up swipe listeners if they exist\r\n    if (this._swipeHandlers) {\r\n      const { start, end, element } = this._swipeHandlers;\r\n      element.removeEventListener(\"touchstart\", start);\r\n      element.removeEventListener(\"touchend\", end);\r\n      this._swipeHandlers = null;\r\n    }\r\n  }\r\n\r\n  async _getModelData() {\r\n    // --- ADD THIS: Define your fallback data ---\r\n    const FALLBACK_MODEL_DATA = {\r\n      title: \"demo\",\r\n      modelId: \"67e796c8294328fd88bfba83\", // Example ID, could be different if needed for fallback\r\n      logo: \"\",\r\n      addToCartUrl: \"https://www.demo.com/demo/addToCart\",\r\n      url: \"https://ardisplay.io\", // Fallback URL\r\n      description:\r\n        \"View this product in your environment by scanning this code with your phone\",\r\n      displayShareBtn: false,\r\n      shadow: 1,\r\n      qrCode: {\r\n        faviconId: \"\",\r\n        faviconUrl: \"\",\r\n        faviconMargin: \"0\",\r\n        QRsize: \"200\",\r\n        dotStyle: \"square\",\r\n        dotColor: \"#000000\",\r\n        cornerStyle: \"square\",\r\n        cornerColor: \"#000000\",\r\n        cornerDotStyle: \"square\",\r\n        cornerDotColor: \"#000000\",\r\n        backgroundColor: \"#ffffff\",\r\n        imgBackground: false,\r\n        website: \"https://ardisplay.io\", // Fallback website for QR\r\n      },\r\n      arBtn: {\r\n        btnText: \"View in your space\",\r\n        btnTextColor: \"#ffffff\",\r\n        btnBgColor: \"#3b37ff\",\r\n        btnIcon: \"Eye\",\r\n        cornerRadius: \"8\",\r\n        btnSize: \"15\",\r\n      },\r\n      options: [\r\n        {\r\n          name: \"DemoLives.glb\",\r\n          model: \"121\", // Example ID\r\n          url: \"https://assetger.ddns.net/storage/documents/d91c18c6-9966-4d25-a443-a68df576f97e-optimized.glb\",\r\n          sizes: [\r\n            {\r\n              label: \"Default Size\",\r\n              width: \"135.6cm\",\r\n              height: \"106.0cm\",\r\n              depth: \"3.0cm\",\r\n            },\r\n          ],\r\n          posterFileUrl:\r\n            \"https://assetger.ddns.net/storage/documents/e995WMUn836jJ5oGVicX5SkYcijE6mhl6opT3Fqg.webp\",\r\n          placement: \"wall\", // Or 'floor' depending on the demo model\r\n          iosUrl:\r\n            \"https://assetger.ddns.net/storage/documents/Nq6baT4fkJDk7blTAeZJhZfDzsPdLQQNRVWs3fVI.usdz\",\r\n          androidId: \"121\", // Example ID\r\n          iosId: \"122\", // Example ID\r\n          posterFileId: \"123\", // Example ID\r\n        },\r\n      ],\r\n      mode: \"popup\", // Default mode for fallback, adjust if needed\r\n      qrcode: \"popup\", // Default QR mode for fallback, adjust if needed\r\n      enabled: true, // Ensure fallback is enabled\r\n      storeProductId: \"\", // No specific store product ID for fallback\r\n    };\r\n    // --- End of Fallback Data Definition ---\r\n\r\n    let attempts = 0;\r\n    const maxAttempts = 3; // one attempt + two retries\r\n\r\n    // --- Initialize modelData to null ---\r\n    this.modelData = null;\r\n\r\n    // --- Loop while attempts < maxAttempts AND data hasn't been successfully fetched ---\r\n    while (attempts < maxAttempts && !this.modelData) {\r\n      try {\r\n        attempts++;\r\n        let url = window.location.href;\r\n        let response;\r\n        const hasSrc = this.hasAttribute(\"src\");\r\n        const hasShopifySrc = this.hasAttribute(\"shopify-src\");\r\n\r\n        // --- Keep your existing fetch logic ---\r\n        if (hasSrc) {\r\n          response = await fetch(\r\n            `https://ardisplayboilerplate.vercel.app/api/3d-model?id=${this.getAttribute(\r\n              \"src\"\r\n            )}`\r\n          );\r\n        } else if (hasShopifySrc) {\r\n          response = await fetch(\r\n            `https://ardisplayboilerplate.vercel.app/api/3d-model/store?storeProductId=${this.getAttribute(\r\n              \"shopify-src\"\r\n            )}`\r\n          );\r\n        } else {\r\n          // Only try fetching by URL if no src or shopify-src is provided\r\n          if (url && url.endsWith(\"/\")) {\r\n            url = url.slice(0, -1);\r\n          }\r\n          response = await fetch(\r\n            `https://ardisplayboilerplate.vercel.app/api/3d-model?url=${encodeBase64(\r\n              url\r\n            )}`\r\n          );\r\n        }\r\n        // --- End of fetch logic ---\r\n\r\n        if (!response || !response.ok) {\r\n          // Check if response exists before checking ok status\r\n          // Throw error to go to catch block for retry or fallback\r\n          const status = response ? response.status : \"No response\";\r\n          throw new Error(`Response status: ${status}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n\r\n        // --- Basic validation: Ensure data is an object and has options ---\r\n        if (\r\n          typeof data !== \"object\" ||\r\n          data === null ||\r\n          !data.options ||\r\n          data.options.length === 0\r\n        ) {\r\n          logger.warn(\"Received invalid or empty data structure from API.\");\r\n          throw new Error(\"Invalid data structure received.\"); // Trigger catch block\r\n        }\r\n\r\n        // --- Assign data if successful and valid ---\r\n        this.modelData = data;\r\n\r\n        // If using \"ar-button\" attribute override mode to \"none\" (as per original logic)\r\n        // Do this *after* assigning data from API\r\n        if (this.hasAttribute(\"ar-button\")) {\r\n          this.modelData.mode = \"none\";\r\n        }\r\n\r\n        // --- No need for explicit break, the while condition handles success ---\r\n      } catch (error) {\r\n        logger.error(`Attempt ${attempts} failed: ${error.message}`);\r\n        if (attempts >= maxAttempts) {\r\n          // All attempts failed – log final error before potential fallback\r\n          logger.error(\r\n            \"Exceeded maximum retry attempts for fetching model data.\"\r\n          );\r\n          // Optionally break here if you don't want to wait after the last failed attempt\r\n          // break;\r\n        } else {\r\n          // Optionally wait before retrying (already existing logic)\r\n          await new Promise((resolve) => setTimeout(resolve, 500));\r\n        }\r\n      }\r\n    } // End of while loop\r\n\r\n    // --- ADD THIS: Check if data was fetched, if not, use fallback ---\r\n    if (\r\n      !this.modelData &&\r\n      !this.getAttribute(\"src\") &&\r\n      !this.getAttribute(\"shopify-src\")\r\n    ) {\r\n      logger.warn(\r\n        \"Failed to fetch model data from all sources or data was invalid. Using fallback demo data.\"\r\n      );\r\n      this.modelData = FALLBACK_MODEL_DATA;\r\n      // If the fallback itself should be disabled under certain conditions, add logic here.\r\n      // For example: if (!this.hasAttribute('src') && !this.hasAttribute('shopify-src')) { this.modelData.enabled = false; }\r\n    }\r\n    // --- End of Fallback Check ---\r\n\r\n    // --- Call setupVariantsSizes *after* modelData is guaranteed to be set (either fetched or fallback) ---\r\n    this._setupVariantsSizes();\r\n\r\n    // Log the final data being used (useful for debugging)\r\n    logger.debug(\"Final modelData being used:\", this.modelData);\r\n  }\r\n\r\n  _setupVariantsSizes() {\r\n    this.variants = this.modelData?.options || [];\r\n    this.variantSizes = [];\r\n\r\n    this.variants.forEach((variant) => {\r\n      const sizesForThisVariant = {};\r\n      variant.sizes.forEach((size) => {\r\n        const key = size.label.toLowerCase();\r\n        sizesForThisVariant[key] = {\r\n          width: size.width,\r\n          height: size.height,\r\n          depth: size.depth || \"\",\r\n        };\r\n      });\r\n      this.variantSizes.push(sizesForThisVariant);\r\n    });\r\n  }\r\n\r\n  _getAttributes() {\r\n    return {\r\n      modelSrc: this.getAttribute(\"src\") || \"\",\r\n      modelPoster: this.getAttribute(\"poster\") || \"\",\r\n      ar: this.hasAttribute(\"ar\"),\r\n      cameraControls: this.hasAttribute(\"camera-controls\"),\r\n      touchAction: this.getAttribute(\"touch-action\") || \"none\",\r\n      viewMode: this.getAttribute(\"view-mode\") || \"normal\",\r\n      arPlacement: this.getAttribute(\"ar-placement\") || \"floor\",\r\n    };\r\n  }\r\n\r\n  _consolidateStyles() {\r\n    const style = document.createElement(\"style\");\r\n\r\n    if (this.modelData.mode !== \"none\" && this.modelData.mode !== \"popup\") {\r\n      style.textContent = `\r\n        :host {\r\n          display: block;\r\n          width: 100%;\r\n          height: 600px;\r\n          transform: scale(1);\r\n          font-family: 'Roboto', sans-serif;\r\n        }\r\n      `;\r\n    } else {\r\n      style.textContent = `\r\n        :host {\r\n          display: block;\r\n          width: 100%;\r\n          height: fit-content;\r\n          transform: scale(1);\r\n          font-family: 'Roboto', sans-serif;\r\n        }\r\n      `;\r\n    }\r\n\r\n    style.textContent += ` \r\n      *,*::before,*::after{\r\n        box-sizing: border-box;\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n\r\n      /* Consolidated Styles */\r\n      model-viewer {\r\n        width: 100%;\r\n        height: 100%;\r\n        --min-hotspot-opacity: 0;\r\n        position: relative;\r\n        display: block;\r\n      }\r\n\r\n      model-viewer[ar-status=\"session-started\"] .ardisplay-qr-code-button,\r\n      model-viewer[ar-status=\"object-placed\"] .ardisplay-qr-code-button {\r\n        display: none;\r\n      }\r\n\r\n\r\n\r\n      model-viewer[ar-status=\"session-started\"] .ardisplay-nav-icon-button:last-child,\r\n      model-viewer[ar-status=\"object-placed\"] .ardisplay-nav-icon-button:last-child {\r\n        display: flex;\r\n      }\r\n\r\n      model-viewer[ar-status=\"session-started\"] .dim,\r\n      model-viewer[ar-status=\"object-placed\"] .dim{\r\n        display: none!important;\r\n      }\r\n\r\n      model-viewer[ar-status=\"session-started\"] #dimLines,\r\n      model-viewer[ar-status=\"object-placed\"] #dimLines{\r\n        display: none!important;\r\n      }\r\n\r\n      .ardisplay-nav-icon-button:last-child {\r\n        display: none;\r\n      }\r\n\r\n      .dimensionLineContainer {\r\n        pointer-events: none;\r\n        display: block;\r\n      }\r\n\r\n      .dimensionLine {\r\n        display: none;\r\n        stroke: #16a5e6;\r\n        stroke-width: 2;\r\n      }\r\n\r\n      .hide {\r\n        display: none;\r\n      }\r\n\r\n      .dot {\r\n        display: none;\r\n      }\r\n\r\n      .dim {\r\n        display: none;\r\n        border-radius: 20px;\r\n        color: #1185bb;\r\n        padding: 4px 8px;\r\n        border: 1px solid #1185bb;\r\n      }\r\n\r\n      /* Bottom Nav Bar */\r\n      .bottom-container{\r\n        position: absolute;\r\n        width: 100%;\r\n        bottom: 0px;\r\n        height: auto;\r\n      }\r\n\r\n      .ardisplay-bottom-nav-bar {\r\n        position: absolute;\r\n        bottom: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        background: rgba(255, 255, 255, 0.8);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        padding: 8px;\r\n        z-index: 10;\r\n      }\r\n\r\n      .cart-button-wrapper{\r\n        display: none;\r\n      }\r\n\r\n      model-viewer[ar-status=\"session-started\"] .cart-button-wrapper,\r\n      model-viewer[ar-status=\"object-placed\"] .cart-button-wrapper{\r\n        display: flex;\r\n      }\r\n\r\n      .nav-btn {\r\n        background-color: #f0f0f0;\r\n        border: none;\r\n        outline: none;\r\n        cursor: pointer;\r\n        padding: 8px 12px;\r\n        border-radius: 4px;\r\n        margin-right: 8px;\r\n        font-weight: 500;\r\n        transition: background-color 0.2s ease;\r\n        flex: 1;\r\n      }\r\n      .nav-btn:hover {\r\n        background-color: #ddd;\r\n      }\r\n\r\n      /* Sub-panels */\r\n      .hidden {\r\n        display: none;\r\n      }\r\n\r\n      /* Color Slider */\r\n      .slider {\r\n        width: 100%;\r\n        text-align: center;\r\n        overflow: hidden;\r\n        margin: 0 auto;\r\n      }\r\n      .slides {\r\n        display: flex;\r\n        justify-content: center;\r\n        padding: 10px;\r\n        flex-direction: row-reverse;\r\n        gap: 10px; /* spacing between slides */\r\n      }\r\n      .slide {\r\n        scroll-snap-align: start;\r\n        flex-shrink: 0;\r\n        width: 80px;\r\n        height: 80px;\r\n        background-color: #fff;\r\n        border: 1px solid #ccc;\r\n        border-radius: 10px;\r\n        cursor: pointer;\r\n        background-position: center;\r\n        background-size: contain;\r\n        background-repeat: no-repeat;\r\n        outline: none;\r\n        transition: transform 0.2s ease, box-shadow 0.2s ease;\r\n      }\r\n      .slide.selected {\r\n        border-color: #4285f4;\r\n        box-shadow: 0 0 0 2px rgba(66,133,244,0.3);\r\n      }\r\n\r\n      .size-panel {\r\n      /* Similar to 'flex flex-wrap gap-2' in Tailwind */\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px; /* ~ Tailwind gap-2 */\r\n      padding: 16px; /* for some breathing room */\r\n      padding-top: 0;\r\n      background-color: transparent;\r\n      z-index: 100;\r\n    }\r\n\r\n    .size-buttons-wrapper {\r\n      /* If you need an extra wrapper, adjust accordingly */\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n      flex: 1;\r\n      padding: 0;\r\n    }\r\n\r\n    .size-button {\r\n      /* Mimicking \"border-2 border-gray-300 rounded-lg px-4 py-2\" */\r\n      border: 2px solid #ccc;\r\n      border-radius: 8px; /* ~ Tailwind rounded-lg */\r\n      padding: 8px 16px; /* ~ px-4 py-2 in Tailwind */\r\n      background-color: rgba(255, 255, 255, 0.8); /* ~ bg-white/80 */\r\n      font-weight: 500;\r\n      cursor: pointer;\r\n      color: black;\r\n\r\n      /* Tailwind “transition-colors” is basically short for smooth border/color transitions */\r\n      transition: border-color 0.2s ease, color 0.2s ease, background-color 0.2s ease;\r\n    }\r\n\r\n    /* Hover effect: \"hover:border-blue-600 hover:text-blue-600\" */\r\n    .size-button:hover:not(:disabled) {\r\n      border-color: #2563EB;\r\n      color: #2563EB;\r\n    }\r\n\r\n    /* Active/selected state similar to your existing .selected logic */\r\n    .size-button.selected {\r\n      color: #4285f4;\r\n      border-color: #4285f4;\r\n      opacity: 1;\r\n    }\r\n\r\n      /* Floating Add to Cart button */\r\n      .cart-button-wrapper {\r\n        position: absolute;\r\n        top: -64px; /* similar to -top-16 from Tailwind */\r\n        left: 0;\r\n        right: 0;\r\n        justify-content: center;\r\n      }\r\n      .cart-btn {\r\n        background-color: #2563EB; /* Tailwind blue-600 */\r\n        color: #fff;\r\n        border: none;\r\n        border-radius: 9999px; /* fully rounded */\r\n        padding: 12px 32px; /* ~py-3 px-8 */\r\n        font-weight: 600;\r\n        font-family: sans-serif;\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\r\n        cursor: pointer;\r\n        transition: background-color 0.2s ease;\r\n      }\r\n      .cart-btn:hover {\r\n        background-color: #1D4ED8; /* Tailwind blue-700 */\r\n      }\r\n      .cart-btn svg {\r\n        height: 20px; /* h-5 in Tailwind ~ 20px */\r\n        width: 20px;\r\n      }\r\n\r\n      /* Bottom Nav Bar (matching the React code style) */\r\n      .ardisplay-bottom-nav {\r\n        height: fit-content; /* h-16 in Tailwind */\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 16px;\r\n        position: relative;\r\n        z-index: 100;\r\n        margin-bottom: 16px;\r\n      }\r\n      .ardisplay-nav-icon-button {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n        justify-content: center;\r\n        width: 120px;\r\n        padding: 8px 16px;\r\n        color: black; /* text-gray-600 */\r\n        background: #ccc;\r\n        border-radius:40px;\r\n        gap:10px;\r\n        border: none;\r\n        cursor: pointer;\r\n        transition: color 0.2s ease;\r\n      }\r\n      .ardisplay-nav-icon-button svg {\r\n        height: 24px; /* h-6 */\r\n        width: 24px;\r\n      }\r\n      .ardisplay-nav-icon-button span {\r\n        font-size: 12px; /* text-xs ~12px */\r\n        font-weight: bold;\r\n      }\r\n      /* ------------------------------------------------------------------ */\r\n      .sub-panel{\r\n      position: absolute;\r\n      bottom: 0; /* ensure it sits over the nav bar */\r\n      height: auto;\r\n      width: 100%;\r\n      z-index: 10000;\r\n      background: white;\r\n      padding-top: 50px; // added padding for close button\r\n    }\r\n      .sub-panel .sub-panel-close-button {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  background: transparent;\r\n  border: none;\r\n  font-size: 24px;\r\n  cursor: pointer;\r\n}\r\n\r\n      model-viewer[ar-status=\"session-started\"] .ardisplay-variant-btn-active,\r\n      model-viewer[ar-status=\"object-placed\"] .ardisplay-variant-btn-active{\r\n        display:none!important;\r\n      }\r\n    `;\r\n    return style;\r\n  }\r\n\r\n  async checkWebXRSupport() {\r\n    try {\r\n      if (\"xr\" in navigator) {\r\n        return await navigator.xr.isSessionSupported(\"immersive-ar\");\r\n      }\r\n      return false;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async _loadTemplate(viewMode) {\r\n    let template =\r\n      viewMode === \"popup\"\r\n        ? modalTemplate\r\n        : viewMode === \"inpage\"\r\n        ? normalTemplate\r\n        : buttonTemplate;\r\n\r\n    // if (this.getAttribute(\"src\")) {\r\n    //   template = buttonTemplate;\r\n    // }\r\n\r\n    const attributes = this._getAttributes();\r\n    const templateString = template(\r\n      attributes.ar,\r\n      attributes.cameraControls,\r\n      attributes.touchAction,\r\n      attributes.modelPoster,\r\n      attributes.arPlacement,\r\n      this.modelData,\r\n      this.hasAttribute(\"fullWidth\")\r\n    );\r\n\r\n    // Use a DocumentFragment for better DOM updates\r\n    const fragment = document\r\n      .createRange()\r\n      .createContextualFragment(templateString);\r\n\r\n    // Process the icons within the fragment\r\n    this._processLucideIcons(fragment);\r\n\r\n    this.shadowRoot.appendChild(fragment);\r\n\r\n    if (viewMode === \"inpage\") {\r\n      const imageOverlay = document.createElement(\"img\");\r\n      imageOverlay.src = await PosterWithCache(\r\n        this.modelData.options[0].posterFileUrl,\r\n        this.posters\r\n      );\r\n      imageOverlay.style.position = \"absolute\";\r\n      imageOverlay.style.top = \"0\";\r\n      imageOverlay.style.left = \"0\";\r\n      imageOverlay.style.width = \"100%\";\r\n      imageOverlay.style.height = \"100%\";\r\n      imageOverlay.style.objectFit = \"contain\";\r\n      imageOverlay.style.zIndex = \"10\";\r\n      this.shadowRoot.querySelector(\"model-viewer\").appendChild(imageOverlay);\r\n\r\n      this.addEventListener(\"click\", async () => {\r\n        const imageElement = this.shadowRoot.querySelector(\"model-viewer img\");\r\n        if (imageElement) {\r\n          this.shadowRoot\r\n            .querySelector(\"model-viewer\")\r\n            .removeChild(imageElement);\r\n        }\r\n        await lazyLoadModelViewerIfNeeded();\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = `.container { direction: ltr; }`;\r\n        this.modelViewer.shadowRoot.appendChild(style);\r\n      });\r\n\r\n      this.addEventListener(\"mouseenter\", async () => {\r\n        const imageElement = this.shadowRoot.querySelector(\"model-viewer img\");\r\n        if (imageElement) {\r\n          this.shadowRoot\r\n            .querySelector(\"model-viewer\")\r\n            .removeChild(imageElement);\r\n        }\r\n        await lazyLoadModelViewerIfNeeded();\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = `.container { direction: ltr; }`;\r\n        this.modelViewer.shadowRoot.appendChild(style);\r\n      });\r\n    }\r\n  }\r\n\r\n  _updateSizePanel(variantIndex) {\r\n    const sizePanel =\r\n      this.modelData.mode !== \"popup\"\r\n        ? this.shadowRoot.querySelector(\".size-panel\")\r\n        : document.querySelector(\".size-panel\");\r\n    if (!sizePanel) return;\r\n\r\n    sizePanel.innerHTML = \"\";\r\n\r\n    const sizeButtonsWrapper = createDomElement(\"div\", {\r\n      classList: [\"size-buttons-wrapper\"],\r\n    });\r\n\r\n    const sizesForVariant = this.variantSizes[variantIndex];\r\n    if (sizesForVariant) {\r\n      Object.entries(sizesForVariant).forEach(([sizeKey, sizeValues]) => {\r\n        const button = createDomElement(\"button\", {\r\n          classList: [\"size-button\"],\r\n          attributes: {\r\n            \"data-size-key\": sizeKey,\r\n          },\r\n          disabled: false,\r\n        });\r\n\r\n        button.innerHTML = `\r\n          <span class=\"size-label\">${sizeKey}</span>\r\n          <span class=\"size-description\">\r\n            (${sizeValues.width} X ${sizeValues.height} X ${\r\n          sizeValues.depth ? sizeValues.depth + \"\" : \"\"\r\n        })\r\n          </span>\r\n        `;\r\n\r\n        button.addEventListener(\"click\", (event) => {\r\n          if (!this.modelViewer) return;\r\n\r\n          if (this.modelData.mode === \"popup\") {\r\n            document\r\n              .querySelectorAll(\".size-button\")\r\n              .forEach((btn) => btn.classList.remove(\"selected\"));\r\n          } else {\r\n            this.shadowRoot\r\n              .querySelectorAll(\".size-button\")\r\n              .forEach((btn) => btn.classList.remove(\"selected\"));\r\n          }\r\n          event.currentTarget.classList.add(\"selected\");\r\n          const desiredSize = this.variantSizes[variantIndex][sizeKey];\r\n          this.calculateAndApplyScale(desiredSize);\r\n        });\r\n\r\n        sizeButtonsWrapper.appendChild(button);\r\n      });\r\n    }\r\n\r\n    sizePanel.appendChild(sizeButtonsWrapper);\r\n  }\r\n\r\n  _processLucideIcons(fragment) {\r\n    const iconMap = {\r\n      eye: Eye,\r\n      blocks: Blocks,\r\n      rotate3d: Rotate3D,\r\n      box: Box,\r\n      fileaxis3d: FileAxis3D,\r\n      scan: Scan,\r\n    };\r\n\r\n    const elements = fragment.querySelectorAll(\"[data-lucide]\");\r\n\r\n    elements.forEach((element) => {\r\n      const iconName = element.getAttribute(\"data-lucide\").toLowerCase();\r\n      const icon = iconMap[iconName];\r\n\r\n      if (icon) {\r\n        const size = element.getAttribute(\"width\") || 24;\r\n        const color = element.getAttribute(\"color\") || \"currentColor\";\r\n\r\n        // Create SVG element\r\n        const svg = document.createElementNS(\r\n          \"http://www.w3.org/2000/svg\",\r\n          \"svg\"\r\n        );\r\n        svg.setAttribute(\"width\", size);\r\n        svg.setAttribute(\"height\", size);\r\n        svg.setAttribute(\"viewBox\", \"0 0 24 24\");\r\n        svg.setAttribute(\"fill\", \"none\");\r\n        svg.setAttribute(\"stroke\", color);\r\n        svg.setAttribute(\"stroke-width\", \"2\");\r\n        svg.setAttribute(\"stroke-linecap\", \"round\");\r\n        svg.setAttribute(\"stroke-linejoin\", \"round\");\r\n\r\n        // Process icon children\r\n        icon[2].forEach((child) => {\r\n          const [tagName, attributes] = child;\r\n          const element = document.createElementNS(\r\n            \"http://www.w3.org/2000/svg\",\r\n            tagName\r\n          );\r\n\r\n          // Set attributes\r\n          Object.entries(attributes).forEach(([name, value]) => {\r\n            element.setAttribute(name, value);\r\n          });\r\n\r\n          svg.appendChild(element);\r\n        });\r\n\r\n        // Replace original element\r\n        element.parentNode.replaceChild(svg, element);\r\n      } else {\r\n        // console.warn(`Icon \"${iconName}\" not found`);\r\n      }\r\n    });\r\n  }\r\n\r\n  _moveSlottedContent() {\r\n    const customPanel = this.shadowRoot.querySelector(\r\n      \".ar-display-custom-panel\"\r\n    );\r\n    const slottedContent = this.querySelector('slot[name=\"custom-panel\"]');\r\n    if (customPanel && slottedContent) {\r\n      customPanel.appendChild(slottedContent);\r\n    } else {\r\n      // const arDisplayDetailsPanel =\r\n      //   this.shadowRoot.querySelector(\".details-panel\");\r\n      // if (arDisplayDetailsPanel) {\r\n      //   arDisplayDetailsPanel.remove();\r\n      // }\r\n    }\r\n  }\r\n\r\n  _setupEventListeners() {\r\n    if (this.modelData.mode === \"popup\") {\r\n      this._setupModalEventListeners();\r\n    } else if (this.modelData.mode === \"inpage\") {\r\n      this._setupNormalEventListeners();\r\n    }\r\n\r\n    // Use a single debounced/throttled method for dimension updates\r\n    this.boundHandleScale = () => this._setupDimensions(this.modelViewer);\r\n    this.boundHandleModelVisibility = () =>\r\n      this._setupDimensions(this.modelViewer);\r\n    this.boundHandleArStatus = (event) => this._handleArStatusChange(event);\r\n    this.boundHandleCameraChange = () => {\r\n      this.debouncedRenderSVG();\r\n      this.debouncedUpdateDimensionHotspots();\r\n    };\r\n    this.boundHandleSceneGraphReady = () => {\r\n      this.debouncedRenderSVG();\r\n      this.debouncedUpdateDimensionHotspots();\r\n    };\r\n    this.boundHandleLoad = () => {\r\n      this.isModelLoaded = true;\r\n      if (this.qrCodeButton) {\r\n        this.qrCodeButton.disabled = false;\r\n      }\r\n\r\n      // Get dimensions and set up sizes\r\n      const size = this.modelViewer.getDimensions();\r\n      const scale = this.modelViewer.scale.toString().split(\" \").map(Number);\r\n      this.originalSize = { x: 0, y: 0, z: 0 };\r\n      this.originalSize.x = size.x / scale[0];\r\n      this.originalSize.y = size.y / scale[1];\r\n      this.originalSize.z = size.z / scale[2];\r\n\r\n      // Apply initial size if available\r\n      if (this.variantSizes && this.variantSizes[this.selectedIndex]) {\r\n        const sizesForVariant = this.variantSizes[this.selectedIndex];\r\n        const firstSizeKey = Object.keys(sizesForVariant)[0];\r\n        if (firstSizeKey) {\r\n          const firstSizeValues = sizesForVariant[firstSizeKey];\r\n          this.calculateAndApplyScale(firstSizeValues);\r\n\r\n          requestAnimationFrame(() => {\r\n            const sizeButtons =\r\n              this.modelData.mode !== \"popup\"\r\n                ? this.shadowRoot.querySelectorAll(\".size-button\")\r\n                : document.querySelectorAll(\".size-button\");\r\n            sizeButtons.forEach((btn, index) => {\r\n              if (index === 0) {\r\n                btn.classList.add(\"selected\");\r\n              } else {\r\n                btn.classList.remove(\"selected\");\r\n              }\r\n            });\r\n          });\r\n        }\r\n      }\r\n\r\n      // Create size panel if needed\r\n      if (!this.shadowRoot.querySelector(\".size-panel button\")) {\r\n        this._updateSizePanel(0);\r\n      }\r\n\r\n      // Hide default AR button\r\n      const arButtonSlot =\r\n        this.modelViewer.shadowRoot.querySelector(\".slot.ar-button\");\r\n      if (arButtonSlot) {\r\n        arButtonSlot.style.display = \"none\";\r\n      }\r\n\r\n      // Handle progress modal and show multi-steps\r\n      const progressModal = document.querySelector(\"#ardisplayProgressModal\");\r\n      if (progressModal && progressModal.style.display !== \"none\") {\r\n        progressModal.style.display = \"none\";\r\n        // Only show multi-steps modal if we were showing the progress modal\r\n        this._showStepsModal();\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"scale\", this.boundHandleScale);\r\n    this.modelViewer.addEventListener(\r\n      \"model-visibility\",\r\n      this.boundHandleModelVisibility\r\n    );\r\n    this.modelViewer.addEventListener(\"ar-status\", this.boundHandleArStatus);\r\n    this.modelViewer.addEventListener(\r\n      \"camera-change\",\r\n      this.boundHandleCameraChange\r\n    );\r\n    this.modelViewer.addEventListener(\r\n      \"scene-graph-ready\",\r\n      this.boundHandleSceneGraphReady\r\n    );\r\n    this.modelViewer.addEventListener(\"load\", this.boundHandleLoad);\r\n\r\n    this.modelViewer.addEventListener(\"progress\", (event) => {\r\n      const progress = Math.round(event.detail.totalProgress * 100);\r\n      const fillElem = document.querySelector(\"#ardisplayProgressBarFill\");\r\n      if (fillElem) {\r\n        fillElem.style.width = `${progress}%`;\r\n        fillElem.style.display = \"block\";\r\n      }\r\n    });\r\n\r\n    this.modelViewer.addEventListener(\"load\", () => {\r\n      this.isModelLoaded = true;\r\n\r\n      if (this.modelData.mode === \"popup\") {\r\n        document.querySelectorAll(\".dim\").forEach((dim) => {\r\n          dim.style.display = \"block\";\r\n        });\r\n      } else {\r\n        this.shadowRoot.querySelectorAll(\".dim\").forEach((dim) => {\r\n          dim.style.display = \"block\";\r\n        });\r\n      }\r\n\r\n      // Show AR button if model is loaded\r\n      const arButton = document.querySelector(\"#activateAR\");\r\n      if (arButton) {\r\n        arButton.addEventListener(\"click\", async (event) => {\r\n          // Ensure we're handling the click event\r\n          if (event instanceof MouseEvent) {\r\n            try {\r\n              console.log(\"clicked\");\r\n              await this.modelViewer.activateAR();\r\n              // Hide progress modal after AR is activated\r\n              const progressModal = document.querySelector(\r\n                \"#ardisplayProgressModal\"\r\n              );\r\n              if (progressModal) {\r\n                progressModal.style.display = \"none\";\r\n              }\r\n            } catch (error) {\r\n              // console.error(\"Error activating AR:\", error);\r\n            }\r\n          }\r\n        });\r\n        arButton.style.display = \"block\";\r\n      }\r\n    });\r\n  }\r\n\r\n  _isIOSDevice() {\r\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n  }\r\n\r\n  _isMobileDevice() {\r\n    return /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n      navigator.userAgent\r\n    );\r\n  }\r\n\r\n  async _setupQRCodeListeners() {\r\n    const qrModal = document.querySelector(\"#qrModal\");\r\n    const qrCodeContainer = document.querySelector(\"#qr-code\");\r\n    const qrCodeButton =\r\n      this.modelData.mode !== \"popup\"\r\n        ? this.shadowRoot.querySelector(\".ardisplay-qr-code-button\")\r\n        : document.querySelector(\".ardisplay-qr-code-button\");\r\n    const qrCloseButton = document.querySelector(\".qr-close-button\");\r\n\r\n    // Initialize QR code manager if not already initialized\r\n    if (!this.qrCodeManager) {\r\n      this.qrCodeManager = new QrCodeManager(qrCodeContainer, this.modelData);\r\n    }\r\n\r\n    qrCodeButton.addEventListener(\"click\", async () => {\r\n      this.GIF_URLS.push(\r\n        await PosterWithCache(\r\n          this.modelData.options[0].posterFileUrl,\r\n          this.posters\r\n        )\r\n      );\r\n      if (this.modelData.mode === \"none\" && this._isMobileDevice()) {\r\n        // Show progress modal immediately!\r\n        const progressModal = document.querySelector(\"#ardisplayProgressModal\");\r\n        if (progressModal) {\r\n          const fillElem = document.querySelector(\"#ardisplayProgressBarFill\");\r\n          if (fillElem) {\r\n            fillElem.style.width = \"0%\"; // Reset progress bar\r\n            fillElem.style.display = \"block\";\r\n          }\r\n          progressModal.style.display = \"flex\"; // Show the modal\r\n          this.userClickedAR = true; // Keep track of user click\r\n        }\r\n\r\n        await lazyLoadModelViewerIfNeeded();\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = `.container { direction: ltr; }`;\r\n        this.modelViewer.shadowRoot.appendChild(style); // Start loading model-viewer\r\n\r\n        if (this.modelViewer) {\r\n          this.modelViewer.addEventListener(\"progress\", (event) => {\r\n            const progress = Math.round(event.detail.totalProgress * 100);\r\n            const fillElem = document.querySelector(\r\n              \"#ardisplayProgressBarFill\"\r\n            );\r\n            if (fillElem) {\r\n              fillElem.style.width = `${progress}%`;\r\n              fillElem.style.display = `block`;\r\n            }\r\n          });\r\n        }\r\n\r\n        // Continue with the rest of your logic (steps modal, etc.)\r\n        // const hasWebXRSupport = await this.checkWebXRSupport();\r\n        // if (!hasWebXRSupport) {\r\n        //   this._resetSteps();\r\n        //   this._showStepsModal();\r\n        //   return;\r\n        // }\r\n\r\n        if (this.isModelLoaded) {\r\n          const progressModal = document.querySelector(\r\n            \"#ardisplayProgressModal\"\r\n          );\r\n          if (progressModal) {\r\n            progressModal.style.display = \"none\";\r\n          }\r\n          this._resetSteps();\r\n          this._showStepsModal();\r\n          return;\r\n        }\r\n      } else if (!this._isMobileDevice()) {\r\n        // If not mobile device, show QR code directly\r\n        const currentUrl = `${BRIDGE_URL}/${this.modelData.modelId}`;\r\n        this.qrCodeManager.updateQrCode(currentUrl);\r\n        qrModal.style.display = \"flex\";\r\n        return;\r\n      } else {\r\n        // Mobile device, but not mode \"none\" (likely inpage or popup)\r\n        // For mobile devices, check WebXR support\r\n        const hasWebXRSupport = await this.checkWebXRSupport();\r\n\r\n        // If mobile device doesn't support WebXR, show multi-steps modal immediately\r\n        // if (!hasWebXRSupport) {\r\n        //   this._resetSteps();\r\n        //   this._showStepsModal();\r\n        //   return;\r\n        // }\r\n\r\n        // Continue with WebXR flow\r\n        if (this.isModelLoaded) {\r\n          this._resetSteps();\r\n          this._showStepsModal();\r\n          return;\r\n        }\r\n\r\n        // Loading flow for WebXR-supported devices\r\n        const progressModal = document.querySelector(\"#ardisplayProgressModal\");\r\n        if (progressModal) {\r\n          const fillElem = document.querySelector(\"#ardisplayProgressBarFill\");\r\n          if (fillElem) {\r\n            fillElem.style.width = \"0%\";\r\n            fillElem.style.display = \"block\";\r\n          }\r\n          progressModal.style.display = \"flex\";\r\n          this.userClickedAR = true;\r\n        }\r\n        await lazyLoadModelViewerIfNeeded();\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = `.container { direction: ltr; }`;\r\n        this.modelViewer.shadowRoot.appendChild(style);\r\n      }\r\n    });\r\n\r\n    qrCloseButton.addEventListener(\"click\", () => {\r\n      qrModal.style.display = \"none\";\r\n    });\r\n\r\n    // Close modal when clicking outside\r\n    qrModal.addEventListener(\"click\", (event) => {\r\n      if (event.target === qrModal) {\r\n        qrModal.style.display = \"none\";\r\n      }\r\n    });\r\n  }\r\n\r\n  _resetSteps() {\r\n    // Reset steps to initial state\r\n    this.currentStep = 1;\r\n    document\r\n      .querySelectorAll(\".ardisplay-step-indicator\")\r\n      .forEach((el, index) => {\r\n        el.classList.toggle(\"active\", index === 0);\r\n      });\r\n\r\n    // Reset content to first step\r\n    const stepsContent = document.querySelector(\".ardisplay-steps-content\");\r\n    if (stepsContent) {\r\n      stepsContent.innerHTML = `\r\n        <h3 class=\"ardisplay-instructions-title\">Scanning</h3>\r\n        <img src=\"${\r\n          this.GIF_URLS[0]\r\n        }\" class=\"ardisplay-steps-gif\" alt=\"Computer man\">\r\n        <div class=\"ardisplay-instructions-body\">Stand several feet back. With camera facing ${\r\n          (this.variants[this.selectedIndex] &&\r\n            this.variants[this.selectedIndex].placement) ||\r\n          this.modelData.placement\r\n        }, make sweeping motion side to side, up and down.</div>\r\n      `;\r\n    }\r\n\r\n    // Show next/skip buttons\r\n    const nextBtn = document.querySelector(\".ardisplay-next-button\");\r\n    const skipBtn = document.querySelector(\".ardisplay-skip-button\");\r\n    if (nextBtn) nextBtn.parentElement.style.display = \"flex\";\r\n    if (skipBtn) skipBtn.style.display = \"block\";\r\n  }\r\n\r\n  async generateUSDZ() {\r\n    // Assume “glbFile” is available (e.g. from an upload or internal source)\r\n    // And that you’ve already calculated the desired scale (for instance, via your calculateAndApplyScale function):\r\n    const glbFile =\r\n      this.modelViewer.getAttribute(\"src\") || this.modelViewer.src;\r\n\r\n    if (!glbFile) {\r\n      console.error(\"No GLB file available for USDZ generation.\");\r\n      return;\r\n    }\r\n\r\n    // Calculate scale based on desired dimensions. For example:\r\n    let calculatedScale =\r\n      this.modelViewer.getAttribute(\"scale\") || this.modelViewer.scale;\r\n\r\n    if (!calculatedScale) {\r\n      calculatedScale = \"1 1 1\";\r\n    }\r\n    // Determine the anchoring alignment based on placement.\r\n    const placement = this.modelData.placement || \"floor\";\r\n    const anchoringAlignment =\r\n      placement.toLowerCase() === \"wall\" ? \"vertical\" : \"horizontal\";\r\n\r\n    try {\r\n      // Generate the USDZ file with the proper scaling and anchoring.\r\n      const scaleToUse = {\r\n        x: calculatedScale.split(\" \")[0],\r\n        y: calculatedScale.split(\" \")[1],\r\n        z: calculatedScale.split(\" \")[2],\r\n      };\r\n      const usdzFile = await createUSDZModelFromGLB(\r\n        glbFile,\r\n        anchoringAlignment,\r\n        scaleToUse\r\n      );\r\n\r\n      console.log(\"USDZFile :\", usdzFile);\r\n      // Now update your <model-viewer> with the new USDZ file.\r\n      // (For iOS / Quick Look, the \"ios-src\" attribute is used.)\r\n      const modelViewer = this.modelViewer;\r\n      if (modelViewer) {\r\n        modelViewer.setAttribute(\"ios-src\", usdzFile);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error generating USDZ model:\", error);\r\n    }\r\n  }\r\n\r\n  async handleActivateAR() {\r\n    this._sendShortStatsEvent(\"Click\");\r\n\r\n    // Show QR code directly if not mobile\r\n    if (!this._isMobileDevice()) {\r\n      const currentUrl = `${BRIDGE_URL}/${this.modelData.modelId}`;\r\n      if (this.qrCodeManager && this.qrModal) {\r\n        this.qrCodeManager.updateQrCode(currentUrl);\r\n        this.qrModal.style.display = \"flex\";\r\n      }\r\n      return;\r\n    }\r\n\r\n    await this.generateUSDZ();\r\n    // Mobile device flow\r\n    if (this.modelViewer.canActivateAR) {\r\n      try {\r\n        this._sendShortStatsEvent(\"Try\");\r\n        this.modelViewer.activateAR();\r\n      } catch (err) {\r\n        this._sendShortStatsEvent(\"Failed\", err.message);\r\n        logger.warn(\"Could not activate AR:\", err);\r\n        const currentUrl = `${BRIDGE_URL}/${this.modelData.modelId}`;\r\n        if (this.qrCodeManager && this.qrModal) {\r\n          this.qrCodeManager.updateQrCode(currentUrl);\r\n          this.qrModal.style.display = \"flex\";\r\n        } else {\r\n          logger.error(\"QR code manager or modal not initialized\");\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _setupVariantsColors() {\r\n    if (!this.variants || this.variants.length === 0) return null;\r\n\r\n    const slider = createDomElement(\"div\", { classList: [\"slider\"] });\r\n    const slidesWrapper = createDomElement(\"div\", { classList: [\"slides\"] });\r\n\r\n    this.variants.forEach(async (variant, index) => {\r\n      const slideButton = createDomElement(\"button\", { classList: [\"slide\"] });\r\n\r\n      if (index === 0) {\r\n        slideButton.classList.add(\"selected\");\r\n        if (this.modelViewer && variant.url) {\r\n          let VARIANT_URL = new URL(variant.url);\r\n          let IOS_VARIANT_URL = new URL(variant.iosUrl);\r\n          this.modelViewer.setAttribute(\"src\", VARIANT_URL.href);\r\n          if (variant.posterFileUrl) {\r\n            this.modelViewer.poster = await PosterWithCache(\r\n              variant.posterFileUrl,\r\n              this.posters\r\n            );\r\n          } else {\r\n            this.modelViewer.removeAttribute(\"poster\");\r\n          }\r\n        }\r\n      }\r\n\r\n      if (variant.posterFileUrl) {\r\n        slideButton.style.backgroundImage = `url('${variant.posterFileUrl}')`;\r\n      }\r\n\r\n      // if all variant placement are not the same hide variantBtn\r\n      let isTheSame = true;\r\n      this.variants.forEach((variant) => {\r\n        if (variant.placement !== this.variants[0].placement) {\r\n          isTheSame = false;\r\n        }\r\n      });\r\n\r\n      if (!isTheSame) {\r\n        const variantBtn =\r\n          this.modelData.mode !== \"popup\"\r\n            ? this.shadowRoot.querySelector(\".ardisplay-variant-btn\")\r\n            : document.querySelector(\".ardisplay-variant-btn\");\r\n        // add active if not exist\r\n        if (\r\n          variantBtn &&\r\n          variantBtn.classList &&\r\n          !variantBtn.classList.contains(\"ardisplay-variant-btn-active\")\r\n        ) {\r\n          variantBtn.classList.add(\"ardisplay-variant-btn-active\");\r\n        }\r\n      }\r\n\r\n      slideButton.onclick = () => {\r\n        if (!this.modelViewer) return;\r\n\r\n        if (variant.url) {\r\n          let VARIANT_URL = new URL(variant.url);\r\n          let IOS_VARIANT_URL = new URL(variant.iosUrl);\r\n          this.modelViewer.setAttribute(\"src\", VARIANT_URL.href);\r\n        }\r\n\r\n        this._updateSizePanel(index);\r\n\r\n        if (variant.posterFileUrl) {\r\n          this.modelViewer.poster = variant.posterFileUrl;\r\n        } else {\r\n          this.modelViewer.removeAttribute(\"poster\");\r\n        }\r\n\r\n        if (variant.placement) {\r\n          this.modelViewer.setAttribute(\"ar-placement\", variant.placement);\r\n        } else {\r\n          this.modelViewer.setAttribute(\r\n            \"ar-placement\",\r\n            this.modelData.placement\r\n          );\r\n        }\r\n\r\n        if (this.modelData.mode !== \"popup\") {\r\n          this.shadowRoot\r\n            .querySelectorAll(\".slide\")\r\n            .forEach((s) => s.classList.remove(\"selected\"));\r\n          slideButton.classList.add(\"selected\");\r\n        } else {\r\n          document\r\n            .querySelectorAll(\".slide\")\r\n            .forEach((s) => s.classList.remove(\"selected\"));\r\n          slideButton.classList.add(\"selected\");\r\n        }\r\n\r\n        this.selectedIndex = index;\r\n\r\n        this.selectedIndex = index;\r\n        // Update the instruction body right away\r\n        const placement =\r\n          (this.variants[index] && this.variants[index].placement) ||\r\n          this.modelData.placement ||\r\n          \"floor\";\r\n        const instructionBody = document.querySelector(\r\n          \".ardisplay-instructions-body\"\r\n        );\r\n        if (instructionBody) {\r\n          instructionBody.innerHTML = `Stand several feet back. With camera facing ${\r\n            placement.toLowerCase() === \"wall\" ? \"wall\" : \"floor\"\r\n          }, make sweeping motion side to side, up and down.`;\r\n        }\r\n\r\n        // update GIF image passed on placement\r\n        this.GIF_URLS[0] =\r\n          placement.toLowerCase() === \"wall\"\r\n            ? `${CDN_URL}/wall.webp`\r\n            : `${CDN_URL}/floor.gif`;\r\n        this._updateNavButtonsVisibility();\r\n      };\r\n\r\n      slidesWrapper.appendChild(slideButton);\r\n    });\r\n\r\n    slider.appendChild(slidesWrapper);\r\n    return slider;\r\n  }\r\n\r\n  // ---------- UI updates for bottom nav and floating cart ----------\r\n  _setupCartButton(container) {\r\n    // Wrapper to position the cart button above the bottom nav\r\n    const cartWrapper = createDomElement(\"div\", {\r\n      classList: [\"cart-button-wrapper\"],\r\n    });\r\n    const cartBtn = createDomElement(\"button\", { classList: [\"cart-btn\"] });\r\n    cartBtn.innerHTML = `\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293\r\n               2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0\r\n               100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n          />\r\n        </svg>\r\n        Add to Cart\r\n      `;\r\n    cartWrapper.appendChild(cartBtn);\r\n    container.appendChild(cartWrapper);\r\n\r\n    cartWrapper.addEventListener(\"click\", async () => {\r\n      await this._sendShortStatsEvent(\"Cart\");\r\n      window.location.href = this.modelData.addToCartUrl;\r\n    });\r\n  }\r\n\r\n  _setupBottomNavBar(container) {\r\n    // Create the size sub-panel\r\n    const sizePanel = createDomElement(\"div\", {\r\n      classList: [\"sub-panel\", \"hidden\"],\r\n    });\r\n\r\n    // Create a close button and add it to the sizePanel\r\n    const sizePanelCloseBtn = createDomElement(\"button\", {\r\n      classList: [\"sub-panel-close-button\"],\r\n      textContent: \"×\", // or use an icon if you prefer\r\n    });\r\n    // Style the close button (you can move these styles to your CSS)\r\n    sizePanelCloseBtn.style.position = \"absolute\";\r\n    sizePanelCloseBtn.style.top = \"0px\";\r\n    sizePanelCloseBtn.style.right = \"10px\";\r\n    sizePanelCloseBtn.style.background = \"transparent\";\r\n    sizePanelCloseBtn.style.height = \"50px\";\r\n    sizePanelCloseBtn.style.border = \"none\";\r\n    sizePanelCloseBtn.style.fontSize = \"32px\";\r\n    sizePanelCloseBtn.style.cursor = \"pointer\";\r\n    // When clicked, hide the panel (and optionally remove the active state from the related nav button)\r\n    sizePanelCloseBtn.addEventListener(\"click\", () => {\r\n      sizePanel.classList.add(\"hidden\");\r\n      // If you have a reference to the size nav button, you can remove its \"active\" class, e.g.:\r\n      // sizeNavBtn.classList.remove(\"active\");\r\n    });\r\n    // Append the close button to the panel\r\n    sizePanel.appendChild(sizePanelCloseBtn);\r\n\r\n    const sizePanelLabel = createDomElement(\"div\", {\r\n      classList: [\"sub-panel-label\"],\r\n      textContent: \"Size\",\r\n    });\r\n    sizePanelLabel.style.fontSize = \"16px\";\r\n    sizePanelLabel.style.position = \"absolute\";\r\n    sizePanelLabel.style.top = \"0\";\r\n    sizePanelLabel.style.left = \"50%\";\r\n    sizePanelLabel.style.height = \"50px\";\r\n    sizePanelLabel.style.display = \"flex\";\r\n    sizePanelLabel.style.alignItems = \"center\";\r\n    sizePanelLabel.style.justifyContent = \"center\";\r\n    sizePanelLabel.style.transform = \"translateX(-50%)\";\r\n    sizePanel.appendChild(sizePanelLabel);\r\n    // Then add the size controls to the sizePanel\r\n    const sizeControls = this._createSizeControls();\r\n    if (sizeControls) sizePanel.appendChild(sizeControls);\r\n\r\n    // Create the variant sub-panel\r\n    const variantPanel = createDomElement(\"div\", {\r\n      classList: [\"sub-panel\", \"hidden\"],\r\n    });\r\n\r\n    // Create a close button for the variant panel\r\n    const variantPanelCloseBtn = createDomElement(\"button\", {\r\n      classList: [\"sub-panel-close-button\"],\r\n      textContent: \"×\", // or use an SVG icon here if preferred\r\n    });\r\n    // Apply similar styling for the variant close button\r\n    variantPanelCloseBtn.style.position = \"absolute\";\r\n    variantPanelCloseBtn.style.top = \"0px\";\r\n    variantPanelCloseBtn.style.right = \"10px\";\r\n    variantPanelCloseBtn.style.background = \"transparent\";\r\n    variantPanelCloseBtn.style.border = \"none\";\r\n    variantPanelCloseBtn.style.fontSize = \"32px\";\r\n    variantPanelCloseBtn.style.height = \"50px\";\r\n    variantPanelCloseBtn.style.cursor = \"pointer\";\r\n    variantPanelCloseBtn.addEventListener(\"click\", () => {\r\n      variantPanel.classList.add(\"hidden\");\r\n      // Optionally remove the \"active\" class from the variant nav button:\r\n      // variantNavBtn.classList.remove(\"active\");\r\n    });\r\n    // Append the close button to the variant panel\r\n    variantPanel.appendChild(variantPanelCloseBtn);\r\n\r\n    const variantPanelLabel = createDomElement(\"div\", {\r\n      classList: [\"sub-panel-label\"],\r\n      textContent: \"Variant\",\r\n    });\r\n    variantPanelLabel.style.fontSize = \"16px\";\r\n    variantPanelLabel.style.position = \"absolute\";\r\n    variantPanelLabel.style.top = \"0\";\r\n    variantPanelLabel.style.left = \"50%\";\r\n    variantPanelLabel.style.height = \"50px\";\r\n    variantPanelLabel.style.display = \"flex\";\r\n    variantPanelLabel.style.alignItems = \"center\";\r\n    variantPanelLabel.style.justifyContent = \"center\";\r\n    variantPanelLabel.style.transform = \"translateX(-50%)\";\r\n    variantPanel.appendChild(variantPanelLabel);\r\n\r\n    // Then add the variant controls (color/variant selection)\r\n    const variantControls = this._setupVariantsColors();\r\n    if (variantControls) variantPanel.appendChild(variantControls);\r\n\r\n    // Create the bottom nav container\r\n    const navBar = createDomElement(\"div\", {\r\n      classList: [\"ardisplay-bottom-nav\"],\r\n    });\r\n\r\n    // Toggle function for showing/hiding a given panel\r\n    const togglePanel = (panel) => {\r\n      const isHidden = panel.classList.contains(\"hidden\");\r\n      // Hide both panels\r\n      sizePanel.classList.add(\"hidden\");\r\n      variantPanel.classList.add(\"hidden\");\r\n      // Show only if it was hidden when the button was pressed\r\n      if (isHidden) panel.classList.remove(\"hidden\");\r\n    };\r\n\r\n    // Create the Size nav button (only show if there are multiple size options)\r\n    const sizeBtn = createDomElement(\"button\", {\r\n      classList: [\"ardisplay-nav-icon-button\", \"ardisplay-size-btn\"],\r\n    });\r\n    // For example, add an icon (using an SVG or text) and label:\r\n    sizeBtn.innerHTML = `\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" style=\"height:28px;width:28px;\">\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12 6V4H20V20H12V18H8V16H4V8H8V6H12ZM14 6H18V18H14V6ZM12 8H10V16H12V8ZM8 10V14H6V10H8Z\" fill=\"#000000\"/>\r\n      </svg>\r\n      <span>Size</span>\r\n    `;\r\n    // Add a click listener to toggle the size panel\r\n    sizeBtn.addEventListener(\"click\", () => {\r\n      togglePanel(sizePanel);\r\n      sizeBtn.classList.toggle(\r\n        \"active\",\r\n        !sizePanel.classList.contains(\"hidden\")\r\n      );\r\n      // Also remove the variant button's active state\r\n      variantBtn.classList.remove(\"active\");\r\n    });\r\n\r\n    // Create the Variant nav button (only if there are multiple variants)\r\n    const variantBtn = createDomElement(\"button\", {\r\n      classList: [\"ardisplay-nav-icon-button\", \"ardisplay-variant-btn\"],\r\n    });\r\n    variantBtn.innerHTML = `\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"#000000\" width=\"32px\" height=\"32px\" viewBox=\"0 0 32 32\" version=\"1.1\" style=\"height:24px;width:24px;\">\r\n        <path d=\"M1 9.431l14.847 8.085c0.149 0.081 0.313 0.122 0.479 0.122 0.163 0 0.326-0.04 0.474-0.12l15.003-8.085c0.327-0.176 0.53-0.52 0.525-0.892s-0.216-0.711-0.547-0.88l-14.848-7.54c-0.283-0.143-0.617-0.144-0.902-0.002l-15.002 7.54c-0.332 0.167-0.545 0.505-0.551 0.877s0.196 0.717 0.521 0.895zM16.161 2.134l12.692 6.446-12.843 6.921-12.693-6.912zM31.292 15.01l-2.968-1.507-2.142 1.155 2.5 1.27-12.842 6.921-12.694-6.912 2.666-1.34-2.136-1.164-3.135 1.575c-0.332 0.167-0.545 0.505-0.551 0.877s0.196 0.717 0.521 0.895l14.847 8.085c0.149 0.081 0.313 0.122 0.479 0.122 0.163 0 0.326-0.04 0.474-0.12l15.003-8.085c0.327-0.176 0.53-0.52 0.525-0.892s-0.215-0.711-0.546-0.88zM31.292 22.01l-2.811-1.382-2.142 1.155 2.344 1.145-12.843 6.921-12.694-6.912 2.478-1.121-2.136-1.164-2.947 1.357c-0.332 0.167-0.545 0.505-0.551 0.877s0.196 0.717 0.521 0.895l14.847 8.085c0.149 0.081 0.313 0.122 0.479 0.122 0.163 0 0.326-0.04 0.475-0.12l15.003-8.085c0.327-0.176 0.53-0.52 0.525-0.892-0.005-0.373-0.215-0.712-0.546-0.88z\"/>\r\n      </svg>\r\n      <span>Variant</span>\r\n    `;\r\n    variantBtn.addEventListener(\"click\", () => {\r\n      togglePanel(variantPanel);\r\n      variantBtn.classList.toggle(\r\n        \"active\",\r\n        !variantPanel.classList.contains(\"hidden\")\r\n      );\r\n      sizeBtn.classList.remove(\"active\");\r\n    });\r\n\r\n    if (this.variants.length === 1 && variantBtn) {\r\n      variantBtn.style.display = \"none\";\r\n    }\r\n\r\n    if (this.variants.length > 0) {\r\n      const defaultVariantSizes = this.variants[0].sizes;\r\n      if (defaultVariantSizes && defaultVariantSizes.length === 1 && sizeBtn) {\r\n        sizeBtn.style.display = \"none\";\r\n      }\r\n    }\r\n\r\n    // You can add a Share button or any additional buttons, if needed.\r\n    const shareBtn = createDomElement(\"button\", {\r\n      classList: [\"ardisplay-nav-icon-button\"],\r\n    });\r\n    shareBtn.innerHTML = `\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" \r\n              d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"/>\r\n      </svg>\r\n      <span>Share</span>\r\n    `;\r\n    shareBtn.addEventListener(\"click\", async () => {\r\n      this._sendShortStatsEvent(\"Share\");\r\n      const shareData = {\r\n        title: document.title,\r\n        text: \"Check out this AR model!\",\r\n        url: window.location.href,\r\n      };\r\n      try {\r\n        await navigator.share(shareData);\r\n      } catch (err) {\r\n        console.warn(\"Share failed:\", err);\r\n      }\r\n    });\r\n\r\n    // Append all nav buttons to the nav bar\r\n    navBar.appendChild(sizeBtn);\r\n    navBar.appendChild(variantBtn);\r\n    navBar.appendChild(shareBtn);\r\n\r\n    // Also close any open panels when clicking outside (optional)\r\n    this.boundHandleDocumentMouseDown = (e) => {\r\n      const path = e.composedPath();\r\n      if (\r\n        !path.includes(navBar) &&\r\n        !path.includes(sizePanel) &&\r\n        !path.includes(variantPanel)\r\n      ) {\r\n        sizePanel.classList.add(\"hidden\");\r\n        variantPanel.classList.add(\"hidden\");\r\n        sizeBtn.classList.remove(\"active\");\r\n        variantBtn.classList.remove(\"active\");\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", this.boundHandleDocumentMouseDown);\r\n\r\n    // Finally, append the navBar and the sub-panels to the container.\r\n    container.appendChild(navBar);\r\n    container.appendChild(sizePanel);\r\n    container.appendChild(variantPanel);\r\n  }\r\n\r\n  _updateNavButtonsVisibility() {\r\n    const sizeBtn =\r\n      this.modelData.mode !== \"popup\"\r\n        ? this.shadowRoot.querySelector(\r\n            \".ardisplay-bottom-nav .ardisplay-size-btn\"\r\n          )\r\n        : document.querySelector(\".ardisplay-bottom-nav .ardisplay-size-btn\");\r\n    const variantBtn =\r\n      this.modelData.mode !== \"popup\"\r\n        ? this.shadowRoot.querySelector(\r\n            \".ardisplay-bottom-nav .ardisplay-variant-btn\"\r\n          )\r\n        : document.querySelector(\r\n            \".ardisplay-bottom-nav .ardisplay-variant-btn\"\r\n          );\r\n\r\n    // Hide the variant button if there is only one variant\r\n    if (this.variants.length === 1 && variantBtn) {\r\n      variantBtn.style.display = \"none\";\r\n    } else if (variantBtn) {\r\n      variantBtn.style.display = \"flex\";\r\n    }\r\n\r\n    // Get the currently selected variant (default to index 0 if not set)\r\n    const selectedIndex =\r\n      typeof this.selectedIndex === \"number\" ? this.selectedIndex : 0;\r\n    const currentVariantSizes = this.variants[selectedIndex]?.sizes;\r\n    if (currentVariantSizes && currentVariantSizes.length === 1 && sizeBtn) {\r\n      sizeBtn.style.display = \"none\";\r\n    } else if (sizeBtn) {\r\n      sizeBtn.style.display = \"flex\";\r\n    }\r\n  }\r\n  // ------------------------------------------------------------------\r\n\r\n  async _setupModalEventListeners() {\r\n    const view3DButton = this.shadowRoot.querySelector(\r\n      \".ardisplay-view-3d-button\"\r\n    );\r\n    const previewImage = this.shadowRoot.querySelector(\r\n      \".ardisplay-preview-image\"\r\n    );\r\n    const modelViewerContainer = document.querySelector(\r\n      \".model-viewer-container\"\r\n    );\r\n    const closeButton = document.querySelector(\".ardisplay-close-button\");\r\n    const overlay = document.querySelector(\".ardisplay-model-viewer-overlay\");\r\n\r\n    if (view3DButton && modelViewerContainer) {\r\n      view3DButton.addEventListener(\"click\", async () => {\r\n        await lazyLoadModelViewerIfNeeded();\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = `.container { direction: ltr; }`;\r\n        this.modelViewer.shadowRoot.appendChild(style);\r\n        modelViewerContainer.style.display = \"flex\";\r\n        overlay.style.display = \"block\";\r\n      });\r\n    }\r\n\r\n    if (closeButton && overlay) {\r\n      closeButton.addEventListener(\"click\", () => {\r\n        modelViewerContainer.style.display = \"none\";\r\n        overlay.style.display = \"none\";\r\n      });\r\n\r\n      overlay.addEventListener(\"click\", () => {\r\n        modelViewerContainer.style.display = \"none\";\r\n        overlay.style.display = \"none\";\r\n      });\r\n    }\r\n  }\r\n\r\n  _setupNormalEventListeners() {\r\n    // This is handled in _setupEventListeners\r\n  }\r\n\r\n  _handleArStatusChange(event) {\r\n    const isSessionStarted = event.detail.status === \"session-started\";\r\n    // Hide progress/loading modal when the session is not started\r\n    if (!isSessionStarted) {\r\n      const progressModal = document.querySelector(\"#ardisplayProgressModal\");\r\n      if (progressModal) {\r\n        progressModal.style.display = \"none\";\r\n      }\r\n    }\r\n\r\n    // (Existing logic for showing/hiding hotspots/dim elements)\r\n    const dimElements = [\r\n      ...this.modelViewer.querySelectorAll(\"[data-hotspot]\"),\r\n      this.modelViewer.querySelector(\"#dimLines\"),\r\n    ].filter(Boolean);\r\n\r\n    const setVisibility = (visible) => {\r\n      dimElements.forEach((element) => {\r\n        element.classList.toggle(\"hide\", !visible);\r\n      });\r\n    };\r\n\r\n    setVisibility(!isSessionStarted);\r\n  }\r\n\r\n  _drawLine(svgLine, startHotspot, endHotspot, dimensionHotspot) {\r\n    if (!svgLine || !startHotspot || !endHotspot) return;\r\n    svgLine.setAttribute(\"x1\", startHotspot.canvasPosition.x);\r\n    svgLine.setAttribute(\"y1\", startHotspot.canvasPosition.y);\r\n    svgLine.setAttribute(\"x2\", endHotspot.canvasPosition.x);\r\n    svgLine.setAttribute(\"y2\", endHotspot.canvasPosition.y);\r\n    if (dimensionHotspot) {\r\n      svgLine.classList.toggle(\"hide\", !dimensionHotspot.facingCamera);\r\n    }\r\n  }\r\n\r\n  _renderSVG() {\r\n    const dimLines = this.modelViewer.querySelectorAll(\"line\");\r\n    if (dimLines.length === 0) return;\r\n\r\n    const lineMappings = [\r\n      {\r\n        line: dimLines[0],\r\n        start: \"hotspot-dot+X-Y+Z\",\r\n        end: \"hotspot-dot+X-Y+Z\",\r\n        dimension: \"hotspot-dim+X-Y\",\r\n      },\r\n      {\r\n        line: dimLines[1],\r\n        start: \"hotspot-dot+X-Y-Z\",\r\n        end: \"hotspot-dot+X+Y-Z\",\r\n        dimension: \"hotspot-dim+X-Z\",\r\n      },\r\n      {\r\n        line: dimLines[2],\r\n        start: \"hotspot-dot+X+Y-Z\",\r\n        end: \"hotspot-dot-X+Y-Z\",\r\n      },\r\n      {\r\n        line: dimLines[3],\r\n        start: \"hotspot-dot-X+Y-Z\",\r\n        end: \"hotspot-dot-X-Y-Z\",\r\n        dimension: \"hotspot-dim-X-Z\",\r\n      },\r\n      {\r\n        line: dimLines[4],\r\n        start: \"hotspot-dot-X-Y-Z\",\r\n        end: \"hotspot-dot-X-Y+Z\",\r\n        dimension: \"hotspot-dim-X-Y\",\r\n      },\r\n    ];\r\n\r\n    lineMappings.forEach(({ line, start, end, dimension }) => {\r\n      this._drawLine(\r\n        line,\r\n        this.modelViewer.queryHotspot(start),\r\n        this.modelViewer.queryHotspot(end),\r\n        dimension ? this.modelViewer.queryHotspot(dimension) : null\r\n      );\r\n    });\r\n  }\r\n\r\n  _updateDimensionHotspots() {\r\n    const center = this.modelViewer.getBoundingBoxCenter();\r\n    const size = this.modelViewer.getDimensions();\r\n    const halfSize = {\r\n      x: size.x / 2,\r\n      y: size.y / 2,\r\n      z: size.z / 2,\r\n    };\r\n\r\n    const hotspotsData = [\r\n      {\r\n        name: \"hotspot-dot+X-Y+Z\",\r\n        position: [\r\n          center.x + halfSize.x,\r\n          center.y - halfSize.y,\r\n          center.z + halfSize.z,\r\n        ],\r\n      },\r\n      {\r\n        name: \"hotspot-dim+X-Y\",\r\n        position: [\r\n          center.x + halfSize.x * 1.2,\r\n          center.y - halfSize.y * 1.1,\r\n          center.z,\r\n        ],\r\n        label: `${(size.z * 100).toFixed(0)} cm`,\r\n        labelSelector: '[slot=\"hotspot-dim+X-Y\"]',\r\n      },\r\n      {\r\n        name: \"hotspot-dot+X-Y-Z\",\r\n        position: [\r\n          center.x + halfSize.x,\r\n          center.y - halfSize.y,\r\n          center.z - halfSize.z,\r\n        ],\r\n      },\r\n      {\r\n        name: \"hotspot-dim+X-Z\",\r\n        position: [\r\n          center.x + halfSize.x * 1.2,\r\n          center.y,\r\n          center.z - halfSize.z * 1.2,\r\n        ],\r\n        label: `${(size.y * 100).toFixed(0)} cm`,\r\n        labelSelector: '[slot=\"hotspot-dim+X-Z\"]',\r\n      },\r\n      {\r\n        name: \"hotspot-dot+X+Y-Z\",\r\n        position: [\r\n          center.x + halfSize.x,\r\n          center.y + halfSize.y,\r\n          center.z - halfSize.z,\r\n        ],\r\n      },\r\n      {\r\n        name: \"hotspot-dim+Y-Z\",\r\n        position: [\r\n          center.x,\r\n          center.y + halfSize.y * 1.1,\r\n          center.z - halfSize.z * 1.1,\r\n        ],\r\n        label: `${(size.x * 100).toFixed(0)} cm`,\r\n        labelSelector: '[slot=\"hotspot-dim+Y-Z\"]',\r\n      },\r\n      {\r\n        name: \"hotspot-dot-X+Y-Z\",\r\n        position: [\r\n          center.x - halfSize.x,\r\n          center.y + halfSize.y,\r\n          center.z - halfSize.z,\r\n        ],\r\n      },\r\n      {\r\n        name: \"hotspot-dim-X-Z\",\r\n        position: [\r\n          center.x - halfSize.x * 1.2,\r\n          center.y,\r\n          center.z - halfSize.z * 1.2,\r\n        ],\r\n        label: `${(size.y * 100).toFixed(0)} cm`,\r\n        labelSelector: '[slot=\"hotspot-dim-X-Z\"]',\r\n      },\r\n      {\r\n        name: \"hotspot-dot-X-Y-Z\",\r\n        position: [\r\n          center.x - halfSize.x,\r\n          center.y - halfSize.y,\r\n          center.z - halfSize.z,\r\n        ],\r\n      },\r\n      {\r\n        name: \"hotspot-dim-X-Y\",\r\n        position: [\r\n          center.x - halfSize.x * 1.2,\r\n          center.y - halfSize.y * 1.1,\r\n          center.z,\r\n        ],\r\n        label: `${(size.z * 100).toFixed(0)} cm`,\r\n        labelSelector: '[slot=\"hotspot-dim-X-Y\"]',\r\n      },\r\n      {\r\n        name: \"hotspot-dot-X-Y+Z\",\r\n        position: [\r\n          center.x - halfSize.x,\r\n          center.y - halfSize.y,\r\n          center.z + halfSize.z,\r\n        ],\r\n      },\r\n    ];\r\n\r\n    hotspotsData.forEach(({ name, position, label, labelSelector }) => {\r\n      this.modelViewer.updateHotspot({\r\n        name,\r\n        position: position.join(\" \"),\r\n      });\r\n      if (label && labelSelector) {\r\n        const labelElement = this.modelViewer.querySelector(labelSelector);\r\n        if (labelElement) {\r\n          labelElement.textContent = label;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _setupDimensions() {\r\n    if (this.modelData.mode === \"popup\") {\r\n      document.querySelectorAll(\".dimensionLine\").forEach((el) => {\r\n        el.style.display = \"block\";\r\n      });\r\n    } else {\r\n      this.shadowRoot.querySelectorAll(\".dimensionLine\").forEach((el) => {\r\n        el.style.display = \"block\";\r\n      });\r\n    }\r\n    this.debouncedRenderSVG();\r\n    this.debouncedUpdateDimensionHotspots();\r\n  }\r\n\r\n  _createSizeControls() {\r\n    const sizePanel = createDomElement(\"div\", { classList: [\"size-panel\"] });\r\n    const sizeButtonsWrapper = createDomElement(\"div\", {\r\n      classList: [\"size-buttons-wrapper\"],\r\n    });\r\n\r\n    sizePanel.appendChild(sizeButtonsWrapper);\r\n    return sizePanel;\r\n  }\r\n\r\n  _handleSizeChange(event) {\r\n    if (event.target.classList.contains(\"size-button\")) {\r\n      const sizeKey = event.target.getAttribute(\"data-size-key\");\r\n      if (this.variantSizes[this.selectedIndex][sizeKey]) {\r\n        this.shadowRoot\r\n          .querySelectorAll(\".size-button\")\r\n          .forEach((btn) => btn.classList.remove(\"selected\"));\r\n        event.target.classList.add(\"selected\");\r\n        const desiredSize = this.variantSizes[this.selectedIndex][sizeKey];\r\n        this.calculateAndApplyScale(desiredSize);\r\n      }\r\n    }\r\n  }\r\n\r\n  applyScale() {\r\n    if (this.calculatedScale && this.modelViewer) {\r\n      this.modelViewer.setAttribute(\r\n        \"scale\",\r\n        `${this.calculatedScale.scaleX} ${this.calculatedScale.scaleY} ${this.calculatedScale.scaleZ}`\r\n      );\r\n      if (typeof this.modelViewer.updateFraming === \"function\") {\r\n        requestAnimationFrame(() => {\r\n          this.modelViewer.updateFraming();\r\n          document.dispatchEvent(this.scaleEvent);\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  async calculateAndApplyScale(desiredSize) {\r\n    if (!desiredSize) return;\r\n    try {\r\n      const scale = await this.calculateModelScale(desiredSize);\r\n      this.calculatedScale = scale;\r\n      this.applyScale();\r\n    } catch (error) {\r\n      logger.error(\"Error applying scale for chosen size:\", error);\r\n    }\r\n  }\r\n\r\n  cmToMeters(cmString) {\r\n    return parseFloat(cmString.replace(\"cm\", \"\")) / 100;\r\n  }\r\n\r\n  calculateModelScale(desiredSize) {\r\n    const size = this.originalSize || { x: 1, y: 1, z: 1 };\r\n\r\n    const originalWidth = size.x;\r\n    const originalHeight = size.y;\r\n    const originalDepth = size.z;\r\n\r\n    const desiredWidth = this.cmToMeters(desiredSize.width);\r\n    const desiredHeight = this.cmToMeters(desiredSize.height);\r\n    const desiredDepth = desiredSize.depth\r\n      ? this.cmToMeters(desiredSize.depth)\r\n      : 0.05;\r\n\r\n    const scaleX = desiredWidth / originalWidth;\r\n    const scaleY = desiredHeight / originalHeight;\r\n    const scaleZ = desiredDepth / originalDepth;\r\n\r\n    return { scaleX, scaleY, scaleZ };\r\n  }\r\n\r\n  cleanupBlobUrls() {\r\n    Object.values(this.gifCache).forEach((blobUrl) => {\r\n      URL.revokeObjectURL(blobUrl);\r\n    });\r\n    this.gifCache = {};\r\n  }\r\n}\r\n\r\ncustomElements.define(\"ardisplay-viewer\", ARDisplayViewer);\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  // Ensure custom element is defined before replacement\r\n  if (window.customElements.get(\"ardisplay-viewer\")) {\r\n    replacePlaceholders();\r\n  } else {\r\n    window.customElements\r\n      .whenDefined(\"ardisplay-viewer\")\r\n      .then(replacePlaceholders);\r\n  }\r\n});\r\n\r\nfunction replacePlaceholders() {\r\n  const xpathQuery = \"//*[normalize-space(text())='{%AR-DISPLAY-PLAYER%}']\";\r\n  const xpathResult = document.evaluate(\r\n    xpathQuery,\r\n    document,\r\n    null,\r\n    XPathResult.FIRST_ORDERED_NODE_TYPE,\r\n    null\r\n  );\r\n  const placeholder = xpathResult.singleNodeValue;\r\n  const newEl = document.createElement(\"ardisplay-viewer\");\r\n  placeholder.replaceWith(newEl);\r\n}\r\n"],"names":["e","module","this","t","i","r","n","s","o","h","p","v","m","b","x","y","C","S","M","A","a","d","u","c","l","g","f","w","_","$","O","D","z","hotspotsTemplate","styleObjectToString","styles","cssString","isMediaQuery","selector","toKebabCase","str","processRules","rules","indentLevel","result","indent","property","value","propertyName","CDN_URL","BRIDGE_URL","modalStyles","normalTemplate","ar","cameraControls","touchAction","modelPoster","arPlacement","modelData","fullWidth","template","modalTemplate","buttonTemplate","defaultAttributes","Blocks","Box","Eye","FileAxis3d","Rotate3d","Scan","lazyLoadModelViewerIfNeeded","error","toTrianglesDrawMode","geometry","drawMode","TrianglesDrawMode","TriangleFanDrawMode","TriangleStripDrawMode","index","indices","position","numberOfTriangles","newIndices","newGeometry","GLTFLoader","Loader","manager","parser","GLTFMaterialsClearcoatExtension","GLTFMaterialsDispersionExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","url","onLoad","onProgress","onError","scope","resourcePath","relativeUrl","LoaderUtils","_onError","loader","FileLoader","data","gltf","dracoLoader","ktx2Loader","meshoptDecoder","callback","path","json","extensions","plugins","textDecoder","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","GLTFBinaryExtension","GLTFParser","plugin","extensionName","extensionsRequired","GLTFMaterialsUnlitExtension","GLTFDracoMeshCompressionExtension","GLTFTextureTransformExtension","GLTFMeshQuantizationExtension","resolve","reject","GLTFRegistry","objects","key","object","nodeDefs","nodeIndex","nodeLength","nodeDef","lightIndex","cacheKey","dependency","lightDef","lightNode","color","Color","LinearSRGBColorSpace","range","DirectionalLight","PointLight","SpotLight","assignExtrasToUserData","type","self","light","MeshBasicMaterial","materialParams","materialDef","pending","metallicRoughness","array","SRGBColorSpace","materialIndex","emissiveStrength","MeshPhysicalMaterial","extension","scale","Vector2","colorFactor","colorArray","textureIndex","textureDef","name","source","handler","isSupported","image","bufferView","extensionDef","buffer","decoder","res","byteOffset","byteLength","count","stride","meshDef","primitive","WEBGL_CONSTANTS","attributesDef","attributes","accessor","results","nodeObject","meshes","instancedMeshes","mesh","Matrix4","Vector3","q","Quaternion","instancedMesh","InstancedMesh","attributeName","attr","InstancedBufferAttribute","Object3D","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","headerView","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","accessorDef","componentType","WEBGL_COMPONENT_TYPES","attribute","normalized","texture","transform","GLTFCubicSplineInterpolant","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","values","valueSize","offset","i1","t0","t1","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","_q","GLTFCubicSplineQuaternionInterpolant","WEBGL_FILTERS","NearestFilter","LinearFilter","NearestMipmapNearestFilter","LinearMipmapNearestFilter","NearestMipmapLinearFilter","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","InterpolateLinear","InterpolateDiscrete","ALPHA_MODES","createDefaultMaterial","cache","MeshStandardMaterial","FrontSide","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfDef","addMorphTargets","targets","hasMorphPosition","hasMorphNormal","hasMorphColor","il","target","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","accessors","morphPositions","morphNormals","morphColors","updateMorphTargets","targetNames","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","attributesKey","keys","getNormalizedComponentScale","constructor","getImageURIMimeType","uri","_identityMatrix","options","isSafari","safariVersion","isFirefox","firefoxVersion","userAgent","safariMatch","TextureLoader","ImageBitmapLoader","ext","dependencies","scene","skinDefs","meshDefs","skinIndex","skinLength","joints","ref","updateMappings","original","clone","mappings","child","func","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","itemSize","TypedArray","BufferAttribute","pendingBufferViews","bufferViews","elementBytes","itemBytes","byteStride","bufferAttribute","ibSlice","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","sourceIndex","sourceDef","promise","sampler","URL","sourceURI","isObjectURL","blob","imageBitmap","Texture","mapName","mapDef","colorSpace","gltfReference","material","useDerivativeTangents","useVertexColors","useFlatShading","pointsMaterial","PointsMaterial","Material","lineMaterial","LineBasicMaterial","cachedMaterial","materialType","materialExtensions","kmuExtension","DoubleSide","alphaMode","emissiveFactor","originalName","sanitizedName","PropertyBinding","primitives","createDracoPrimitive","addPrimitiveAttributes","cached","geometryPromise","BufferGeometry","meshIndex","materials","geometries","SkinnedMesh","Mesh","LineSegments","Line","LineLoop","Points","group","Group","cameraIndex","camera","cameraDef","params","PerspectiveCamera","MathUtils","OrthographicCamera","skinDef","inverseBindMatrices","jointNodes","bones","boneInverses","jointNode","mat","Skeleton","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channel","input","output","nodes","inputAccessors","outputAccessors","samplers","tracks","node","inputAccessor","outputAccessor","createdTracks","k","AnimationClip","nodePending","childPending","childrenDef","skeletonPending","children","skeleton","nodeName","meshPromise","Bone","matrix","sceneIndex","sceneDef","nodeIds","reduceAssociations","reducedAssociations","targetName","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","interpolation","outputArray","j","jl","track","scaled","interpolantType","computeBounds","box","Box3","min","max","boxScale","maxDisplacement","vector","sphere","Sphere","assignAttributeAccessor","gltfAttributeName","ColorManagement","_taskCache","DRACOLoader","config","workerLimit","attributeIDs","attributeTypes","vertexColorSpace","taskConfig","taskKey","cachedTask","worker","taskID","taskCost","geometryPending","_worker","message","geometryData","inputColorSpace","_color","responseType","useJS","librariesPending","libraries","jsContent","fn","DRACOWorker","body","decoderConfig","decoderPending","draco","decodeGeometry","buffers","dracoGeometry","decodingStatus","geometryType","attributeType","attributeID","attributeResult","decodeAttribute","decodeIndex","numIndices","ptr","numComponents","numValues","dataType","getDracoDataType","u8","u16","i32","fleb","fdeb","clim","freb","eb","start","_a","fl","revfl","_b","revfd","rev","hMap","cd","mb","le","co","rvb","sv","r_1","flt","fdt","flm","fdm","shft","slc","ec","err","ind","msg","nt","wbits","wbits16","hTree","t2","et","i0","i2","maxSym","tr","mbt","ln","dt","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","pos","dat","wblk","final","syms","lf","df","li","bs","bl","dlt","mlb","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","flen","ftlen","dtlen","lm","ll","dm","dl","llm","lcts","it","clct","len","sym","dst","deo","dflt","lvl","plvl","pre","post","st","lst","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","pti","lin","din","crct","crc","cr","dopt","dict","newDat","mrg","wbytes","deflateSync","opts","fltn","val","op","te","tds","strToU8","latin1","ai","exfl","ex","wzh","ce","col","exl","exf","wzf","zipSync","files","tot","file","compression","com","ms","oe","cdl","badd","_renderer","fullscreenQuadGeometry","fullscreenQuadMaterial","fullscreenQuad","decompress","maxTextureSize","renderer","PlaneGeometry","ShaderMaterial","Uniform","_camera","_scene","Scene","WebGLRenderer","width","height","canvas","context","readableTexture","CanvasTexture","USDZExporter","onDone","modelFileName","buildHeader","buildSceneStart","textures","geometryFileName","meshObject","buildMeshObject","buildUSDFileAsString","buildXform","buildCamera","buildSceneEnd","buildMaterials","id","imageToCanvas","filename","headerSize","offsetMod64","padLength","padding","flipY","PRECISION","dataToInsert","buildMatrix","buildMatrixRow","buildMesh","buildMeshVertexCount","buildMeshVertexIndices","buildVector3Array","buildPrimvars","length","buildVector2Array","string","colorAttribute","quickLookCompatible","uuid","buildMaterial","pad","inputs","buildTexture","mapType","uv","WRAPPINGS","repeat","rotation","xRotationOffset","yRotationOffset","buildVector2","buildColor4","NoColorSpace","buildColor","MeshoptDecoder","wasm_base","wasm_simd","detector","wasmpack","wasm","unpack","instance","ready","ch","write","decode","fun","size","filter","sbrk","count4","tp","sp","heap","filters","decoders","workers","requestId","createWorker","event","initWorkers","workerProcess","decodeWorker","mode","createUSDZModelFromGLB","glbUrl","anchoringAlignment","THREE","usdzExportOptions","usdzArrayBuffer","usdzBlob","blobUrl","encodeBase64","text","decodeBase64","createDomElement","tag","el","createPortal","element","container","logger","args","PosterWithCache","posterUrl","fetchPromise","response","QrCodeManager","img","qrCodeSettings","imageUrl","qrCodeOptions","QRCodeStyling","progressModalTemplate","STEPS","stepsModalTemplate","ARDisplayViewer","stepIndex","nextGifUrl","currentGif","rect","entries","observerInstance","entry","requested","wait","timeout","action","eventData","oldValue","newValue","encodedConfig","decoded","customArBtnConfig","customConfig","arBtn","view3DButton","iconHTML","initialPlacement","qrModalTemplate","modalModeTemplate","arBtnConfigEncoded","gifFile","instructionGif","instructionBody","showQRButton","inlineQrContainer","currentUrl","qrCodeButton","qrCodeContainer","nextBtn","stepsCloseBtn","stepsOverlay","progressModal","progressContent","closeButton","bottomContainer","modal","firstGifUrl","stepsContent","skipBtn","viewWallBtn","gifElement","currentGifUrl","touchStartX","touchEndX","swipeThreshold","touchStartHandler","touchEndHandler","startX","endX","threshold","diffX","end","FALLBACK_MODEL_DATA","attempts","maxAttempts","hasSrc","hasShopifySrc","status","variant","sizesForThisVariant","style","viewMode","templateString","fragment","imageOverlay","imageElement","variantIndex","sizePanel","sizeButtonsWrapper","sizesForVariant","sizeKey","sizeValues","button","btn","desiredSize","iconMap","Rotate3D","FileAxis3D","iconName","icon","svg","tagName","customPanel","slottedContent","firstSizeKey","firstSizeValues","arButtonSlot","progress","fillElem","dim","arButton","qrModal","qrCloseButton","glbFile","calculatedScale","scaleToUse","usdzFile","modelViewer","slider","slidesWrapper","slideButton","VARIANT_URL","isTheSame","variantBtn","placement","cartWrapper","cartBtn","sizePanelCloseBtn","sizePanelLabel","sizeControls","variantPanel","variantPanelCloseBtn","variantPanelLabel","variantControls","navBar","togglePanel","panel","isHidden","sizeBtn","defaultVariantSizes","shareBtn","shareData","selectedIndex","currentVariantSizes","modelViewerContainer","overlay","isSessionStarted","dimElements","visible","svgLine","startHotspot","endHotspot","dimensionHotspot","dimLines","line","dimension","center","halfSize","label","labelSelector","labelElement","cmString","originalWidth","originalHeight","originalDepth","desiredWidth","desiredHeight","desiredDepth","scaleX","scaleY","scaleZ","replacePlaceholders","placeholder","newEl"],"mappings":"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AG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAG,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAG,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAE,GAAE,CAAC,IAAG,IAAG,IAAG,IA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AA;AAAA;AAAA;AAAA;AAAA;AAAA,SAWtBA,EAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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","x_google_ignoreList":[0,7,8,9,10,11,12,13,15,16,17,18,19,20]}